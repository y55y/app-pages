import{r as d,j as e,n as l,bG as N,bJ as b,bK as k}from"./index-DoHa3M9S.js";import{D as x,a as g,b as p}from"./DialogContent-Bzad8hoa.js";import{D as h}from"./DialogTitle-BhKrG_9L.js";import{T as j}from"./TextField-CBirjhvp.js";const A=({open:s,onClose:o,selectedRowId:i,mainAccounts:y,setMessage:a})=>{const[r,n]=d.useState(null),[m,C]=d.useState(!1);d.useEffect(()=>{if(i){const t=y.find(c=>c.ID===i);t&&(t.Type==="Category"?n({...t}):t.Type==="CategoryAuto"?(n(null),a({open:!0,type:"error",text:"لا يمكن تعديل تصنيف الي"}),o()):(n(null),a({open:!0,type:"error",text:"يمكن تعديل التصنيفات فقط"}),o()))}},[s]);const f=t=>{n(c=>({...c,[t.target.name]:t.target.value}))},D=async()=>{if(r&&r.Type==="Category")try{const t={CategoryName:r.Name};await N(r.Code,t),a({open:!0,type:"success",text:"تم تحديث التصنيف بنجاح"}),o()}catch(t){console.error("Error updating category:",t),a({open:!0,type:"error",text:"حدث خطأ أثناء تحديث التصنيف"})}else a({open:!0,type:"error",text:"لا يمكن حفظ التغييرات. هذا الحساب ليس تصنيفًا."})},E=()=>{r&&r.Type==="Category"?C(!0):a({open:!0,type:"error",text:"لا يمكن حذف هذا الحساب. يمكن حذف التصنيفات فقط."})},u=async t=>{if(C(!1),t&&r&&r.Type==="Category")try{await b(r.Code),a({open:!0,type:"success",text:"تم حذف التصنيف بنجاح"}),o()}catch(c){console.error("Error deleting category:",c.error),c.error.includes("Cannot delete category that has related qid entries")?a({open:!0,type:"error",text:"لا يمكن حذف تصنيف يحتوي على قيود"}):a({open:!0,type:"error",text:"حدث خطأ أثناء حذف التصنيف"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(x,{open:s,onClose:o,children:[e.jsx(h,{children:"تعديل التصنيف"}),e.jsx(g,{children:r&&e.jsx(j,{autoFocus:!0,margin:"dense",name:"Name",label:"اسم التصنيف",type:"text",fullWidth:!0,value:r.Name||"",onChange:f})}),e.jsxs(p,{children:[e.jsx(l,{color:"error",onClick:E,disabled:!r,children:"حذف"}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(l,{onClick:o,children:"إلغاء"}),e.jsx(l,{onClick:D,disabled:!r,children:"حفظ"})]})]}),e.jsxs(x,{open:m,onClose:()=>u(!1),children:[e.jsx(h,{children:"تأكيد الحذف"}),e.jsx(g,{children:"هل أنت متأكد من حذف هذا التصنيف؟"}),e.jsxs(p,{children:[e.jsx(l,{onClick:()=>u(!1),children:"إلغاء"}),e.jsx(l,{color:"error",onClick:()=>u(!0),children:"حذف"})]})]})]})},F=({open:s,onClose:o})=>{const[i,y]=d.useState({CategoryName:""}),a=n=>{y({...i,[n.target.name]:n.target.value})},r=async()=>{try{const n=await k(i);o()}catch(n){console.error("Error creating new category:",n)}};return e.jsxs(x,{open:s,onClose:o,children:[e.jsx(h,{children:"إضافة تصنيف جديد"}),e.jsx(g,{children:e.jsx(j,{autoFocus:!0,margin:"dense",name:"CategoryName",label:"اسم التصنيف",type:"text",fullWidth:!0,variant:"outlined",value:i.CategoryName,onChange:a})}),e.jsxs(p,{children:[e.jsx(l,{onClick:o,children:"إلغاء"}),e.jsx(l,{onClick:r,children:"حفظ"})]})]})};export{F as A,A as E};
