import{P as a,r as o,j as i,S as F,ap as x}from"./index-Bh1Mwprf.js";import{d as G}from"./Search-Cl48Th8C.js";import{g as O}from"./fetchdata-Bzmucct1.js";import{a as W}from"./FormHelperText-B649Xu3c.js";import{A as q}from"./Autocomplete-Cg6Ig2cR.js";import{T as v}from"./TextField-DtvSnH-b.js";import{I as B}from"./InputAdornment-CMztuF7B.js";import{C as K}from"./CircularProgress-DMIS8jmv.js";const L=t=>`${t.ID} - ${t.Name}`,M=({apiSearchEndpoint:t="/api/search",placeholder:s="بحث...",noOptionsText:l="لا يوجد خيارات",getOptionLabel:k=L,debounceDelay:T=500,onOptionSelect:C=()=>{},type:f="Category",value:m=null,LoadAllData:p=!1})=>{const[d,g]=o.useState(""),[D,u]=o.useState([]),[S,h]=o.useState(!1),[P,y]=o.useState(null),[c,w]=o.useState(null),[j,z]=o.useState([]),n=o.useCallback(k,[]);o.useMemo(()=>{m&&m.ID&&m.Name&&(w(m),g(n(m)))},[m,n]),o.useEffect(()=>{p&&(async()=>{h(!0),y(null);try{const e=await O(t,{type:f,LoadAllData:p});z(e),u(e)}catch{y("Error fetching data"),u([])}finally{h(!1)}})()},[p,t,f]);const I=o.useCallback(async r=>{if(p){const e=j.filter(b=>n(b).toLowerCase().includes(r.toLowerCase()));u(e);return}if(!(!r||c&&n(c)===r)){h(!0),y(null);try{const e=await O(t,{search:r,type:f});u(e)}catch{y("Error fetching data"),u([])}finally{h(!1)}}},[t,f,c,n,p,j]),A=o.useCallback((r,e)=>{w(e),e?(g(n(e)),C(e)):(g(""),C({ID:0,Name:null}))},[C,n]),N=o.useCallback((r,e)=>{g(e);const b=p?0:T;if(e&&(!c||n(c)!==e)){const $=setTimeout(()=>I(e),b);return()=>clearTimeout($)}else e||u([])},[T,I,c,n,p]),E=o.useCallback(()=>{d&&(!c||n(c)!==d)&&I(d)},[d,I,c,n]);return i.jsx(F,{direction:{xs:"column",sm:"row"},alignItems:"center",justifyContent:"space-between",spacing:2,children:i.jsx(W,{fullWidth:!0,size:"small",children:i.jsx(q,{fullWidth:!0,id:"autocomplete-search",options:D,getOptionLabel:n,loading:S,isOptionEqualToValue:(r,e)=>r.ID===e.ID,renderInput:r=>i.jsx(v,{...r,label:s,size:"small",onKeyPress:e=>{e.key==="Enter"&&E()},InputProps:{...r.InputProps,startAdornment:i.jsx(B,{position:"start",children:i.jsx(G,{fontSize:"small",onClick:E,style:{cursor:"pointer"}})}),endAdornment:i.jsxs(i.Fragment,{children:[S?i.jsx(K,{color:"inherit",size:20}):null,r.InputProps.endAdornment]})}}),value:c,inputValue:d,onChange:A,onInputChange:N,noOptionsText:P?"خطأ في الحصول على البيانات":l,loadingText:"قيد التحميل..."})})})};M.propTypes={apiSearchEndpoint:a.string,placeholder:a.string,noOptionsText:a.string,getOptionLabel:a.func,debounceDelay:a.number,onOptionSelect:a.func,type:a.string,value:a.shape({ID:a.oneOfType([a.string,a.number]),Name:a.string})};const Z=async t=>{try{const s=await x.post("/api/item/new",t);if(s.data&&s.data.ItemID)return s.data;throw new Error("Invalid response data")}catch(s){throw console.error("Error creating new item:",s.response?s.response.data:s.message),s}},V=async(t,s)=>{try{return(await x.put(`/api/item/${t}`,s)).data}catch(l){throw console.error("Error updating item:",l.response?l.response.data:l.message),l}},ee=async t=>{try{return(await x.get(`/api/item/${t}`)).data}catch(s){throw console.error("Error getting item by ID:",s.response?s.response.data:s.message),s}},te=async()=>{try{return(await x.get("/api/section")).data}catch(t){throw console.error("Error getting section data:",t.response?t.response.data:t.message),t}};export{M as A,ee as a,Z as c,te as g,V as u};
