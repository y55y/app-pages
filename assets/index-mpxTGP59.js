import{h as w,T as D,j as e,G as i,m as j,k as r,S as v,D as P,n as g,r as d,ax as M,z as f,ay as q,az as L,aA as K,I as Q,B as b,P as $,O as G,M as U,a$ as X}from"./index-B0WSqbsu.js";import{S as T}from"./SubCard-S3Bm2fjm.js";import{d as O}from"./DescriptionTwoTone-C8paD3Lr.js";import{T as A}from"./TextField-cICNou46.js";import{T as N,a as H,b as m,c as W}from"./TableRow-DrLn4BSI.js";import{T as z}from"./TableHead-BivyvsJd.js";import{T as t}from"./TableCell-BBwK6Z2L.js";import{R as J}from"./index-DPM_OJLP.js";import{F as Y,T as Z,a as ee,b as ie,c as re,d as ne,e as te,f as se,g as le,h as ae}from"./LocalShippingTwoTone-CXIqhQlw.js";import{i as ce}from"./invoice-hRkVpvmR.js";import{D as de,a as xe,b as oe}from"./DialogContent-Csvn7Po_.js";import{d as he}from"./ReceiptTwoTone-whxRIb4p.js";import{C as je}from"./CircularProgress-N5_xb1EP.js";import{T as me,a as k}from"./Tabs-BzOwIpz8.js";import"./FormHelperText-C2iB3Qrk.js";import"./DialogTitle-DppFMRhx.js";import"./KeyboardArrowRight-TeRhs2oj.js";const ue=({entryData:n})=>{const c=w();n.entries.reduce((s,l)=>s+l.qidEAmountD,0);const a={borderColor:c.palette.mode===D.DARK?"divider":"primary.light"};return e.jsxs(i,{container:!0,spacing:j,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(T,{title:"تفاصيل القيد",secondary:e.jsxs(r,{variant:"subtitle1",children:["القيد منشاء في ",e.jsx("strong",{children:new Date(n.qidDate).toISOString().split("T")[0]})]}),children:e.jsxs(i,{container:!0,spacing:j,children:[e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,children:e.jsxs(v,{direction:"row",children:[e.jsxs(r,{variant:"h4",display:"flex",sx:{fontSize:"1rem"},children:[e.jsx(O,{sx:{mr:.5,mt:.25}}),"قيد رقم #"]}),e.jsx(r,{variant:"h3",sx:{fontSize:"1rem"},children:n.qidID})]})}),e.jsx(i,{item:!0,children:e.jsx(r,{variant:"body2",display:"flex",children:e.jsx(v,{direction:"row",children:e.jsx(r,{variant:"h3",sx:{fontSize:"1rem"},children:n.TypeName})})})}),e.jsx(i,{item:!0,children:e.jsx(r,{variant:"body2",display:"flex",children:e.jsxs(v,{direction:"row",children:[e.jsx(r,{variant:"h4",sx:{fontSize:"1rem"},children:"بتاريخ :"}),e.jsx(r,{variant:"h3",sx:{fontSize:"1rem"},children:new Date(n.qidDateIsu).toISOString().split("T")[0]})]})})})]})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(P,{sx:a})}),e.jsx(i,{item:!0,xs:11,children:e.jsx(A,{label:"ملاحظات",value:n.description,sx:{margin:0},fullWidth:!0,multiline:!0,rows:1,maxRows:2,margin:"normal"})}),e.jsx(i,{item:!0,display:"flex",justifyContent:"flex-end",children:e.jsx(g,{variant:"contained",color:"primary",children:"حفظ"})})]})})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(T,{title:"القيد",content:!1,children:e.jsx(i,{container:!0,spacing:3,children:e.jsx(i,{item:!0,xs:12,children:e.jsx(N,{children:e.jsxs(H,{children:[e.jsx(z,{children:e.jsxs(m,{children:[e.jsx(t,{align:"left",sx:{flex:1},children:"الحساب"}),e.jsx(t,{align:"left",sx:{flex:2},children:"الوصف"}),e.jsx(t,{align:"left",sx:{flex:1},children:"المدين"}),e.jsx(t,{align:"left",sx:{flex:1},children:"الدائن"})]})}),e.jsxs(W,{children:[n.entries.length===0?e.jsx(m,{children:e.jsx(t,{colSpan:4,align:"center",children:e.jsx(r,{variant:"body2",color:"textSecondary",children:"لا توجد قيود"})})}):n.entries.map((s,l)=>e.jsxs(m,{children:[e.jsx(t,{align:"left",children:`${s.qidEAcc} - ${s.AccName}`}),e.jsxs(t,{align:"left",children:[n.qidINV?`${n.TypeN} (${n.qidINV})`:""," ",n.qidRef?`${n.TypeR} (${n.qidRef})`:""," ",s.qidEnote?` - ${s.qidEnote}`:""]}),e.jsx(t,{align:"left",children:s.qidEAmountD}),e.jsx(t,{align:"left",children:s.qidEAmountC})]},l)),n.entries.length>0&&e.jsxs(m,{style:{backgroundColor:"#f0f0f0"},children:[e.jsx(t,{align:"left",children:"الاجمالي"}),e.jsx(t,{align:"left"}),e.jsx(t,{align:"left",children:n.entries.reduce((s,l)=>s+l.qidEAmountD,0)}),e.jsx(t,{align:"left",children:n.entries.reduce((s,l)=>s+l.qidEAmountC,0)})]})]})]})})})})})})]})},pe=({invoiceData:n})=>{const c=w(),a=d.useRef(null),s=n.order_entries.reduce((l,h)=>l+h.QuantityOnOrder,0);return e.jsxs(i,{container:!0,justifyContent:"center",spacing:j,children:[e.jsx(i,{item:!0,xs:12,md:10,lg:8,ref:a,sx:{direction:"ltr"},children:e.jsx(T,{darkTitle:!0,title:`سند استلام فاتورة مشتريات #${n.invoice_id}`,secondary:e.jsx(M,{}),children:e.jsxs(i,{container:!0,spacing:j,children:[e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:j,children:[e.jsx(i,{item:!0,sm:5,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"المورد :"})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:0,children:[e.jsx(i,{item:!0,xs:4,children:e.jsx(r,{variant:"body2",children:"الاسم :"})}),e.jsx(i,{item:!0,xs:8,children:e.jsx(r,{variant:"body2",children:n.supplier_name})}),e.jsx(i,{item:!0,xs:4,sx:{my:.5},children:e.jsx(r,{variant:"body2",children:"الهاتف :"})}),e.jsx(i,{item:!0,xs:8,sx:{my:.5},children:n.MobileNumber}),e.jsx(i,{item:!0,xs:4,children:e.jsx(r,{variant:"body2",children:"الايميل :"})}),e.jsx(i,{item:!0,xs:8,children:e.jsx(r,{variant:"body2",component:f,to:"#",children:n.email})})]})})]})}),e.jsx(i,{item:!0,sm:4,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"تفاصيل الفاتورة :"})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:0,children:[e.jsx(i,{item:!0,xs:4,children:e.jsx(r,{variant:"body2",children:"التاريخ :"})}),e.jsx(i,{item:!0,xs:8,children:e.jsx(r,{variant:"body2",children:n.date})}),e.jsx(i,{item:!0,xs:4,children:e.jsx(r,{variant:"body2",children:"الفاتورة :"})}),e.jsx(i,{item:!0,xs:8,children:e.jsx(r,{variant:"body2",component:f,to:"#",children:n.SupplierInvoiceNumber})}),e.jsx(i,{item:!0,xs:4,sx:{my:.5},children:e.jsx(r,{variant:"body2",children:"الفرع :"})}),e.jsx(i,{item:!0,xs:8,sx:{my:.5},children:"المتكامل"})]})})]})})]})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(N,{children:e.jsxs(H,{sx:{"& tr:last-of-type td":{borderBottom:"none"},"& thead tr th":{borderBottom:"none"},"& th:first-of-type, & td:first-of-type":{pl:{xs:2.5,md:5}},"& th:last-of-type, & td:last-of-type":{pr:{xs:6.25,md:8.75}}},children:[e.jsx(z,{children:e.jsxs(m,{children:[e.jsx(t,{align:"center",children:"رقم المنتج"}),e.jsx(t,{align:"center",children:"كود المنتج"}),e.jsx(t,{sx:{pl:3},children:"الاسم"}),e.jsx(t,{align:"center",children:"الكمية"}),e.jsx(t,{align:"center",children:"سعر البيع"})]})}),e.jsx(W,{children:n.order_entries.length===0?e.jsx(m,{children:e.jsx(t,{colSpan:8,align:"center",children:e.jsx(r,{variant:"body2",color:"textSecondary",children:"لا يوجد اصناف مضافة في الفاتورة"})})}):n.order_entries.map((l,h)=>e.jsxs(m,{children:[e.jsx(t,{align:"center",children:l.BarCodeNo}),e.jsx(t,{align:"center",children:l.Supplier_Item_ID}),e.jsxs(t,{sx:{pl:3,padding:"0px"},children:[e.jsx(r,{variant:"subtitle1",children:l.name}),e.jsx(r,{variant:"body2",children:l.DepartmentName})]}),e.jsx(t,{align:"center",children:l.QuantityOnOrder}),e.jsx(t,{align:"center",children:l.offerPrice})]},h))})]})})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(T,{sx:{bgcolor:c.palette.mode===D.DARK?"dark.main":"primary.light"},children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{variant:"h6",children:"ملاحظات :"})}),e.jsx(i,{container:!0,justifyContent:"flex-end",spacing:j,children:e.jsx(i,{item:!0,sm:6,md:4,children:e.jsx(i,{container:!0,spacing:2,children:e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{align:"right",variant:"subtitle1",children:"اجمالي الكمية:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{align:"left",variant:"body2",children:s})})]})})})})})]})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:2,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(P,{})}),e.jsx(i,{item:!0,xs:7,children:e.jsx(r,{variant:"h6",children:"اسم المستلم / التوقيع :"})}),e.jsx(i,{item:!0,xs:5,children:e.jsx(r,{variant:"h6",children:"اسم المشرف / التوقيع :"})})]})})]})})}),e.jsx(i,{item:!0,xs:12,lg:8,children:e.jsx(v,{direction:"row",justifyContent:"center",children:e.jsx(q,{children:e.jsx(J,{trigger:()=>e.jsx(g,{variant:"contained",children:"طباعة"}),content:()=>a.current})})})})]})},ge={p:0,"& > svg":{width:14,height:14},display:{xs:"none",md:"flex"}},fe=d.forwardRef((n,c)=>e.jsx(L,{direction:"left",ref:c,...n})),ye=n=>{const c=w(),[a,s]=d.useState(!1),[l,h]=d.useState(""),[u,R]=d.useState([]),[p,C]=d.useState(!1),[E,_]=d.useState(null);d.useEffect(()=>{(async()=>{try{console.log("Fetching invoice status history for invoice ID:",n.invoiceData);const y=await ce(n.invoiceData.invoice_id);R(y)}catch(y){console.error("Error fetching invoice status history:",y)}})()},[]);const o=()=>{s(!a)},F=x=>{h(x.target.value)},B=()=>{console.log("Review posted:",l),s(!1),h("")},V=x=>{_(x),C(!0)};return e.jsx(T,{title:"حالة الفاتورة",children:e.jsxs(i,{container:!0,spacing:j,children:[e.jsx(i,{item:!0,xs:12,children:e.jsxs(i,{container:!0,spacing:0,children:[e.jsx(i,{item:!0,xs:12,md:6,lg:3,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"تاريخ الفاتورة"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"body2",children:n.invoiceData.date})})]})}),e.jsx(i,{item:!0,xs:12,sm:6,lg:2,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"حالة الفاتورة"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"body2",children:n.invoiceData.status})})]})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"الناقل"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"body2",children:"Fedex Express Delivery"})})]})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"الدفع"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"body2",children:"Credit Card"})})]})}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:2,children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"h5",children:"مبلغ الفاتورة"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(r,{variant:"body2",children:n.invoiceData.total})})]})})]})}),e.jsx(Y,{open:p,onClose:()=>C(!1),imageID:E}),e.jsxs(i,{item:!0,md:8,lg:9,children:[e.jsx(Z,{sx:{"& > li":{mb:2.75,[c.breakpoints.down("md")]:{flexDirection:"column","& > div":{px:0},"& > div:first-of-type":{textAlign:"left"}}},[c.breakpoints.down("md")]:{p:0}},children:u.map((x,y)=>e.jsxs(ee,{children:[e.jsxs(ie,{children:[e.jsx(r,{variant:"h5",children:x.Status_name}),e.jsx(r,{variant:"body2",children:x.Start_date})]}),e.jsxs(re,{children:[e.jsx(ne,{color:x.Start_date!==null?"primary":"inherit",sx:ge,children:e.jsx(K,{})}),e.jsx(te,{sx:{bgcolor:x.Start_date!==null?"primary.main":"grey.400"}})]}),e.jsxs(se,{sx:{flex:3},children:[x.UploadDate&&e.jsx(Q,{"aria-label":"view file",onClick:()=>V(x.ImageID),children:e.jsx(le,{})}),e.jsx(r,{children:x.Comment})]})]},y))}),e.jsx(i,{container:!0,spacing:1,justifyContent:"center",children:e.jsx(i,{item:!0,children:e.jsxs(b,{sx:{display:{xs:"block",md:"none"}},children:[e.jsx(g,{variant:"contained",onClick:o,children:"Write a Review"}),e.jsx(de,{open:a,TransitionComponent:fe,keepMounted:!0,onClose:o,sx:{"&>div:nth-of-type(3)":{justifyContent:"flex-end","&>div":{m:0,borderRadius:"0px",maxWidth:450,maxHeight:"100%",height:"100vh"}}},children:a&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:e.jsx(i,{container:!0,spacing:1,children:e.jsx(i,{item:!0,xs:12,children:e.jsx(A,{id:"outlined-basic1",fullWidth:!0,multiline:!0,rows:10,label:"Write a Review",value:l,onChange:F})})})}),e.jsxs(oe,{children:[e.jsx(q,{children:e.jsx(g,{variant:"contained",onClick:B,children:"Post Review"})}),e.jsx(g,{variant:"text",onClick:o,color:"secondary",children:"Close"})]})]})})]})})})]}),e.jsx(i,{item:!0,md:4,lg:3,children:e.jsx(b,{sx:{display:{xs:"none",md:"block"}},children:e.jsxs(i,{container:!0,spacing:1,children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(A,{id:"outlined-basic2",fullWidth:!0,multiline:!0,rows:10,label:"Write a Review",value:l,onChange:F})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(v,{direction:"row",children:e.jsx(q,{children:e.jsx(g,{variant:"contained",onClick:B,children:"Post Review"})})})})]})})})]})})};function S({children:n,value:c,index:a,...s}){return e.jsx("div",{role:"tabpanel",hidden:c!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...s,children:c===a&&e.jsx(b,{sx:{p:0},children:n})})}function I(n){return{id:`simple-tab-${n}`,"aria-controls":`simple-tabpanel-${n}`}}S.propTypes={children:$.node,index:$.number,value:$.number};const Pe=()=>{const n=w(),{id:c}=G(),[a,s]=d.useState(!0),[l,h]=d.useState(null),[u,R]=d.useState(null);d.useEffect(()=>{(async()=>{s(!0);try{const o=await X(c);console.log("Fetched entry data:",o),R(o)}catch(o){console.error("Error fetching entry:",o),h("Error fetching entry data")}finally{s(!1)}})()},[c]);const[p,C]=d.useState(0),E=(_,o)=>{C(o)};return a?e.jsxs(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:[e.jsx(je,{}),e.jsx(r,{variant:"h6",sx:{marginLeft:2},children:"...البيانات قيد التحميل"})]}):l||!u?e.jsxs(b,{sx:{textAlign:"center",marginTop:4},children:[e.jsx(r,{variant:"h6",color:"error",children:"حدث خطاء عند تحميل البيانات."}),e.jsx(f,{to:"/entries",children:"العودة الى"})]}):e.jsxs(U,{children:[e.jsxs(me,{value:p,indicatorColor:"primary",textColor:"primary",onChange:E,variant:"scrollable","aria-label":"simple tabs example",sx:{"& a":{minHeight:"auto",minWidth:10,px:1,py:1.5,mr:2.25,color:n.palette.mode===D.DARK?"grey.600":"grey.900",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},"& a.Mui-selected":{color:"primary.main"},"& a > svg":{marginBottom:"0px !important",marginRight:1.25},mb:3},children:[e.jsx(k,{icon:e.jsx(O,{}),component:f,to:"#",label:"التفاصيل",...I(0)}),e.jsx(k,{icon:e.jsx(he,{}),component:f,to:"#",label:"سند القيد",...I(1)}),e.jsx(k,{icon:e.jsx(ae,{}),component:f,to:"#",label:"الحالة",...I(2)})]}),e.jsx(S,{value:p,index:0,children:e.jsx(ue,{entryData:u})}),e.jsx(S,{value:p,index:1,children:e.jsx(pe,{entryData:u})}),e.jsx(S,{value:p,index:2,children:e.jsx(ye,{entryData:u})})]})};export{Pe as default};
