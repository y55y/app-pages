import{P as n,r as s,j as a,S as G}from"./index-C0c3XiV2.js";import{d as W}from"./Search-Djx6PcN-.js";import{g as I}from"./fetchdata-BNXO2gQn.js";import{a as $}from"./FormHelperText-CCi1g0af.js";import{A as q}from"./Autocomplete-C4zYcqHj.js";import{T as K}from"./TextField-CJRyQ6g_.js";import{I as L}from"./InputAdornment-CmdB_Owm.js";import{C as M}from"./CircularProgress-BuhaouQw.js";const R=i=>`${i.ID} - ${i.Name}`,_=({apiSearchEndpoint:i="/api/search",placeholder:O="بحث...",noOptionsText:k="لا يوجد خيارات",getOptionLabel:P=R,debounceDelay:T=500,onOptionSelect:x=()=>{},type:f="Category",value:c=null,LoadAllData:l=!1})=>{const[m,p]=s.useState(""),[E,u]=s.useState([]),[b,d]=s.useState(!1),[z,h]=s.useState(null),[o,y]=s.useState(null),[S,A]=s.useState([]),r=s.useCallback(P,[]);s.useMemo(()=>{c&&c.ID&&c.Name&&(y(c),p(r(c)))},[c,r]),s.useEffect(()=>{l&&(async()=>{d(!0),h(null);try{const e=await I(i,{type:f,LoadAllData:l});A(e),u(e)}catch{h("Error fetching data"),u([])}finally{d(!1)}})()},[l,i,f]);const g=s.useCallback(async t=>{if(l){const e=S.filter(C=>r(C).toLowerCase().includes(t.toLowerCase()));u(e);return}if(!(!t||o&&r(o)===t)){d(!0),h(null);try{const e=await I(i,{search:t,type:f});u(e)}catch{h("Error fetching data"),u([])}finally{d(!1)}}},[i,f,o,r,l,S]),D=s.useCallback((t,e)=>{y(e),e?(p(r(e)),x(e)):(p(""),x({ID:0,Name:null}))},[x,r]),N=s.useCallback((t,e)=>{p(e);const C=l?0:T;if(e&&(!o||r(o)!==e)){const F=setTimeout(()=>g(e),C);return()=>clearTimeout(F)}else e||u([])},[T,g,o,r,l]),j=s.useCallback(()=>{m&&(!o||r(o)!==m)&&g(m)},[m,g,o,r]);return a.jsx(G,{direction:{xs:"column",sm:"row"},alignItems:"center",justifyContent:"space-between",spacing:2,children:a.jsx($,{fullWidth:!0,size:"small",children:a.jsx(q,{fullWidth:!0,id:"autocomplete-search",options:E,getOptionLabel:r,loading:b,isOptionEqualToValue:(t,e)=>t.ID===e.ID,renderInput:t=>a.jsx(K,{...t,label:O,size:"small",onKeyPress:e=>{e.key==="Enter"&&j()},InputProps:{...t.InputProps,startAdornment:a.jsx(L,{position:"start",children:a.jsx(W,{fontSize:"small",onClick:j,style:{cursor:"pointer"}})}),endAdornment:a.jsxs(a.Fragment,{children:[b?a.jsx(M,{color:"inherit",size:20}):null,t.InputProps.endAdornment]})}}),value:o,inputValue:m,onChange:D,onInputChange:N,noOptionsText:z?"خطأ في الحصول على البيانات":k,loadingText:"قيد التحميل..."})})})};_.propTypes={apiSearchEndpoint:n.string,placeholder:n.string,noOptionsText:n.string,getOptionLabel:n.func,debounceDelay:n.number,onOptionSelect:n.func,type:n.string,value:n.shape({ID:n.oneOfType([n.string,n.number]),Name:n.string})};export{_ as A};
