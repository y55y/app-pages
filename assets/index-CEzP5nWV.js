import{r as x,j as d,a4 as te,a5 as Ks,R as Ee,a6 as ed,a7 as Xt,a8 as Np,a9 as Ip,aa as Pp,ab as Ap,ac as $n,ad as Rp,ae as td,af as jp,ag as Ta,ah as Lp,ai as nd,aj as xo,ak as Fp,al as K,U as ql,P as se,B as $e,G as H,m as $p,I as Sr,am as Bp,an as rd,f as sd,i as od,S as id,n as Qe,$ as ad,a0 as ld,k as gt,ao as _p,_ as cd,a1 as zp,N as ud,h as Hp,X as Vp,Y as Wp,ap as Up,s as qp,O as Yp,aq as Kp,M as Gp}from"./index-BVdUMQzQ.js";import{r as Q,t as G,c as Oe,d as Da,e as Ir,h as Ri,i as nn,j as Jp,k as ji,l as dd,m as Qp,n as Xp,o as fd,p as Yl,q as Zp,v as Kl,w as em,x as tm,f as Jr,u as hd,C as ke,y as nm,b as bo,z as Gl,F as rm}from"./index-DZTpUL15.js";import{a as sm,b as om,e as im,f as Jl,h as am}from"./invoice-DpuTS3_u.js";import{g as Li}from"./fetchdata-EOtbV5TB.js";import{T as we,S as Fi}from"./TextField-BpMEqyGd.js";import{A as $i,g as lm}from"./item-DodNbPzd.js";import{F as cm,a as cn,I as Bi}from"./FormHelperText-Ddk6A_UX.js";import{A as pd,d as _i,a as Ea}from"./ag-theme-alpine-CuMdagiT.js";import um from"./AddItem-CMloWsrj.js";import dm from"./EditItem-CXUvHrWv.js";import{D as Zn,a as er,b as hs}from"./DialogContent-8g-uaxVZ.js";import{D as tr}from"./DialogTitle-De5HDiQS.js";import{C as Pr,A as vo}from"./CustomAccordion-B8BjyIWK.js";import{d as fm}from"./Search-C8CX3S6J.js";import{d as hm}from"./Delete-BgrzcClf.js";import{I as Qr}from"./InputAdornment-CrMgPK6V.js";import{M as zi}from"./MenuItem-BOBO7Pa6.js";import{A as pm}from"./AutocompleteEditor-CGKPNiIy.js";import{R as mm,a as Ql}from"./RadioGroup-DYKE8jts.js";import{F as Xl}from"./FormControlLabel-DHYN22g9.js";import{s as gm,c as ym}from"./payment-Gm7mpQBN.js";import{L as Oa,D as Na}from"./DatePicker-S1SEzyoX.js";import{_ as md}from"./typeof-QjJsDpFa.js";import{t as gd,D as xm}from"./DataGrid-DMIjrIuv.js";import{C as Ia}from"./CircularProgress-CEBJzR_F.js";import{A as bm}from"./Autocomplete-D9EHyKg-.js";import{M as vm}from"./MessageSnackbar-Dd6YaDgZ.js";import{D as wm}from"./DeleteComponent-DuBIyZFp.js";import"./InputFileUpload-BKoAOPSU.js";import"./formik.esm-jehN7sSp.js";import"./CardMedia-CNpcyg8V.js";import"./Tabs-BG6yMNAL.js";import"./KeyboardArrowRight-w44rCLkW.js";import"./Checkbox-J416lFQR.js";import"./ListItem-95QgD0G9.js";import"./Skeleton-BEOxZ8sC.js";import"./TablePagination-ZYSYCgUV.js";import"./TableCell-y3q6i7yU.js";import"./DialogContentText-BqtvGEMb.js";function km(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function ps(n){return Object.keys(n).reduce((e,t)=>(n[t]!==void 0&&(e[t]=n[t]),e),{})}function yd(n){return typeof n=="number"?!0:typeof n=="string"?n.startsWith("calc(")||n.startsWith("var(")||n.includes(" ")&&n.trim()!==""?!0:/[0-9]/.test(n.trim().replace("-","")[0]):!1}function wo(n){return Array.isArray(n)||n===null?!1:typeof n=="object"?n.type!==x.Fragment:!1}function xd(n){const e=x.createContext(null);return[({children:s,value:o})=>d.jsx(e.Provider,{value:o,children:s}),()=>{const s=x.useContext(e);if(s===null)throw new Error(n);return s}]}function bd(n=null){const e=x.createContext(n);return[({children:s,value:o})=>d.jsx(e.Provider,{value:o,children:s}),()=>x.useContext(e)]}const Cm={app:100,modal:200,popover:300,overlay:400,max:9999};function Pa(n){return Cm[n]}const Sm=()=>{};function Mm(n,e={active:!0}){return typeof n!="function"||!e.active?e.onKeyDown||Sm:t=>{var r;t.key==="Escape"&&(n(t),(r=e.onTrigger)==null||r.call(e))}}function nt(n,e="size",t=!0){if(n!==void 0)return yd(n)?t?te(n):n:`var(--${e}-${n})`}function Dt(n){return nt(n,"mantine-spacing")}function nr(n){return n===void 0?"var(--mantine-radius-default)":nt(n,"mantine-radius")}function qt(n){return nt(n,"mantine-font-size")}function Tm(n){if(n)return nt(n,"mantine-shadow",!1)}function Dm(n,e){return n in e.breakpoints?Ks(e.breakpoints[n]):Ks(n)}function Em(n,e){const t=n.map(r=>({value:r,px:Dm(r,e)}));return t.sort((r,s)=>r.px-s.px),t}function xr(n){return typeof n=="object"&&n!==null?"base"in n?n.base:void 0:n}function Gs(n,e,t){return e===void 0&&t===void 0?n:e!==void 0&&t===void 0?Math.max(n,e):Math.min(e===void 0&&t!==void 0?n:Math.max(n,e),t)}function vd(){return`mantine-${Math.random().toString(36).slice(2,11)}`}const Zl=["mousedown","touchstart"];function Om(n,e,t){const r=x.useRef();return x.useEffect(()=>{const s=o=>{const{target:i}=o??{};if(Array.isArray(t)){const a=(i==null?void 0:i.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(i)&&i.tagName!=="HTML";t.every(c=>!!c&&!o.composedPath().includes(c))&&!a&&n()}else r.current&&!r.current.contains(i)&&n()};return(e||Zl).forEach(o=>document.addEventListener(o,s)),()=>{(e||Zl).forEach(o=>document.removeEventListener(o,s))}},[r,n,t]),r}function Nm(n,e){try{return n.addEventListener("change",e),()=>n.removeEventListener("change",e)}catch{return n.addListener(e),()=>n.removeListener(e)}}function Im(n,e){return typeof e=="boolean"?e:typeof window<"u"&&"matchMedia"in window?window.matchMedia(n).matches:!1}function Pm(n,e,{getInitialValueInEffect:t}={getInitialValueInEffect:!0}){const[r,s]=x.useState(t?e:Im(n)),o=x.useRef();return x.useEffect(()=>{if("matchMedia"in window)return o.current=window.matchMedia(n),s(o.current.matches),Nm(o.current,i=>s(i.matches))},[n]),r}function zt(n,e){const t=x.useRef(!1);x.useEffect(()=>()=>{t.current=!1},[]),x.useEffect(()=>{if(t.current)return n();t.current=!0},e)}function Am({opened:n,shouldReturnFocus:e=!0}){const t=x.useRef(),r=()=>{var s;t.current&&"focus"in t.current&&typeof t.current.focus=="function"&&((s=t.current)==null||s.focus({preventScroll:!0}))};return zt(()=>{let s=-1;const o=i=>{i.key==="Tab"&&window.clearTimeout(s)};return document.addEventListener("keydown",o),n?t.current=document.activeElement:e&&(s=window.setTimeout(r,10)),()=>{window.clearTimeout(s),document.removeEventListener("keydown",o)}},[n,e]),r}function Rm(n,e="body > :not(script)"){const t=vd(),r=Array.from(document.querySelectorAll(e)).map(s=>{var l;if((l=s==null?void 0:s.shadowRoot)!=null&&l.contains(n)||s.contains(n))return;const o=s.getAttribute("aria-hidden"),i=s.getAttribute("data-hidden"),a=s.getAttribute("data-focus-id");return s.setAttribute("data-focus-id",t),o===null||o==="false"?s.setAttribute("aria-hidden","true"):!i&&!a&&s.setAttribute("data-hidden",o),{node:s,ariaHidden:i||null}});return()=>{r.forEach(s=>{!s||t!==s.node.getAttribute("data-focus-id")||(s.ariaHidden===null?s.node.removeAttribute("aria-hidden"):s.node.setAttribute("aria-hidden",s.ariaHidden),s.node.removeAttribute("data-focus-id"),s.node.removeAttribute("data-hidden"))})}}const jm=/input|select|textarea|button|object/,wd="a, input, select, textarea, button, object, [tabindex]";function Lm(n){return n.style.display==="none"}function Fm(n){if(n.getAttribute("aria-hidden")||n.getAttribute("hidden")||n.getAttribute("type")==="hidden")return!1;let t=n;for(;t&&!(t===document.body||t.nodeType===11);){if(Lm(t))return!1;t=t.parentNode}return!0}function kd(n){let e=n.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function Hi(n){const e=n.nodeName.toLowerCase(),t=!Number.isNaN(kd(n));return(jm.test(e)&&!n.disabled||n instanceof HTMLAnchorElement&&n.href||t)&&Fm(n)}function Cd(n){const e=kd(n);return(Number.isNaN(e)||e>=0)&&Hi(n)}function $m(n){return Array.from(n.querySelectorAll(wd)).filter(Cd)}function Bm(n,e){const t=$m(n);if(!t.length){e.preventDefault();return}const r=t[e.shiftKey?0:t.length-1],s=n.getRootNode();let o=r===s.activeElement||n===s.activeElement;const i=s.activeElement;if(i.tagName==="INPUT"&&i.getAttribute("type")==="radio"&&(o=t.filter(u=>u.getAttribute("type")==="radio"&&u.getAttribute("name")===i.getAttribute("name")).includes(r)),!o)return;e.preventDefault();const l=t[e.shiftKey?t.length-1:0];l&&l.focus()}function _m(n=!0){const e=x.useRef(),t=x.useRef(null),r=o=>{let i=o.querySelector("[data-autofocus]");if(!i){const a=Array.from(o.querySelectorAll(wd));i=a.find(Cd)||a.find(Hi)||null,!i&&Hi(o)&&(i=o)}i&&i.focus({preventScroll:!0})},s=x.useCallback(o=>{if(n){if(o===null){t.current&&(t.current(),t.current=null);return}t.current=Rm(o),e.current!==o&&(o?(setTimeout(()=>{o.getRootNode()&&r(o)}),e.current=o):e.current=null)}},[n]);return x.useEffect(()=>{if(!n)return;e.current&&setTimeout(()=>r(e.current));const o=i=>{i.key==="Tab"&&e.current&&Bm(e.current,i)};return document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o),t.current&&t.current()}},[n]),s}const zm=Ee.useId||(()=>{});function Hm(){const n=zm();return n?`mantine-${n.replace(/:/g,"")}`:""}function Aa(n){const e=Hm(),[t,r]=x.useState(e);return ed(()=>{r(vd())},[]),typeof n=="string"?n:typeof window>"u"?e:t}function Vm(n,e,t){x.useEffect(()=>(window.addEventListener(n,e,t),()=>window.removeEventListener(n,e,t)),[n,e])}function Sd(n,e){typeof n=="function"?n(e):typeof n=="object"&&n!==null&&"current"in n&&(n.current=e)}function Wm(...n){return e=>{n.forEach(t=>Sd(t,e))}}function Ar(...n){return x.useCallback(Wm(...n),n)}function Md(n){return{x:Gs(n.x,0,1),y:Gs(n.y,0,1)}}function Td(n,e,t="ltr"){const r=x.useRef(null),s=x.useRef(!1),o=x.useRef(!1),i=x.useRef(0),[a,l]=x.useState(!1);return x.useEffect(()=>{s.current=!0},[]),x.useEffect(()=>{var v,w;const c=({x:C,y:M})=>{cancelAnimationFrame(i.current),i.current=requestAnimationFrame(()=>{if(s.current&&r.current){r.current.style.userSelect="none";const k=r.current.getBoundingClientRect();if(k.width&&k.height){const T=Gs((C-k.left)/k.width,0,1);n({x:t==="ltr"?T:1-T,y:Gs((M-k.top)/k.height,0,1)})}}})},u=()=>{document.addEventListener("mousemove",g),document.addEventListener("mouseup",p),document.addEventListener("touchmove",b),document.addEventListener("touchend",p)},f=()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",p),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",p)},h=()=>{!o.current&&s.current&&(o.current=!0,typeof(e==null?void 0:e.onScrubStart)=="function"&&e.onScrubStart(),l(!0),u())},p=()=>{o.current&&s.current&&(o.current=!1,l(!1),f(),setTimeout(()=>{typeof(e==null?void 0:e.onScrubEnd)=="function"&&e.onScrubEnd()},0))},m=C=>{h(),C.preventDefault(),g(C)},g=C=>c({x:C.clientX,y:C.clientY}),y=C=>{C.cancelable&&C.preventDefault(),h(),b(C)},b=C=>{C.cancelable&&C.preventDefault(),c({x:C.changedTouches[0].clientX,y:C.changedTouches[0].clientY})};return(v=r.current)==null||v.addEventListener("mousedown",m),(w=r.current)==null||w.addEventListener("touchstart",y,{passive:!1}),()=>{r.current&&(r.current.removeEventListener("mousedown",m),r.current.removeEventListener("touchstart",y))}},[t,n]),{ref:r,active:a}}function Dd({value:n,defaultValue:e,finalValue:t,onChange:r=()=>{}}){const[s,o]=x.useState(e!==void 0?e:t),i=(a,...l)=>{o(a),r==null||r(a,...l)};return n!==void 0?[n,r,!0]:[s,i,!1]}function Um(n,e){return Pm("(prefers-reduced-motion: reduce)",n,e)}function qm(n){return e=>{if(!e)n(e);else if(typeof e=="function")n(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:t}=e;t.type==="checkbox"?n(t.checked):n(t.value)}else n(e)}}function Ym(n){const[e,t]=x.useState(n);return[e,qm(t)]}function Ed(n=!1,e){const{onOpen:t,onClose:r}=e||{},[s,o]=x.useState(n),i=x.useCallback(()=>{o(c=>c||(t==null||t(),!0))},[t]),a=x.useCallback(()=>{o(c=>c&&(r==null||r(),!1))},[r]),l=x.useCallback(()=>{s?a():i()},[a,i,s]);return[s,{open:i,close:a,toggle:l}]}function Od(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=Od(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Zt(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=Od(n))&&(r&&(r+=" "),r+=e);return r}const Km={};function Gm(n){const e={};return n.forEach(t=>{Object.entries(t).forEach(([r,s])=>{e[r]?e[r]=Zt(e[r],s):e[r]=s})}),e}function ko({theme:n,classNames:e,props:t,stylesCtx:r}){const o=(Array.isArray(e)?e:[e]).map(i=>typeof i=="function"?i(n,t,r):i||Km);return Gm(o)}function Js({theme:n,styles:e,props:t,stylesCtx:r}){return(Array.isArray(e)?e:[e]).reduce((o,i)=>typeof i=="function"?{...o,...i(n,t,r)}:{...o,...i},{})}function Jm({classNames:n,styles:e,props:t,stylesCtx:r}){const s=Xt();return{resolvedClassNames:ko({theme:s,classNames:n,props:t,stylesCtx:r||void 0}),resolvedStyles:Js({theme:s,styles:e,props:t,stylesCtx:r||void 0})}}const Qm={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function Xm({theme:n,options:e,unstyled:t}){return Zt((e==null?void 0:e.focusable)&&!t&&(n.focusClassName||Qm[n.focusRing]),(e==null?void 0:e.active)&&!t&&n.activeClassName)}function Zm({selector:n,stylesCtx:e,options:t,props:r,theme:s}){return ko({theme:s,classNames:t==null?void 0:t.classNames,props:(t==null?void 0:t.props)||r,stylesCtx:e})[n]}function ec({selector:n,stylesCtx:e,theme:t,classNames:r,props:s}){return ko({theme:t,classNames:r,props:s,stylesCtx:e})[n]}function eg({rootSelector:n,selector:e,className:t}){return n===e?t:void 0}function tg({selector:n,classes:e,unstyled:t}){return t?void 0:e[n]}function ng({themeName:n,classNamesPrefix:e,selector:t,withStaticClass:r}){return r===!1?[]:n.map(s=>`${e}-${s}-${t}`)}function rg({themeName:n,theme:e,selector:t,props:r,stylesCtx:s}){return n.map(o=>{var i,a;return(a=ko({theme:e,classNames:(i=e.components[o])==null?void 0:i.classNames,props:r,stylesCtx:s}))==null?void 0:a[t]})}function sg({options:n,classes:e,selector:t,unstyled:r}){return n!=null&&n.variant&&!r?e[`${t}--${n.variant}`]:void 0}function og({theme:n,options:e,themeName:t,selector:r,classNamesPrefix:s,classNames:o,classes:i,unstyled:a,className:l,rootSelector:c,props:u,stylesCtx:f,withStaticClasses:h,headless:p,transformedStyles:m}){return Zt(Xm({theme:n,options:e,unstyled:a||p}),rg({theme:n,themeName:t,selector:r,props:u,stylesCtx:f}),sg({options:e,classes:i,selector:r,unstyled:a}),ec({selector:r,stylesCtx:f,theme:n,classNames:o,props:u}),ec({selector:r,stylesCtx:f,theme:n,classNames:m,props:u}),Zm({selector:r,stylesCtx:f,options:e,props:u,theme:n}),eg({rootSelector:c,selector:r,className:l}),tg({selector:r,classes:i,unstyled:a||p}),h&&!p&&ng({themeName:t,classNamesPrefix:s,selector:r,withStaticClass:e==null?void 0:e.withStaticClass}),e==null?void 0:e.className)}function ig({theme:n,themeName:e,props:t,stylesCtx:r,selector:s}){return e.map(o=>{var i;return Js({theme:n,styles:(i=n.components[o])==null?void 0:i.styles,props:t,stylesCtx:r})[s]}).reduce((o,i)=>({...o,...i}),{})}function Vi({style:n,theme:e}){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Vi({style:r,theme:e})}),{}):typeof n=="function"?n(e):n??{}}function ag(n){return n.reduce((e,t)=>(t&&Object.keys(t).forEach(r=>{e[r]={...e[r],...ps(t[r])}}),e),{})}function lg({vars:n,varsResolver:e,theme:t,props:r,stylesCtx:s,selector:o,themeName:i,headless:a}){var l;return(l=ag([a?{}:e==null?void 0:e(t,r,s),...i.map(c=>{var u,f,h;return(h=(f=(u=t.components)==null?void 0:u[c])==null?void 0:f.vars)==null?void 0:h.call(f,t,r,s)}),n==null?void 0:n(t,r,s)]))==null?void 0:l[o]}function cg({theme:n,themeName:e,selector:t,options:r,props:s,stylesCtx:o,rootSelector:i,styles:a,style:l,vars:c,varsResolver:u,headless:f,withStylesTransform:h}){return{...!h&&ig({theme:n,themeName:e,props:s,stylesCtx:o,selector:t}),...!h&&Js({theme:n,styles:a,props:s,stylesCtx:o})[t],...!h&&Js({theme:n,styles:r==null?void 0:r.styles,props:(r==null?void 0:r.props)||s,stylesCtx:o})[t],...lg({theme:n,props:s,stylesCtx:o,vars:c,varsResolver:u,selector:t,themeName:e,headless:f}),...i===t?Vi({style:l,theme:n}):null,...Vi({style:r==null?void 0:r.style,theme:n})}}function ug({props:n,stylesCtx:e,themeName:t}){var i;const r=Xt(),s=(i=Np())==null?void 0:i();return{getTransformedStyles:a=>s?[...a.map(c=>s(c,{props:n,theme:r,ctx:e})),...t.map(c=>{var u;return s((u=r.components[c])==null?void 0:u.styles,{props:n,theme:r,ctx:e})})].filter(Boolean):[],withStylesTransform:!!s}}function Pe({name:n,classes:e,props:t,stylesCtx:r,className:s,style:o,rootSelector:i="root",unstyled:a,classNames:l,styles:c,vars:u,varsResolver:f}){const h=Xt(),p=Ip(),m=Pp(),g=Ap(),y=(Array.isArray(n)?n:[n]).filter(w=>w),{withStylesTransform:b,getTransformedStyles:v}=ug({props:t,stylesCtx:r,themeName:y});return(w,C)=>({className:og({theme:h,options:C,themeName:y,selector:w,classNamesPrefix:p,classNames:l,classes:e,unstyled:a,className:s,rootSelector:i,props:t,stylesCtx:r,withStaticClasses:m,headless:g,transformedStyles:v([C==null?void 0:C.styles,c])}),style:cg({theme:h,themeName:y,selector:w,options:C,props:t,stylesCtx:r,rootSelector:i,styles:c,style:o,vars:u,varsResolver:f,headless:g,withStylesTransform:b})})}function ie(n,e,t){var i;const r=Xt(),s=(i=r.components[n])==null?void 0:i.defaultProps,o=typeof s=="function"?s(r):s;return{...e,...o,...ps(t)}}function Xo(n){return $n(n).reduce((e,t)=>n[t]!==void 0?`${e}${km(t)}:${n[t]};`:e,"").trim()}function dg({selector:n,styles:e,media:t,container:r}){const s=e?Xo(e):"",o=Array.isArray(t)?t.map(a=>`@media${a.query}{${n}{${Xo(a.styles)}}}`):[],i=Array.isArray(r)?r.map(a=>`@container ${a.query}{${n}{${Xo(a.styles)}}}`):[];return`${s?`${n}{${s}}`:""}${o.join("")}${i.join("")}`.trim()}function Ra(n){const e=Rp();return d.jsx("style",{"data-mantine-styles":"inline",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:dg(n)}})}function ja(n){const{m:e,mx:t,my:r,mt:s,mb:o,ml:i,mr:a,me:l,ms:c,p:u,px:f,py:h,pt:p,pb:m,pl:g,pr:y,pe:b,ps:v,bd:w,bg:C,c:M,opacity:k,ff:T,fz:E,fw:I,lts:F,ta:V,lh:W,fs:_,tt:D,td:A,w:R,miw:P,maw:B,h:Y,mih:$,mah:O,bgsz:ae,bgp:ve,bgr:De,bga:J,pos:ee,top:oe,left:fe,bottom:re,right:pe,inset:mt,display:St,flex:He,hiddenFrom:je,visibleFrom:tn,lightHidden:zr,darkHidden:or,sx:ir,...ar}=n;return{styleProps:ps({m:e,mx:t,my:r,mt:s,mb:o,ml:i,mr:a,me:l,ms:c,p:u,px:f,py:h,pt:p,pb:m,pl:g,pr:y,pe:b,ps:v,bd:w,bg:C,c:M,opacity:k,ff:T,fz:E,fw:I,lts:F,ta:V,lh:W,fs:_,tt:D,td:A,w:R,miw:P,maw:B,h:Y,mih:$,mah:O,bgsz:ae,bgp:ve,bgr:De,bga:J,pos:ee,top:oe,left:fe,bottom:re,right:pe,inset:mt,display:St,flex:He,hiddenFrom:je,visibleFrom:tn,lightHidden:zr,darkHidden:or,sx:ir}),rest:ar}}const fg={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"identity",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function La(n,e){const t=td({color:n,theme:e});return t.color==="dimmed"?"var(--mantine-color-dimmed)":t.color==="bright"?"var(--mantine-color-bright)":t.variable?`var(${t.variable})`:t.color}function hg(n,e){const t=td({color:n,theme:e});return t.isThemeColor&&t.shade===void 0?`var(--mantine-color-${t.color}-text)`:La(n,e)}function pg(n,e){if(typeof n=="number")return te(n);if(typeof n=="string"){const[t,r,...s]=n.split(" ").filter(i=>i.trim()!=="");let o=`${te(t)}`;return r&&(o+=` ${r}`),s.length>0&&(o+=` ${La(s.join(" "),e)}`),o.trim()}return n}const tc={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function mg(n){return typeof n=="string"&&n in tc?tc[n]:n}const gg=["h1","h2","h3","h4","h5","h6"];function yg(n,e){return typeof n=="string"&&n in e.fontSizes?`var(--mantine-font-size-${n})`:typeof n=="string"&&gg.includes(n)?`var(--mantine-${n}-font-size)`:typeof n=="number"?te(n):typeof n=="string"?te(n):n}function xg(n){return n}const bg=["h1","h2","h3","h4","h5","h6"];function vg(n,e){return typeof n=="string"&&n in e.lineHeights?`var(--mantine-line-height-${n})`:typeof n=="string"&&bg.includes(n)?`var(--mantine-${n}-line-height)`:n}function wg(n){return typeof n=="number"?te(n):n}function kg(n,e){if(typeof n=="number")return te(n);if(typeof n=="string"){const t=n.replace("-","");if(!(t in e.spacing))return te(n);const r=`--mantine-spacing-${t}`;return n.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return n}const Zo={color:La,textColor:hg,fontSize:yg,spacing:kg,identity:xg,size:wg,lineHeight:vg,fontFamily:mg,border:pg};function nc(n){return n.replace("(min-width: ","").replace("em)","")}function Cg({media:n,...e}){const r=Object.keys(n).sort((s,o)=>Number(nc(s))-Number(nc(o))).map(s=>({query:s,styles:n[s]}));return{...e,media:r}}function Sg(n){if(typeof n!="object"||n===null)return!1;const e=Object.keys(n);return!(e.length===1&&e[0]==="base")}function Mg(n){return typeof n=="object"&&n!==null?"base"in n?n.base:void 0:n}function Tg(n){return typeof n=="object"&&n!==null?$n(n).filter(e=>e!=="base"):[]}function Dg(n,e){return typeof n=="object"&&n!==null&&e in n?n[e]:n}function Eg({styleProps:n,data:e,theme:t}){return Cg($n(n).reduce((r,s)=>{if(s==="hiddenFrom"||s==="visibleFrom"||s==="sx")return r;const o=e[s],i=Array.isArray(o.property)?o.property:[o.property],a=Mg(n[s]);if(!Sg(n[s]))return i.forEach(c=>{r.inlineStyles[c]=Zo[o.type](a,t)}),r;r.hasResponsiveStyles=!0;const l=Tg(n[s]);return i.forEach(c=>{a&&(r.styles[c]=Zo[o.type](a,t)),l.forEach(u=>{const f=`(min-width: ${t.breakpoints[u]})`;r.media[f]={...r.media[f],[c]:Zo[o.type](Dg(n[s],u),t)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function Nd(){return`__m__-${x.useId().replace(/:/g,"")}`}function Id(n,e){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Id(r,e)}),{}):typeof n=="function"?n(e):n??{}}function Pd(n){return n.startsWith("data-")?n:`data-${n}`}function Og(n){return Object.keys(n).reduce((e,t)=>{const r=n[t];return r===void 0||r===""||r===!1||r===null||(e[Pd(t)]=n[t]),e},{})}function Ad(n){return n?typeof n=="string"?{[Pd(n)]:!0}:Array.isArray(n)?[...n].reduce((e,t)=>({...e,...Ad(t)}),{}):Og(n):null}function Wi(n,e){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Wi(r,e)}),{}):typeof n=="function"?n(e):n??{}}function Ng({theme:n,style:e,vars:t,styleProps:r}){const s=Wi(e,n),o=Wi(t,n);return{...s,...o,...r}}const Rd=x.forwardRef(({component:n,style:e,__vars:t,className:r,variant:s,mod:o,size:i,hiddenFrom:a,visibleFrom:l,lightHidden:c,darkHidden:u,renderRoot:f,__size:h,...p},m)=>{var E;const g=Xt(),y=n||"div",{styleProps:b,rest:v}=ja(p),w=jp(),C=(E=w==null?void 0:w())==null?void 0:E(b.sx),M=Nd(),k=Eg({styleProps:b,theme:g,data:fg}),T={ref:m,style:Ng({theme:g,style:e,vars:t,styleProps:k.inlineStyles}),className:Zt(r,C,{[M]:k.hasResponsiveStyles,"mantine-light-hidden":c,"mantine-dark-hidden":u,[`mantine-hidden-from-${a}`]:a,[`mantine-visible-from-${l}`]:l}),"data-variant":s,"data-size":yd(i)?void 0:i||void 0,size:h,...Ad(o),...v};return d.jsxs(d.Fragment,{children:[k.hasResponsiveStyles&&d.jsx(Ra,{selector:`.${M}`,styles:k.styles,media:k.media}),typeof f=="function"?f(T):d.jsx(y,{...T})]})});Rd.displayName="@mantine/core/Box";const ue=Rd;function jd(n){return n}function Ne(n){const e=x.forwardRef(n);return e.extend=jd,e.withProps=t=>{const r=x.forwardRef((s,o)=>d.jsx(e,{...t,...s,ref:o}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e}function Rr(n){const e=x.forwardRef(n);return e.withProps=t=>{const r=x.forwardRef((s,o)=>d.jsx(e,{...t,...s,ref:o}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e.extend=jd,e}const Ig=x.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function Fa(){return x.useContext(Ig)}var Ld={root:"m_87cf2631"};const Pg={__staticSelector:"UnstyledButton"},jr=Rr((n,e)=>{const t=ie("UnstyledButton",Pg,n),{className:r,component:s="button",__staticSelector:o,unstyled:i,classNames:a,styles:l,style:c,...u}=t,f=Pe({name:o,props:t,classes:Ld,className:r,style:c,classNames:a,styles:l,unstyled:i});return d.jsx(ue,{...f("root",{focusable:!0}),component:s,ref:e,type:s==="button"?"button":void 0,...u})});jr.classes=Ld;jr.displayName="@mantine/core/UnstyledButton";var Fd={root:"m_515a97f8"};const Ag={},$a=Ne((n,e)=>{const t=ie("VisuallyHidden",Ag,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,...c}=t,u=Pe({name:"VisuallyHidden",classes:Fd,props:t,className:s,style:o,classNames:r,styles:i,unstyled:a});return d.jsx(ue,{component:"span",ref:e,...u("root"),...c})});$a.classes=Fd;$a.displayName="@mantine/core/VisuallyHidden";function Lr(n){return $d(n)?(n.nodeName||"").toLowerCase():"#document"}function it(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function en(n){var e;return(e=($d(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function $d(n){return n instanceof Node||n instanceof it(n).Node}function Ie(n){return n instanceof Element||n instanceof it(n).Element}function ht(n){return n instanceof HTMLElement||n instanceof it(n).HTMLElement}function Ui(n){return typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof it(n).ShadowRoot}function ms(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=wt(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(s)}function Rg(n){return["table","td","th"].includes(Lr(n))}function Co(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function Ba(n){const e=_a(),t=Ie(n)?wt(n):n;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function jg(n){let e=Gt(n);for(;ht(e)&&!vn(e);){if(Ba(e))return e;if(Co(e))return null;e=Gt(e)}return null}function _a(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function vn(n){return["html","body","#document"].includes(Lr(n))}function wt(n){return it(n).getComputedStyle(n)}function So(n){return Ie(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function Gt(n){if(Lr(n)==="html")return n;const e=n.assignedSlot||n.parentNode||Ui(n)&&n.host||en(n);return Ui(e)?e.host:e}function Bd(n){const e=Gt(n);return vn(e)?n.ownerDocument?n.ownerDocument.body:n.body:ht(e)&&ms(e)?e:Bd(e)}function Yt(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=Bd(n),o=s===((r=n.ownerDocument)==null?void 0:r.body),i=it(s);return o?e.concat(i,i.visualViewport||[],ms(s)?s:[],i.frameElement&&t?Yt(i.frameElement):[]):e.concat(s,Yt(s,[],t))}function rc(n){let e=n.activeElement;for(;((t=e)==null||(t=t.shadowRoot)==null?void 0:t.activeElement)!=null;){var t;e=e.shadowRoot.activeElement}return e}function rs(n,e){if(!n||!e)return!1;const t=e.getRootNode==null?void 0:e.getRootNode();if(n.contains(e))return!0;if(t&&Ui(t)){let r=e;for(;r;){if(n===r)return!0;r=r.parentNode||r.host}}return!1}function _d(){const n=navigator.userAgentData;return n!=null&&n.platform?n.platform:navigator.platform}function zd(){const n=navigator.userAgentData;return n&&Array.isArray(n.brands)?n.brands.map(e=>{let{brand:t,version:r}=e;return t+"/"+r}).join(" "):navigator.userAgent}function Lg(n){return Bg()?!1:!sc()&&n.width===0&&n.height===0||sc()&&n.width===1&&n.height===1&&n.pressure===0&&n.detail===0&&n.pointerType==="mouse"||n.width<1&&n.height<1&&n.pressure===0&&n.detail===0&&n.pointerType==="touch"}function Fg(){return/apple/i.test(navigator.vendor)}function sc(){const n=/android/i;return n.test(_d())||n.test(zd())}function $g(){return _d().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function Bg(){return zd().includes("jsdom/")}function qi(n,e){const t=["mouse","pen"];return e||t.push("",void 0),t.includes(n)}function _g(n){return"nativeEvent"in n}function zg(n){return n.matches("html,body")}function Rn(n){return(n==null?void 0:n.ownerDocument)||document}function ei(n,e){if(e==null)return!1;if("composedPath"in n)return n.composedPath().includes(e);const t=n;return t.target!=null&&e.contains(t.target)}function hr(n){return"composedPath"in n?n.composedPath()[0]:n.target}const Hg="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function Vg(n){return ht(n)&&n.matches(Hg)}const ft=Math.min,Ze=Math.max,Qs=Math.round,Cs=Math.floor,wn=n=>({x:n,y:n}),Wg={left:"right",right:"left",bottom:"top",top:"bottom"},Ug={start:"end",end:"start"};function Yi(n,e,t){return Ze(n,ft(e,t))}function Jt(n,e){return typeof n=="function"?n(e):n}function Nt(n){return n.split("-")[0]}function Fr(n){return n.split("-")[1]}function za(n){return n==="x"?"y":"x"}function Ha(n){return n==="y"?"height":"width"}function Qt(n){return["top","bottom"].includes(Nt(n))?"y":"x"}function Va(n){return za(Qt(n))}function qg(n,e,t){t===void 0&&(t=!1);const r=Fr(n),s=Va(n),o=Ha(s);let i=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(i=Xs(i)),[i,Xs(i)]}function Yg(n){const e=Xs(n);return[Ki(n),e,Ki(e)]}function Ki(n){return n.replace(/start|end/g,e=>Ug[e])}function Kg(n,e,t){const r=["left","right"],s=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(n){case"top":case"bottom":return t?e?s:r:e?r:s;case"left":case"right":return e?o:i;default:return[]}}function Gg(n,e,t,r){const s=Fr(n);let o=Kg(Nt(n),t==="start",r);return s&&(o=o.map(i=>i+"-"+s),e&&(o=o.concat(o.map(Ki)))),o}function Xs(n){return n.replace(/left|right|bottom|top/g,e=>Wg[e])}function Jg(n){return{top:0,right:0,bottom:0,left:0,...n}}function Wa(n){return typeof n!="number"?Jg(n):{top:n,right:n,bottom:n,left:n}}function Mr(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function oc(n,e,t){let{reference:r,floating:s}=n;const o=Qt(e),i=Va(e),a=Ha(i),l=Nt(e),c=o==="y",u=r.x+r.width/2-s.width/2,f=r.y+r.height/2-s.height/2,h=r[a]/2-s[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:f};break;case"left":p={x:r.x-s.width,y:f};break;default:p={x:r.x,y:r.y}}switch(Fr(e)){case"start":p[i]-=h*(t&&c?-1:1);break;case"end":p[i]+=h*(t&&c?-1:1);break}return p}const Qg=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:o=[],platform:i}=t,a=o.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(e));let c=await i.getElementRects({reference:n,floating:e,strategy:s}),{x:u,y:f}=oc(c,r,l),h=r,p={},m=0;for(let g=0;g<a.length;g++){const{name:y,fn:b}=a[g],{x:v,y:w,data:C,reset:M}=await b({x:u,y:f,initialPlacement:r,placement:h,strategy:s,middlewareData:p,rects:c,platform:i,elements:{reference:n,floating:e}});u=v??u,f=w??f,p={...p,[y]:{...p[y],...C}},M&&m<=50&&(m++,typeof M=="object"&&(M.placement&&(h=M.placement),M.rects&&(c=M.rects===!0?await i.getElementRects({reference:n,floating:e,strategy:s}):M.rects),{x:u,y:f}=oc(c,h,l)),g=-1)}return{x:u,y:f,placement:h,strategy:s,middlewareData:p}};async function Ua(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:o,rects:i,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:p=0}=Jt(e,n),m=Wa(p),y=a[h?f==="floating"?"reference":"floating":f],b=Mr(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(y)))==null||t?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),v=f==="floating"?{x:r,y:s,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),C=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},M=Mr(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:w,strategy:l}):v);return{top:(b.top-M.top+m.top)/C.y,bottom:(M.bottom-b.bottom+m.bottom)/C.y,left:(b.left-M.left+m.left)/C.x,right:(M.right-b.right+m.right)/C.x}}const Xg=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:o,platform:i,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Jt(n,e)||{};if(c==null)return{};const f=Wa(u),h={x:t,y:r},p=Va(s),m=Ha(p),g=await i.getDimensions(c),y=p==="y",b=y?"top":"left",v=y?"bottom":"right",w=y?"clientHeight":"clientWidth",C=o.reference[m]+o.reference[p]-h[p]-o.floating[m],M=h[p]-o.reference[p],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let T=k?k[w]:0;(!T||!await(i.isElement==null?void 0:i.isElement(k)))&&(T=a.floating[w]||o.floating[m]);const E=C/2-M/2,I=T/2-g[m]/2-1,F=ft(f[b],I),V=ft(f[v],I),W=F,_=T-g[m]-V,D=T/2-g[m]/2+E,A=Yi(W,D,_),R=!l.arrow&&Fr(s)!=null&&D!==A&&o.reference[m]/2-(D<W?F:V)-g[m]/2<0,P=R?D<W?D-W:D-_:0;return{[p]:h[p]+P,data:{[p]:A,centerOffset:D-A-P,...R&&{alignmentOffset:P}},reset:R}}}),Zg=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:o,rects:i,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...y}=Jt(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const b=Nt(s),v=Qt(a),w=Nt(a)===a,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),M=h||(w||!g?[Xs(a)]:Yg(a)),k=m!=="none";!h&&k&&M.push(...Gg(a,g,m,C));const T=[a,...M],E=await Ua(e,y),I=[];let F=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&I.push(E[b]),f){const D=qg(s,i,C);I.push(E[D[0]],E[D[1]])}if(F=[...F,{placement:s,overflows:I}],!I.every(D=>D<=0)){var V,W;const D=(((V=o.flip)==null?void 0:V.index)||0)+1,A=T[D];if(A)return{data:{index:D,overflows:F},reset:{placement:A}};let R=(W=F.filter(P=>P.overflows[0]<=0).sort((P,B)=>P.overflows[1]-B.overflows[1])[0])==null?void 0:W.placement;if(!R)switch(p){case"bestFit":{var _;const P=(_=F.filter(B=>{if(k){const Y=Qt(B.placement);return Y===v||Y==="y"}return!0}).map(B=>[B.placement,B.overflows.filter(Y=>Y>0).reduce((Y,$)=>Y+$,0)]).sort((B,Y)=>B[1]-Y[1])[0])==null?void 0:_[0];P&&(R=P);break}case"initialPlacement":R=a;break}if(s!==R)return{reset:{placement:R}}}return{}}}};function Hd(n){const e=ft(...n.map(o=>o.left)),t=ft(...n.map(o=>o.top)),r=Ze(...n.map(o=>o.right)),s=Ze(...n.map(o=>o.bottom));return{x:e,y:t,width:r-e,height:s-t}}function ey(n){const e=n.slice().sort((s,o)=>s.y-o.y),t=[];let r=null;for(let s=0;s<e.length;s++){const o=e[s];!r||o.y-r.y>r.height/2?t.push([o]):t[t.length-1].push(o),r=o}return t.map(s=>Mr(Hd(s)))}const ty=function(n){return n===void 0&&(n={}),{name:"inline",options:n,async fn(e){const{placement:t,elements:r,rects:s,platform:o,strategy:i}=e,{padding:a=2,x:l,y:c}=Jt(n,e),u=Array.from(await(o.getClientRects==null?void 0:o.getClientRects(r.reference))||[]),f=ey(u),h=Mr(Hd(u)),p=Wa(a);function m(){if(f.length===2&&f[0].left>f[1].right&&l!=null&&c!=null)return f.find(y=>l>y.left-p.left&&l<y.right+p.right&&c>y.top-p.top&&c<y.bottom+p.bottom)||h;if(f.length>=2){if(Qt(t)==="y"){const F=f[0],V=f[f.length-1],W=Nt(t)==="top",_=F.top,D=V.bottom,A=W?F.left:V.left,R=W?F.right:V.right,P=R-A,B=D-_;return{top:_,bottom:D,left:A,right:R,width:P,height:B,x:A,y:_}}const y=Nt(t)==="left",b=Ze(...f.map(F=>F.right)),v=ft(...f.map(F=>F.left)),w=f.filter(F=>y?F.left===v:F.right===b),C=w[0].top,M=w[w.length-1].bottom,k=v,T=b,E=T-k,I=M-C;return{top:C,bottom:M,left:k,right:T,width:E,height:I,x:k,y:C}}return h}const g=await o.getElementRects({reference:{getBoundingClientRect:m},floating:r.floating,strategy:i});return s.reference.x!==g.reference.x||s.reference.y!==g.reference.y||s.reference.width!==g.reference.width||s.reference.height!==g.reference.height?{reset:{rects:g}}:{}}}};async function ny(n,e){const{placement:t,platform:r,elements:s}=n,o=await(r.isRTL==null?void 0:r.isRTL(s.floating)),i=Nt(t),a=Fr(t),l=Qt(t)==="y",c=["left","top"].includes(i)?-1:1,u=o&&l?-1:1,f=Jt(e,n);let{mainAxis:h,crossAxis:p,alignmentAxis:m}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const ry=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:o,placement:i,middlewareData:a}=e,l=await ny(e,n);return i===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:o+l.y,data:{...l,placement:i}}}}},sy=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:o=!0,crossAxis:i=!1,limiter:a={fn:y=>{let{x:b,y:v}=y;return{x:b,y:v}}},...l}=Jt(n,e),c={x:t,y:r},u=await Ua(e,l),f=Qt(Nt(s)),h=za(f);let p=c[h],m=c[f];if(o){const y=h==="y"?"top":"left",b=h==="y"?"bottom":"right",v=p+u[y],w=p-u[b];p=Yi(v,p,w)}if(i){const y=f==="y"?"top":"left",b=f==="y"?"bottom":"right",v=m+u[y],w=m-u[b];m=Yi(v,m,w)}const g=a.fn({...e,[h]:p,[f]:m});return{...g,data:{x:g.x-t,y:g.y-r}}}}},oy=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:o,middlewareData:i}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Jt(n,e),u={x:t,y:r},f=Qt(s),h=za(f);let p=u[h],m=u[f];const g=Jt(a,e),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=h==="y"?"height":"width",C=o.reference[h]-o.floating[w]+y.mainAxis,M=o.reference[h]+o.reference[w]-y.mainAxis;p<C?p=C:p>M&&(p=M)}if(c){var b,v;const w=h==="y"?"width":"height",C=["top","left"].includes(Nt(s)),M=o.reference[f]-o.floating[w]+(C&&((b=i.offset)==null?void 0:b[f])||0)+(C?0:y.crossAxis),k=o.reference[f]+o.reference[w]+(C?0:((v=i.offset)==null?void 0:v[f])||0)-(C?y.crossAxis:0);m<M?m=M:m>k&&(m=k)}return{[h]:p,[f]:m}}}},iy=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){const{placement:t,rects:r,platform:s,elements:o}=e,{apply:i=()=>{},...a}=Jt(n,e),l=await Ua(e,a),c=Nt(t),u=Fr(t),f=Qt(t)==="y",{width:h,height:p}=r.floating;let m,g;c==="top"||c==="bottom"?(m=c,g=u===(await(s.isRTL==null?void 0:s.isRTL(o.floating))?"start":"end")?"left":"right"):(g=c,m=u==="end"?"top":"bottom");const y=p-l.top-l.bottom,b=h-l.left-l.right,v=ft(p-l[m],y),w=ft(h-l[g],b),C=!e.middlewareData.shift;let M=v,k=w;if(f?k=u||C?ft(w,b):b:M=u||C?ft(v,y):y,C&&!u){const E=Ze(l.left,0),I=Ze(l.right,0),F=Ze(l.top,0),V=Ze(l.bottom,0);f?k=h-2*(E!==0||I!==0?E+I:Ze(l.left,l.right)):M=p-2*(F!==0||V!==0?F+V:Ze(l.top,l.bottom))}await i({...e,availableWidth:k,availableHeight:M});const T=await s.getDimensions(o.floating);return h!==T.width||p!==T.height?{reset:{rects:!0}}:{}}}};function Vd(n){const e=wt(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=ht(n),o=s?n.offsetWidth:t,i=s?n.offsetHeight:r,a=Qs(t)!==o||Qs(r)!==i;return a&&(t=o,r=i),{width:t,height:r,$:a}}function qa(n){return Ie(n)?n:n.contextElement}function br(n){const e=qa(n);if(!ht(e))return wn(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:o}=Vd(e);let i=(o?Qs(t.width):t.width)/r,a=(o?Qs(t.height):t.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!a||!Number.isFinite(a))&&(a=1),{x:i,y:a}}const ay=wn(0);function Wd(n){const e=it(n);return!_a()||!e.visualViewport?ay:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ly(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==it(n)?!1:e}function qn(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),o=qa(n);let i=wn(1);e&&(r?Ie(r)&&(i=br(r)):i=br(n));const a=ly(o,t,r)?Wd(o):wn(0);let l=(s.left+a.x)/i.x,c=(s.top+a.y)/i.y,u=s.width/i.x,f=s.height/i.y;if(o){const h=it(o),p=r&&Ie(r)?it(r):r;let m=h,g=m.frameElement;for(;g&&r&&p!==m;){const y=br(g),b=g.getBoundingClientRect(),v=wt(g),w=b.left+(g.clientLeft+parseFloat(v.paddingLeft))*y.x,C=b.top+(g.clientTop+parseFloat(v.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,f*=y.y,l+=w,c+=C,m=it(g),g=m.frameElement}}return Mr({width:u,height:f,x:l,y:c})}function cy(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const o=s==="fixed",i=en(r),a=e?Co(e.floating):!1;if(r===i||a&&o)return t;let l={scrollLeft:0,scrollTop:0},c=wn(1);const u=wn(0),f=ht(r);if((f||!f&&!o)&&((Lr(r)!=="body"||ms(i))&&(l=So(r)),ht(r))){const h=qn(r);c=br(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x,y:t.y*c.y-l.scrollTop*c.y+u.y}}function uy(n){return Array.from(n.getClientRects())}function Ud(n){return qn(en(n)).left+So(n).scrollLeft}function dy(n){const e=en(n),t=So(n),r=n.ownerDocument.body,s=Ze(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Ze(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let i=-t.scrollLeft+Ud(n);const a=-t.scrollTop;return wt(r).direction==="rtl"&&(i+=Ze(e.clientWidth,r.clientWidth)-s),{width:s,height:o,x:i,y:a}}function fy(n,e){const t=it(n),r=en(n),s=t.visualViewport;let o=r.clientWidth,i=r.clientHeight,a=0,l=0;if(s){o=s.width,i=s.height;const c=_a();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:o,height:i,x:a,y:l}}function hy(n,e){const t=qn(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,o=ht(n)?br(n):wn(1),i=n.clientWidth*o.x,a=n.clientHeight*o.y,l=s*o.x,c=r*o.y;return{width:i,height:a,x:l,y:c}}function ic(n,e,t){let r;if(e==="viewport")r=fy(n,t);else if(e==="document")r=dy(en(n));else if(Ie(e))r=hy(e,t);else{const s=Wd(n);r={...e,x:e.x-s.x,y:e.y-s.y}}return Mr(r)}function qd(n,e){const t=Gt(n);return t===e||!Ie(t)||vn(t)?!1:wt(t).position==="fixed"||qd(t,e)}function py(n,e){const t=e.get(n);if(t)return t;let r=Yt(n,[],!1).filter(a=>Ie(a)&&Lr(a)!=="body"),s=null;const o=wt(n).position==="fixed";let i=o?Gt(n):n;for(;Ie(i)&&!vn(i);){const a=wt(i),l=Ba(i);!l&&a.position==="fixed"&&(s=null),(o?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||ms(i)&&!l&&qd(n,i))?r=r.filter(u=>u!==i):s=a,i=Gt(i)}return e.set(n,r),r}function my(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const i=[...t==="clippingAncestors"?Co(e)?[]:py(e,this._c):[].concat(t),r],a=i[0],l=i.reduce((c,u)=>{const f=ic(e,u,s);return c.top=Ze(f.top,c.top),c.right=ft(f.right,c.right),c.bottom=ft(f.bottom,c.bottom),c.left=Ze(f.left,c.left),c},ic(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function gy(n){const{width:e,height:t}=Vd(n);return{width:e,height:t}}function yy(n,e,t){const r=ht(e),s=en(e),o=t==="fixed",i=qn(n,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=wn(0);if(r||!r&&!o)if((Lr(e)!=="body"||ms(s))&&(a=So(e)),r){const f=qn(e,!0,o,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else s&&(l.x=Ud(s));const c=i.left+a.scrollLeft-l.x,u=i.top+a.scrollTop-l.y;return{x:c,y:u,width:i.width,height:i.height}}function ti(n){return wt(n).position==="static"}function ac(n,e){return!ht(n)||wt(n).position==="fixed"?null:e?e(n):n.offsetParent}function Yd(n,e){const t=it(n);if(Co(n))return t;if(!ht(n)){let s=Gt(n);for(;s&&!vn(s);){if(Ie(s)&&!ti(s))return s;s=Gt(s)}return t}let r=ac(n,e);for(;r&&Rg(r)&&ti(r);)r=ac(r,e);return r&&vn(r)&&ti(r)&&!Ba(r)?t:r||jg(n)||t}const xy=async function(n){const e=this.getOffsetParent||Yd,t=this.getDimensions,r=await t(n.floating);return{reference:yy(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function by(n){return wt(n).direction==="rtl"}const vy={convertOffsetParentRelativeRectToViewportRelativeRect:cy,getDocumentElement:en,getClippingRect:my,getOffsetParent:Yd,getElementRects:xy,getClientRects:uy,getDimensions:gy,getScale:br,isElement:Ie,isRTL:by};function wy(n,e){let t=null,r;const s=en(n);function o(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function i(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const{left:c,top:u,width:f,height:h}=n.getBoundingClientRect();if(a||e(),!f||!h)return;const p=Cs(u),m=Cs(s.clientWidth-(c+f)),g=Cs(s.clientHeight-(u+h)),y=Cs(c),v={rootMargin:-p+"px "+-m+"px "+-g+"px "+-y+"px",threshold:Ze(0,ft(1,l))||1};let w=!0;function C(M){const k=M[0].intersectionRatio;if(k!==l){if(!w)return i();k?i(!1,k):r=setTimeout(()=>{i(!1,1e-7)},1e3)}w=!1}try{t=new IntersectionObserver(C,{...v,root:s.ownerDocument})}catch{t=new IntersectionObserver(C,v)}t.observe(n)}return i(!0),o}function ky(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=qa(n),u=s||o?[...c?Yt(c):[],...Yt(e)]:[];u.forEach(b=>{s&&b.addEventListener("scroll",t,{passive:!0}),o&&b.addEventListener("resize",t)});const f=c&&a?wy(c,t):null;let h=-1,p=null;i&&(p=new ResizeObserver(b=>{let[v]=b;v&&v.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),t()}),c&&!l&&p.observe(c),p.observe(e));let m,g=l?qn(n):null;l&&y();function y(){const b=qn(n);g&&(b.x!==g.x||b.y!==g.y||b.width!==g.width||b.height!==g.height)&&t(),g=b,m=requestAnimationFrame(y)}return t(),()=>{var b;u.forEach(v=>{s&&v.removeEventListener("scroll",t),o&&v.removeEventListener("resize",t)}),f==null||f(),(b=p)==null||b.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const Cy=ry,Sy=sy,My=Zg,Ty=iy,lc=Xg,Dy=ty,Ey=oy,Oy=(n,e,t)=>{const r=new Map,s={platform:vy,...t},o={...s.platform,_c:r};return Qg(n,e,{...s,platform:o})};var Bs=typeof document<"u"?x.useLayoutEffect:x.useEffect;function Zs(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!Zs(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const o=s[r];if(!(o==="_owner"&&n.$$typeof)&&!Zs(n[o],e[o]))return!1}return!0}return n!==n&&e!==e}function Kd(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function cc(n,e){const t=Kd(n);return Math.round(e*t)/t}function uc(n){const e=x.useRef(n);return Bs(()=>{e.current=n}),e}function Ny(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:o,floating:i}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,f]=x.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[h,p]=x.useState(r);Zs(h,r)||p(r);const[m,g]=x.useState(null),[y,b]=x.useState(null),v=x.useCallback(P=>{P!==k.current&&(k.current=P,g(P))},[]),w=x.useCallback(P=>{P!==T.current&&(T.current=P,b(P))},[]),C=o||m,M=i||y,k=x.useRef(null),T=x.useRef(null),E=x.useRef(u),I=l!=null,F=uc(l),V=uc(s),W=x.useCallback(()=>{if(!k.current||!T.current)return;const P={placement:e,strategy:t,middleware:h};V.current&&(P.platform=V.current),Oy(k.current,T.current,P).then(B=>{const Y={...B,isPositioned:!0};_.current&&!Zs(E.current,Y)&&(E.current=Y,Ta.flushSync(()=>{f(Y)}))})},[h,e,t,V]);Bs(()=>{c===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f(P=>({...P,isPositioned:!1})))},[c]);const _=x.useRef(!1);Bs(()=>(_.current=!0,()=>{_.current=!1}),[]),Bs(()=>{if(C&&(k.current=C),M&&(T.current=M),C&&M){if(F.current)return F.current(C,M,W);W()}},[C,M,W,F,I]);const D=x.useMemo(()=>({reference:k,floating:T,setReference:v,setFloating:w}),[v,w]),A=x.useMemo(()=>({reference:C,floating:M}),[C,M]),R=x.useMemo(()=>{const P={position:t,left:0,top:0};if(!A.floating)return P;const B=cc(A.floating,u.x),Y=cc(A.floating,u.y);return a?{...P,transform:"translate("+B+"px, "+Y+"px)",...Kd(A.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:B,top:Y}},[t,a,A.floating,u.x,u.y]);return x.useMemo(()=>({...u,update:W,refs:D,elements:A,floatingStyles:R}),[u,W,D,A,R])}const Iy=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?lc({element:r.current,padding:s}).fn(t):{}:r?lc({element:r,padding:s}).fn(t):{}}}},Gd=(n,e)=>({...Cy(n),options:[n,e]}),Ya=(n,e)=>({...Sy(n),options:[n,e]}),dc=(n,e)=>({...Ey(n),options:[n,e]}),Gi=(n,e)=>({...My(n),options:[n,e]}),Py=(n,e)=>({...Ty(n),options:[n,e]}),Ji=(n,e)=>({...Dy(n),options:[n,e]}),Jd=(n,e)=>({...Iy(n),options:[n,e]}),Qd={...Lp},Ay=Qd.useInsertionEffect,Ry=Ay||(n=>n());function un(n){const e=x.useRef(()=>{});return Ry(()=>{e.current=n}),x.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}var Bt=typeof document<"u"?x.useLayoutEffect:x.useEffect;let fc=!1,jy=0;const hc=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+jy++;function Ly(){const[n,e]=x.useState(()=>fc?hc():void 0);return Bt(()=>{n==null&&e(hc())},[]),x.useEffect(()=>{fc=!0},[]),n}const Fy=Qd.useId,Xd=Fy||Ly;function $y(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(s=>s(t))},on(e,t){n.set(e,[...n.get(e)||[],t])},off(e,t){var r;n.set(e,((r=n.get(e))==null?void 0:r.filter(s=>s!==t))||[])}}}const By=x.createContext(null),_y=x.createContext(null),Ka=()=>{var n;return((n=x.useContext(By))==null?void 0:n.id)||null},Ga=()=>x.useContext(_y);function Ja(n){return"data-floating-ui-"+n}function ni(n){const e=x.useRef(n);return Bt(()=>{e.current=n}),e}const pc=Ja("safe-polygon");function _s(n,e,t){return t&&!qi(t)?0:typeof n=="number"?n:n==null?void 0:n[e]}function zy(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,dataRef:s,events:o,elements:i}=n,{enabled:a=!0,delay:l=0,handleClose:c=null,mouseOnly:u=!1,restMs:f=0,move:h=!0}=e,p=Ga(),m=Ka(),g=ni(c),y=ni(l),b=ni(t),v=x.useRef(),w=x.useRef(-1),C=x.useRef(),M=x.useRef(-1),k=x.useRef(!0),T=x.useRef(!1),E=x.useRef(()=>{}),I=x.useCallback(()=>{var A;const R=(A=s.current.openEvent)==null?void 0:A.type;return(R==null?void 0:R.includes("mouse"))&&R!=="mousedown"},[s]);x.useEffect(()=>{if(!a)return;function A(R){let{open:P}=R;P||(clearTimeout(w.current),clearTimeout(M.current),k.current=!0)}return o.on("openchange",A),()=>{o.off("openchange",A)}},[a,o]),x.useEffect(()=>{if(!a||!g.current||!t)return;function A(P){I()&&r(!1,P,"hover")}const R=Rn(i.floating).documentElement;return R.addEventListener("mouseleave",A),()=>{R.removeEventListener("mouseleave",A)}},[i.floating,t,r,a,g,I]);const F=x.useCallback(function(A,R,P){R===void 0&&(R=!0),P===void 0&&(P="hover");const B=_s(y.current,"close",v.current);B&&!C.current?(clearTimeout(w.current),w.current=window.setTimeout(()=>r(!1,A,P),B)):R&&(clearTimeout(w.current),r(!1,A,P))},[y,r]),V=un(()=>{E.current(),C.current=void 0}),W=un(()=>{if(T.current){const A=Rn(i.floating).body;A.style.pointerEvents="",A.removeAttribute(pc),T.current=!1}});x.useEffect(()=>{if(!a)return;function A(){return s.current.openEvent?["click","mousedown"].includes(s.current.openEvent.type):!1}function R($){if(clearTimeout(w.current),k.current=!1,u&&!qi(v.current)||f>0&&!_s(y.current,"open"))return;const O=_s(y.current,"open",v.current);O?w.current=window.setTimeout(()=>{b.current||r(!0,$,"hover")},O):r(!0,$,"hover")}function P($){if(A())return;E.current();const O=Rn(i.floating);if(clearTimeout(M.current),g.current&&s.current.floatingContext){t||clearTimeout(w.current),C.current=g.current({...s.current.floatingContext,tree:p,x:$.clientX,y:$.clientY,onClose(){W(),V(),F($,!0,"safe-polygon")}});const ve=C.current;O.addEventListener("mousemove",ve),E.current=()=>{O.removeEventListener("mousemove",ve)};return}(v.current==="touch"?!rs(i.floating,$.relatedTarget):!0)&&F($)}function B($){A()||s.current.floatingContext&&(g.current==null||g.current({...s.current.floatingContext,tree:p,x:$.clientX,y:$.clientY,onClose(){W(),V(),F($)}})($))}if(Ie(i.domReference)){var Y;const $=i.domReference;return t&&$.addEventListener("mouseleave",B),(Y=i.floating)==null||Y.addEventListener("mouseleave",B),h&&$.addEventListener("mousemove",R,{once:!0}),$.addEventListener("mouseenter",R),$.addEventListener("mouseleave",P),()=>{var O;t&&$.removeEventListener("mouseleave",B),(O=i.floating)==null||O.removeEventListener("mouseleave",B),h&&$.removeEventListener("mousemove",R),$.removeEventListener("mouseenter",R),$.removeEventListener("mouseleave",P)}}},[i,a,n,u,f,h,F,V,W,r,t,b,p,y,g,s]),Bt(()=>{var A;if(a&&t&&(A=g.current)!=null&&A.__options.blockPointerEvents&&I()){const P=Rn(i.floating).body;P.setAttribute(pc,""),P.style.pointerEvents="none",T.current=!0;const B=i.floating;if(Ie(i.domReference)&&B){var R;const Y=i.domReference,$=p==null||(R=p.nodesRef.current.find(O=>O.id===m))==null||(R=R.context)==null?void 0:R.elements.floating;return $&&($.style.pointerEvents=""),Y.style.pointerEvents="auto",B.style.pointerEvents="auto",()=>{Y.style.pointerEvents="",B.style.pointerEvents=""}}}},[a,t,m,i,p,g,I]),Bt(()=>{t||(v.current=void 0,V(),W())},[t,V,W]),x.useEffect(()=>()=>{V(),clearTimeout(w.current),clearTimeout(M.current),W()},[a,i.domReference,V,W]);const _=x.useMemo(()=>{function A(R){v.current=R.pointerType}return{onPointerDown:A,onPointerEnter:A,onMouseMove(R){const{nativeEvent:P}=R;function B(){!k.current&&!b.current&&r(!0,P,"hover")}u&&!qi(v.current)||t||f===0||(clearTimeout(M.current),v.current==="touch"?B():M.current=window.setTimeout(B,f))}}},[u,r,t,b,f]),D=x.useMemo(()=>({onMouseEnter(){clearTimeout(w.current)},onMouseLeave(A){F(A.nativeEvent,!1)}}),[F]);return x.useMemo(()=>a?{reference:_,floating:D}:{},[a,_,D])}const Qi=()=>{},Zd=x.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:Qi,setState:Qi,isInstantPhase:!1}),ef=()=>x.useContext(Zd);function Hy(n){const{children:e,delay:t,timeoutMs:r=0}=n,[s,o]=x.useReducer((l,c)=>({...l,...c}),{delay:t,timeoutMs:r,initialDelay:t,currentId:null,isInstantPhase:!1}),i=x.useRef(null),a=x.useCallback(l=>{o({currentId:l})},[]);return Bt(()=>{s.currentId?i.current===null?i.current=s.currentId:s.isInstantPhase||o({isInstantPhase:!0}):(s.isInstantPhase&&o({isInstantPhase:!1}),i.current=null)},[s.currentId,s.isInstantPhase]),x.createElement(Zd.Provider,{value:x.useMemo(()=>({...s,setState:o,setCurrentId:a}),[s,a])},e)}function Vy(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,floatingId:s}=n,{id:o}=e,i=o??s,a=ef(),{currentId:l,setCurrentId:c,initialDelay:u,setState:f,timeoutMs:h}=a;return Bt(()=>{l&&(f({delay:{open:1,close:_s(u,"close")}}),l!==i&&r(!1))},[i,r,f,l,u]),Bt(()=>{function p(){r(!1),f({delay:u,currentId:null})}if(l&&!t&&l===i){if(h){const m=window.setTimeout(p,h);return()=>{clearTimeout(m)}}p()}},[t,f,l,i,r,u,h]),Bt(()=>{c===Qi||!t||c(i)},[t,c,i]),a}function ri(n,e){let t=n.filter(s=>{var o;return s.parentId===e&&((o=s.context)==null?void 0:o.open)}),r=t;for(;r.length;)r=n.filter(s=>{var o;return(o=r)==null?void 0:o.some(i=>{var a;return s.parentId===i.id&&((a=s.context)==null?void 0:a.open)})}),t=t.concat(r);return t}const Wy={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Uy={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},mc=n=>{var e,t;return{escapeKey:typeof n=="boolean"?n:(e=n==null?void 0:n.escapeKey)!=null?e:!1,outsidePress:typeof n=="boolean"?n:(t=n==null?void 0:n.outsidePress)!=null?t:!0}};function qy(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,elements:s,dataRef:o}=n,{enabled:i=!0,escapeKey:a=!0,outsidePress:l=!0,outsidePressEvent:c="pointerdown",referencePress:u=!1,referencePressEvent:f="pointerdown",ancestorScroll:h=!1,bubbles:p,capture:m}=e,g=Ga(),y=un(typeof l=="function"?l:()=>!1),b=typeof l=="function"?y:l,v=x.useRef(!1),w=x.useRef(!1),{escapeKey:C,outsidePress:M}=mc(p),{escapeKey:k,outsidePress:T}=mc(m),E=un(D=>{var A;if(!t||!i||!a||D.key!=="Escape")return;const R=(A=o.current.floatingContext)==null?void 0:A.nodeId,P=g?ri(g.nodesRef.current,R):[];if(!C&&(D.stopPropagation(),P.length>0)){let B=!0;if(P.forEach(Y=>{var $;if(($=Y.context)!=null&&$.open&&!Y.context.dataRef.current.__escapeKeyBubbles){B=!1;return}}),!B)return}r(!1,_g(D)?D.nativeEvent:D,"escape-key")}),I=un(D=>{var A;const R=()=>{var P;E(D),(P=hr(D))==null||P.removeEventListener("keydown",R)};(A=hr(D))==null||A.addEventListener("keydown",R)}),F=un(D=>{var A;const R=v.current;v.current=!1;const P=w.current;if(w.current=!1,c==="click"&&P||R||typeof b=="function"&&!b(D))return;const B=hr(D),Y="["+Ja("inert")+"]",$=Rn(s.floating).querySelectorAll(Y);let O=Ie(B)?B:null;for(;O&&!vn(O);){const J=Gt(O);if(vn(J)||!Ie(J))break;O=J}if($.length&&Ie(B)&&!zg(B)&&!rs(B,s.floating)&&Array.from($).every(J=>!rs(O,J)))return;if(ht(B)&&_){const J=B.clientWidth>0&&B.scrollWidth>B.clientWidth,ee=B.clientHeight>0&&B.scrollHeight>B.clientHeight;let oe=ee&&D.offsetX>B.clientWidth;if(ee&&wt(B).direction==="rtl"&&(oe=D.offsetX<=B.offsetWidth-B.clientWidth),oe||J&&D.offsetY>B.clientHeight)return}const ae=(A=o.current.floatingContext)==null?void 0:A.nodeId,ve=g&&ri(g.nodesRef.current,ae).some(J=>{var ee;return ei(D,(ee=J.context)==null?void 0:ee.elements.floating)});if(ei(D,s.floating)||ei(D,s.domReference)||ve)return;const De=g?ri(g.nodesRef.current,ae):[];if(De.length>0){let J=!0;if(De.forEach(ee=>{var oe;if((oe=ee.context)!=null&&oe.open&&!ee.context.dataRef.current.__outsidePressBubbles){J=!1;return}}),!J)return}r(!1,D,"outside-press")}),V=un(D=>{var A;const R=()=>{var P;F(D),(P=hr(D))==null||P.removeEventListener(c,R)};(A=hr(D))==null||A.addEventListener(c,R)});x.useEffect(()=>{if(!t||!i)return;o.current.__escapeKeyBubbles=C,o.current.__outsidePressBubbles=M;function D(P){r(!1,P,"ancestor-scroll")}const A=Rn(s.floating);a&&A.addEventListener("keydown",k?I:E,k),b&&A.addEventListener(c,T?V:F,T);let R=[];return h&&(Ie(s.domReference)&&(R=Yt(s.domReference)),Ie(s.floating)&&(R=R.concat(Yt(s.floating))),!Ie(s.reference)&&s.reference&&s.reference.contextElement&&(R=R.concat(Yt(s.reference.contextElement)))),R=R.filter(P=>{var B;return P!==((B=A.defaultView)==null?void 0:B.visualViewport)}),R.forEach(P=>{P.addEventListener("scroll",D,{passive:!0})}),()=>{a&&A.removeEventListener("keydown",k?I:E,k),b&&A.removeEventListener(c,T?V:F,T),R.forEach(P=>{P.removeEventListener("scroll",D)})}},[o,s,a,b,c,t,r,h,i,C,M,E,k,I,F,T,V]),x.useEffect(()=>{v.current=!1},[b,c]);const W=x.useMemo(()=>({onKeyDown:E,[Wy[f]]:D=>{u&&r(!1,D.nativeEvent,"reference-press")}}),[E,r,u,f]),_=x.useMemo(()=>({onKeyDown:E,onMouseDown(){w.current=!0},onMouseUp(){w.current=!0},[Uy[c]]:()=>{v.current=!0}}),[E,c]);return x.useMemo(()=>i?{reference:W,floating:_}:{},[i,W,_])}function Yy(n){const{open:e=!1,onOpenChange:t,elements:r}=n,s=Xd(),o=x.useRef({}),[i]=x.useState(()=>$y()),a=Ka()!=null,[l,c]=x.useState(r.reference),u=un((p,m,g)=>{o.current.openEvent=p?m:void 0,i.emit("openchange",{open:p,event:m,reason:g,nested:a}),t==null||t(p,m,g)}),f=x.useMemo(()=>({setPositionReference:c}),[]),h=x.useMemo(()=>({reference:l||r.reference||null,floating:r.floating||null,domReference:r.reference}),[l,r.reference,r.floating]);return x.useMemo(()=>({dataRef:o,open:e,onOpenChange:u,elements:h,events:i,floatingId:s,refs:f}),[e,u,h,i,s,f])}function Qa(n){n===void 0&&(n={});const{nodeId:e}=n,t=Yy({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,s=r.elements,[o,i]=x.useState(null),[a,l]=x.useState(null),u=(s==null?void 0:s.reference)||o,f=x.useRef(null),h=Ga();Bt(()=>{u&&(f.current=u)},[u]);const p=Ny({...n,elements:{...s,...a&&{reference:a}}}),m=x.useCallback(w=>{const C=Ie(w)?{getBoundingClientRect:()=>w.getBoundingClientRect(),contextElement:w}:w;l(C),p.refs.setReference(C)},[p.refs]),g=x.useCallback(w=>{(Ie(w)||w===null)&&(f.current=w,i(w)),(Ie(p.refs.reference.current)||p.refs.reference.current===null||w!==null&&!Ie(w))&&p.refs.setReference(w)},[p.refs]),y=x.useMemo(()=>({...p.refs,setReference:g,setPositionReference:m,domReference:f}),[p.refs,g,m]),b=x.useMemo(()=>({...p.elements,domReference:u}),[p.elements,u]),v=x.useMemo(()=>({...p,...r,refs:y,elements:b,nodeId:e}),[p,y,b,e,r]);return Bt(()=>{r.dataRef.current.floatingContext=v;const w=h==null?void 0:h.nodesRef.current.find(C=>C.id===e);w&&(w.context=v)}),x.useMemo(()=>({...p,context:v,refs:y,elements:b}),[p,y,b,v])}function Ky(n,e){e===void 0&&(e={});const{open:t,onOpenChange:r,events:s,dataRef:o,elements:i}=n,{enabled:a=!0,visibleOnly:l=!0}=e,c=x.useRef(!1),u=x.useRef(),f=x.useRef(!0);x.useEffect(()=>{if(!a)return;const p=it(i.domReference);function m(){!t&&ht(i.domReference)&&i.domReference===rc(Rn(i.domReference))&&(c.current=!0)}function g(){f.current=!0}return p.addEventListener("blur",m),p.addEventListener("keydown",g,!0),()=>{p.removeEventListener("blur",m),p.removeEventListener("keydown",g,!0)}},[i.domReference,t,a]),x.useEffect(()=>{if(!a)return;function p(m){let{reason:g}=m;(g==="reference-press"||g==="escape-key")&&(c.current=!0)}return s.on("openchange",p),()=>{s.off("openchange",p)}},[s,a]),x.useEffect(()=>()=>{clearTimeout(u.current)},[]);const h=x.useMemo(()=>({onPointerDown(p){Lg(p.nativeEvent)||(f.current=!1)},onMouseLeave(){c.current=!1},onFocus(p){if(c.current)return;const m=hr(p.nativeEvent);if(l&&Ie(m))try{if(Fg()&&$g())throw Error();if(!m.matches(":focus-visible"))return}catch{if(!f.current&&!Vg(m))return}r(!0,p.nativeEvent,"focus")},onBlur(p){c.current=!1;const m=p.relatedTarget,g=p.nativeEvent,y=Ie(m)&&m.hasAttribute(Ja("focus-guard"))&&m.getAttribute("data-type")==="outside";u.current=window.setTimeout(()=>{var b;const v=rc(i.domReference?i.domReference.ownerDocument:document);!m&&v===i.domReference||rs((b=o.current.floatingContext)==null?void 0:b.refs.floating.current,v)||rs(i.domReference,v)||y||r(!1,g,"focus")})}}),[o,i.domReference,r,l]);return x.useMemo(()=>a?{reference:h}:{},[a,h])}const gc="active",yc="selected";function si(n,e,t){const r=new Map,s=t==="item";let o=n;if(s&&n){const{[gc]:i,[yc]:a,...l}=n;o=l}return{...t==="floating"&&{tabIndex:-1},...o,...e.map(i=>{const a=i?i[t]:null;return typeof a=="function"?n?a(n):null:a}).concat(n).reduce((i,a)=>(a&&Object.entries(a).forEach(l=>{let[c,u]=l;if(!(s&&[gc,yc].includes(c)))if(c.indexOf("on")===0){if(r.has(c)||r.set(c,[]),typeof u=="function"){var f;(f=r.get(c))==null||f.push(u),i[c]=function(){for(var h,p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return(h=r.get(c))==null?void 0:h.map(y=>y(...m)).find(y=>y!==void 0)}}}else i[c]=u}),i),{})}}function Gy(n){n===void 0&&(n=[]);const e=n.map(a=>a==null?void 0:a.reference),t=n.map(a=>a==null?void 0:a.floating),r=n.map(a=>a==null?void 0:a.item),s=x.useCallback(a=>si(a,n,"reference"),e),o=x.useCallback(a=>si(a,n,"floating"),t),i=x.useCallback(a=>si(a,n,"item"),r);return x.useMemo(()=>({getReferenceProps:s,getFloatingProps:o,getItemProps:i}),[s,o,i])}const Jy=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function Qy(n,e){var t;e===void 0&&(e={});const{open:r,floatingId:s}=n,{enabled:o=!0,role:i="dialog"}=e,a=(t=Jy.get(i))!=null?t:i,l=Xd(),u=Ka()!=null,f=x.useMemo(()=>a==="tooltip"||i==="label"?{["aria-"+(i==="label"?"labelledby":"describedby")]:r?s:void 0}:{"aria-expanded":r?"true":"false","aria-haspopup":a==="alertdialog"?"dialog":a,"aria-controls":r?s:void 0,...a==="listbox"&&{role:"combobox"},...a==="menu"&&{id:l},...a==="menu"&&u&&{role:"menuitem"},...i==="select"&&{"aria-autocomplete":"none"},...i==="combobox"&&{"aria-autocomplete":"list"}},[a,s,u,r,l,i]),h=x.useMemo(()=>{const m={id:s,...a&&{role:a}};return a==="tooltip"||i==="label"?m:{...m,...a==="menu"&&{"aria-labelledby":l}}},[a,s,l,i]),p=x.useCallback(m=>{let{active:g,selected:y}=m;const b={role:"option",...g&&{id:s+"-option"}};switch(i){case"select":return{...b,"aria-selected":g&&y};case"combobox":return{...b,...g&&{"aria-selected":!0}}}return{}},[s,i]);return x.useMemo(()=>o?{reference:f,floating:h,item:p}:{},[o,f,h,p])}function tf(n,e){if(n==="rtl"&&(e.includes("right")||e.includes("left"))){const[t,r]=e.split("-"),s=t==="right"?"left":"right";return r===void 0?s:`${s}-${r}`}return e}function xc(n,e,t,r){return n==="center"||r==="center"?{top:e}:n==="end"?{bottom:t}:n==="start"?{top:t}:{}}function bc(n,e,t,r,s){return n==="center"||r==="center"?{left:e}:n==="end"?{[s==="ltr"?"right":"left"]:t}:n==="start"?{[s==="ltr"?"left":"right"]:t}:{}}const Xy={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function Zy({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,arrowX:o,arrowY:i,dir:a}){const[l,c="center"]=n.split("-"),u={width:e,height:e,transform:"rotate(45deg)",position:"absolute",[Xy[l]]:r},f=-e/2;return l==="left"?{...u,...xc(c,i,t,s),right:f,borderLeftColor:"transparent",borderBottomColor:"transparent"}:l==="right"?{...u,...xc(c,i,t,s),left:f,borderRightColor:"transparent",borderTopColor:"transparent"}:l==="top"?{...u,...bc(c,o,t,s,a),bottom:f,borderTopColor:"transparent",borderLeftColor:"transparent"}:l==="bottom"?{...u,...bc(c,o,t,s,a),top:f,borderBottomColor:"transparent",borderRightColor:"transparent"}:{}}const Xa=x.forwardRef(({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,visible:o,arrowX:i,arrowY:a,style:l,...c},u)=>{const{dir:f}=Fa();return o?d.jsx("div",{...c,ref:u,style:{...l,...Zy({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,dir:f,arrowX:i,arrowY:a})}}):null});Xa.displayName="@mantine/core/FloatingArrow";const[e0,nf]=xd("Popover component was not found in the tree");function Za({children:n,active:e=!0,refProp:t="ref",innerRef:r}){const s=_m(e),o=Ar(s,r);return wo(n)?x.cloneElement(n,{[t]:o}):n}function rf(n){return d.jsx($a,{tabIndex:-1,"data-autofocus":!0,...n})}Za.displayName="@mantine/core/FocusTrap";rf.displayName="@mantine/core/FocusTrapInitialFocus";Za.InitialFocus=rf;function t0(n){const e=document.createElement("div");return e.setAttribute("data-portal","true"),typeof n.className=="string"&&e.classList.add(...n.className.split(" ").filter(Boolean)),typeof n.style=="object"&&Object.assign(e.style,n.style),typeof n.id=="string"&&e.setAttribute("id",n.id),e}const n0={},sf=x.forwardRef((n,e)=>{const{children:t,target:r,...s}=ie("Portal",n0,n),[o,i]=x.useState(!1),a=x.useRef(null);return ed(()=>(i(!0),a.current=r?typeof r=="string"?document.querySelector(r):r:t0(s),Sd(e,a.current),!r&&a.current&&document.body.appendChild(a.current),()=>{!r&&a.current&&document.body.removeChild(a.current)}),[r]),!o||!a.current?null:Ta.createPortal(d.jsx(d.Fragment,{children:t}),a.current)});sf.displayName="@mantine/core/Portal";function Mo({withinPortal:n=!0,children:e,...t}){return n?d.jsx(sf,{...t,children:e}):d.jsx(d.Fragment,{children:e})}Mo.displayName="@mantine/core/OptionalPortal";const Vr=n=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${te(n==="bottom"?10:-10)})`},transitionProperty:"transform, opacity"}),Ss={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${te(30)}`},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${te(-30)}`},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${te(30)}`},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${te(-30)}`},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${te(-20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${te(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${te(20)}) rotate(-5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${te(20)}) rotate(5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...Vr("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...Vr("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...Vr("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...Vr("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...Vr("top"),common:{transformOrigin:"top right"}}},vc={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function r0({transition:n,state:e,duration:t,timingFunction:r}){const s={transitionDuration:`${t}ms`,transitionTimingFunction:r};return typeof n=="string"?n in Ss?{transitionProperty:Ss[n].transitionProperty,...s,...Ss[n].common,...Ss[n][vc[e]]}:{}:{transitionProperty:n.transitionProperty,...s,...n.common,...n[vc[e]]}}function s0({duration:n,exitDuration:e,timingFunction:t,mounted:r,onEnter:s,onExit:o,onEntered:i,onExited:a,enterDelay:l,exitDelay:c}){const u=Xt(),f=Um(),h=u.respectReducedMotion?f:!1,[p,m]=x.useState(h?0:n),[g,y]=x.useState(r?"entered":"exited"),b=x.useRef(-1),v=x.useRef(-1),w=x.useRef(-1),C=k=>{const T=k?s:o,E=k?i:a;window.clearTimeout(b.current);const I=h?0:k?n:e;m(I),I===0?(typeof T=="function"&&T(),typeof E=="function"&&E(),y(k?"entered":"exited")):w.current=requestAnimationFrame(()=>{nd.flushSync(()=>{y(k?"pre-entering":"pre-exiting")}),w.current=requestAnimationFrame(()=>{typeof T=="function"&&T(),y(k?"entering":"exiting"),b.current=window.setTimeout(()=>{typeof E=="function"&&E(),y(k?"entered":"exited")},I)})})},M=k=>{if(window.clearTimeout(v.current),typeof(k?l:c)!="number"){C(k);return}v.current=window.setTimeout(()=>{C(k)},k?l:c)};return zt(()=>{M(r)},[r]),x.useEffect(()=>()=>{window.clearTimeout(b.current),cancelAnimationFrame(w.current)},[]),{transitionDuration:p,transitionStatus:g,transitionTimingFunction:t||"ease"}}function gs({keepMounted:n,transition:e="fade",duration:t=250,exitDuration:r=t,mounted:s,children:o,timingFunction:i="ease",onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:f,exitDelay:h}){const{transitionDuration:p,transitionStatus:m,transitionTimingFunction:g}=s0({mounted:s,exitDuration:r,duration:t,timingFunction:i,onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:f,exitDelay:h});return p===0?s?d.jsx(d.Fragment,{children:o({})}):n?o({display:"none"}):null:m==="exited"?n?o({display:"none"}):null:d.jsx(d.Fragment,{children:o(r0({transition:e,duration:p,state:m,timingFunction:g}))})}gs.displayName="@mantine/core/Transition";var of={dropdown:"m_38a85659",arrow:"m_a31dc6c1"};const o0={},el=Ne((n,e)=>{var y,b,v,w;const t=ie("PopoverDropdown",o0,n),{className:r,style:s,vars:o,children:i,onKeyDownCapture:a,variant:l,classNames:c,styles:u,...f}=t,h=nf(),p=Am({opened:h.opened,shouldReturnFocus:h.returnFocus}),m=h.withRoles?{"aria-labelledby":h.getTargetId(),id:h.getDropdownId(),role:"dialog",tabIndex:-1}:{},g=Ar(e,h.floating);return h.disabled?null:d.jsx(Mo,{...h.portalProps,withinPortal:h.withinPortal,children:d.jsx(gs,{mounted:h.opened,...h.transitionProps,transition:((y=h.transitionProps)==null?void 0:y.transition)||"fade",duration:((b=h.transitionProps)==null?void 0:b.duration)??150,keepMounted:h.keepMounted,exitDuration:typeof((v=h.transitionProps)==null?void 0:v.exitDuration)=="number"?h.transitionProps.exitDuration:(w=h.transitionProps)==null?void 0:w.duration,children:C=>d.jsx(Za,{active:h.trapFocus,innerRef:g,children:d.jsxs(ue,{...m,...f,variant:l,onKeyDownCapture:Mm(h.onClose,{active:h.closeOnEscape,onTrigger:p,onKeyDown:a}),"data-position":h.placement,"data-fixed":h.floatingStrategy==="fixed"||void 0,...h.getStyles("dropdown",{className:r,props:t,classNames:c,styles:u,style:[{...C,zIndex:h.zIndex,top:h.y??0,left:h.x??0,width:h.width==="target"?void 0:te(h.width)},s]}),children:[i,d.jsx(Xa,{ref:h.arrowRef,arrowX:h.arrowX,arrowY:h.arrowY,visible:h.withArrow,position:h.placement,arrowSize:h.arrowSize,arrowRadius:h.arrowRadius,arrowOffset:h.arrowOffset,arrowPosition:h.arrowPosition,...h.getStyles("arrow",{props:t,classNames:c,styles:u})})]})})})})});el.classes=of;el.displayName="@mantine/core/PopoverDropdown";const i0={refProp:"ref",popupType:"dialog"},af=Ne((n,e)=>{const{children:t,refProp:r,popupType:s,...o}=ie("PopoverTarget",i0,n);if(!wo(t))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const i=o,a=nf(),l=Ar(a.reference,t.ref,e),c=a.withRoles?{"aria-haspopup":s,"aria-expanded":a.opened,"aria-controls":a.getDropdownId(),id:a.getTargetId()}:{};return x.cloneElement(t,{...i,...c,...a.targetProps,className:Zt(a.targetProps.className,i.className,t.props.className),[r]:l,...a.controlled?null:{onClick:a.onToggle}})});af.displayName="@mantine/core/PopoverTarget";function lf({opened:n,floating:e,position:t,positionDependencies:r}){const[s,o]=x.useState(0);x.useEffect(()=>{if(e.refs.reference.current&&e.refs.floating.current)return ky(e.refs.reference.current,e.refs.floating.current,e.update)},[e.refs.reference.current,e.refs.floating.current,n,s,t]),zt(()=>{e.update()},r),zt(()=>{o(i=>i+1)},[n])}function a0(n){if(n===void 0)return{shift:!0,flip:!0};const e={...n};return n.shift===void 0&&(e.shift=!0),n.flip===void 0&&(e.flip=!0),e}function l0(n,e){const t=a0(n.middlewares),r=[Gd(n.offset)];return t.shift&&r.push(Ya(typeof t.shift=="boolean"?{limiter:dc(),padding:5}:{limiter:dc(),padding:5,...t.shift})),t.flip&&r.push(typeof t.flip=="boolean"?Gi():Gi(t.flip)),t.inline&&r.push(typeof t.inline=="boolean"?Ji():Ji(t.inline)),r.push(Jd({element:n.arrowRef,padding:n.arrowOffset})),(t.size||n.width==="target")&&r.push(Py({...typeof t.size=="boolean"?{}:t.size,apply({rects:s,availableWidth:o,availableHeight:i}){var c;const l=((c=e().refs.floating.current)==null?void 0:c.style)??{};t.size&&Object.assign(l,{maxWidth:`${o}px`,maxHeight:`${i}px`}),n.width==="target"&&Object.assign(l,{width:`${s.reference.width}px`})}})),r}function c0(n){const[e,t]=Dd({value:n.opened,defaultValue:n.defaultOpened,finalValue:!1,onChange:n.onChange}),r=()=>{var i;e&&((i=n.onClose)==null||i.call(n),t(!1))},s=()=>{var i,a;e?((i=n.onClose)==null||i.call(n),t(!1)):((a=n.onOpen)==null||a.call(n),t(!0))},o=Qa({strategy:n.strategy,placement:n.position,middleware:l0(n,()=>o)});return lf({opened:n.opened,position:n.position,positionDependencies:n.positionDependencies||[],floating:o}),zt(()=>{var i;(i=n.onPositionChange)==null||i.call(n,o.placement)},[o.placement]),zt(()=>{var i,a;n.opened?(a=n.onOpen)==null||a.call(n):(i=n.onClose)==null||i.call(n)},[n.opened]),{floating:o,controlled:typeof n.opened=="boolean",opened:e,onClose:r,onToggle:s}}const u0={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:Pa("popover"),__staticSelector:"Popover",width:"max-content"},d0=(n,{radius:e,shadow:t})=>({dropdown:{"--popover-radius":e===void 0?void 0:nr(e),"--popover-shadow":Tm(t)}});function _t(n){var or,ir,ar,lr,cr,ks;const e=ie("Popover",u0,n),{children:t,position:r,offset:s,onPositionChange:o,positionDependencies:i,opened:a,transitionProps:l,width:c,middlewares:u,withArrow:f,arrowSize:h,arrowOffset:p,arrowRadius:m,arrowPosition:g,unstyled:y,classNames:b,styles:v,closeOnClickOutside:w,withinPortal:C,portalProps:M,closeOnEscape:k,clickOutsideEvents:T,trapFocus:E,onClose:I,onOpen:F,onChange:V,zIndex:W,radius:_,shadow:D,id:A,defaultOpened:R,__staticSelector:P,withRoles:B,disabled:Y,returnFocus:$,variant:O,keepMounted:ae,vars:ve,floatingStrategy:De,...J}=e,ee=Pe({name:P,props:e,classes:of,classNames:b,styles:v,unstyled:y,rootSelector:"dropdown",vars:ve,varsResolver:d0}),oe=x.useRef(null),[fe,re]=x.useState(null),[pe,mt]=x.useState(null),{dir:St}=Fa(),He=Aa(A),je=c0({middlewares:u,width:c,position:tf(St,r),offset:typeof s=="number"?s+(f?h/2:0):s,arrowRef:oe,arrowOffset:p,onPositionChange:o,positionDependencies:i,opened:a,defaultOpened:R,onChange:V,onOpen:F,onClose:I,strategy:De});Om(()=>w&&je.onClose(),T,[fe,pe]);const tn=x.useCallback(En=>{re(En),je.floating.refs.setReference(En)},[je.floating.refs.setReference]),zr=x.useCallback(En=>{mt(En),je.floating.refs.setFloating(En)},[je.floating.refs.setFloating]);return d.jsx(e0,{value:{returnFocus:$,disabled:Y,controlled:je.controlled,reference:tn,floating:zr,x:je.floating.x,y:je.floating.y,arrowX:(ar=(ir=(or=je.floating)==null?void 0:or.middlewareData)==null?void 0:ir.arrow)==null?void 0:ar.x,arrowY:(ks=(cr=(lr=je.floating)==null?void 0:lr.middlewareData)==null?void 0:cr.arrow)==null?void 0:ks.y,opened:je.opened,arrowRef:oe,transitionProps:l,width:c,withArrow:f,arrowSize:h,arrowOffset:p,arrowRadius:m,arrowPosition:g,placement:je.floating.placement,trapFocus:E,withinPortal:C,portalProps:M,zIndex:W,radius:_,shadow:D,closeOnEscape:k,onClose:je.onClose,onToggle:je.onToggle,getTargetId:()=>`${He}-target`,getDropdownId:()=>`${He}-dropdown`,withRoles:B,targetProps:J,__staticSelector:P,classNames:b,styles:v,unstyled:y,variant:O,keepMounted:ae,getStyles:ee,floatingStrategy:De},children:t})}_t.Target=af;_t.Dropdown=el;_t.displayName="@mantine/core/Popover";_t.extend=n=>n;var Et={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const f0=x.forwardRef(({className:n,...e},t)=>d.jsxs(ue,{component:"span",className:Zt(Et.barsLoader,n),...e,ref:t,children:[d.jsx("span",{className:Et.bar}),d.jsx("span",{className:Et.bar}),d.jsx("span",{className:Et.bar})]})),h0=x.forwardRef(({className:n,...e},t)=>d.jsxs(ue,{component:"span",className:Zt(Et.dotsLoader,n),...e,ref:t,children:[d.jsx("span",{className:Et.dot}),d.jsx("span",{className:Et.dot}),d.jsx("span",{className:Et.dot})]})),p0=x.forwardRef(({className:n,...e},t)=>d.jsx(ue,{component:"span",className:Zt(Et.ovalLoader,n),...e,ref:t})),cf={bars:f0,oval:p0,dots:h0},m0={loaders:cf,type:"oval"},g0=(n,{size:e,color:t})=>({root:{"--loader-size":nt(e,"loader-size"),"--loader-color":t?xo(t,n):void 0}}),ys=Ne((n,e)=>{const t=ie("Loader",m0,n),{size:r,color:s,type:o,vars:i,className:a,style:l,classNames:c,styles:u,unstyled:f,loaders:h,variant:p,children:m,...g}=t,y=Pe({name:"Loader",props:t,classes:Et,className:a,style:l,classNames:c,styles:u,unstyled:f,vars:i,varsResolver:g0});return m?d.jsx(ue,{...y("root"),ref:e,...g,children:m}):d.jsx(ue,{...y("root"),ref:e,component:h[o],variant:p,size:r,...g})});ys.defaultLoaders=cf;ys.classes=Et;ys.displayName="@mantine/core/Loader";var To={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21"};const wc={orientation:"horizontal"},y0=(n,{borderWidth:e})=>({group:{"--ai-border-width":te(e)}}),tl=Ne((n,e)=>{const t=ie("ActionIconGroup",wc,n),{className:r,style:s,classNames:o,styles:i,unstyled:a,orientation:l,vars:c,borderWidth:u,variant:f,mod:h,...p}=ie("ActionIconGroup",wc,n),m=Pe({name:"ActionIconGroup",props:t,classes:To,className:r,style:s,classNames:o,styles:i,unstyled:a,vars:c,varsResolver:y0,rootSelector:"group"});return d.jsx(ue,{...m("group"),ref:e,variant:f,mod:[{"data-orientation":l},h],role:"group",...p})});tl.classes=To;tl.displayName="@mantine/core/ActionIconGroup";const x0={},b0=(n,{size:e,radius:t,variant:r,gradient:s,color:o,autoContrast:i})=>{const a=n.variantColorResolver({color:o||n.primaryColor,theme:n,gradient:s,variant:r||"filled",autoContrast:i});return{root:{"--ai-size":nt(e,"ai-size"),"--ai-radius":t===void 0?void 0:nr(t),"--ai-bg":o||r?a.background:void 0,"--ai-hover":o||r?a.hover:void 0,"--ai-hover-color":o||r?a.hoverColor:void 0,"--ai-color":a.color,"--ai-bd":o||r?a.border:void 0}}},dn=Rr((n,e)=>{const t=ie("ActionIcon",x0,n),{className:r,unstyled:s,variant:o,classNames:i,styles:a,style:l,loading:c,loaderProps:u,size:f,color:h,radius:p,__staticSelector:m,gradient:g,vars:y,children:b,disabled:v,"data-disabled":w,autoContrast:C,mod:M,...k}=t,T=Pe({name:["ActionIcon",m],props:t,className:r,style:l,classes:To,classNames:i,styles:a,unstyled:s,vars:y,varsResolver:b0});return d.jsxs(jr,{...T("root",{active:!v&&!c&&!w}),...k,unstyled:s,variant:o,size:f,disabled:v||c,ref:e,mod:[{loading:c,disabled:v||w},M],children:[d.jsx(gs,{mounted:!!c,transition:"slide-down",duration:150,children:E=>d.jsx(ue,{component:"span",...T("loader",{style:E}),"aria-hidden":!0,children:d.jsx(ys,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...u})})}),d.jsx(ue,{component:"span",mod:{loading:c},...T("icon"),children:b})]})});dn.classes=To;dn.displayName="@mantine/core/ActionIcon";dn.Group=tl;function v0(n){return x.Children.toArray(n).filter(Boolean)}var uf={root:"m_4081bf90"};const w0={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},k0=(n,{grow:e,preventGrowOverflow:t,gap:r,align:s,justify:o,wrap:i},{childWidth:a})=>({root:{"--group-child-width":e&&t?a:void 0,"--group-gap":Dt(r),"--group-align":s,"--group-justify":o,"--group-wrap":i}}),nl=Ne((n,e)=>{const t=ie("Group",w0,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,children:l,gap:c,align:u,justify:f,wrap:h,grow:p,preventGrowOverflow:m,vars:g,variant:y,__size:b,mod:v,...w}=t,C=v0(l),M=C.length,k=Dt(c??"md"),E={childWidth:`calc(${100/M}% - (${k} - ${k} / ${M}))`},I=Pe({name:"Group",props:t,stylesCtx:E,className:s,style:o,classes:uf,classNames:r,styles:i,unstyled:a,vars:g,varsResolver:k0});return d.jsx(ue,{...I("root"),ref:e,variant:y,mod:[{grow:p},v],size:b,...w,children:C})});nl.classes=uf;nl.displayName="@mantine/core/Group";const[C0,Do]=bd({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var kt={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const kc={},S0=(n,{size:e})=>({description:{"--input-description-size":e===void 0?void 0:`calc(${qt(e)} - ${te(2)})`}}),Eo=Ne((n,e)=>{const t=ie("InputDescription",kc,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,size:c,__staticSelector:u,__inheritStyles:f=!0,variant:h,...p}=ie("InputDescription",kc,t),m=Do(),g=Pe({name:["InputWrapper",u],props:t,classes:kt,className:s,style:o,classNames:r,styles:i,unstyled:a,rootSelector:"description",vars:l,varsResolver:S0}),y=f&&(m==null?void 0:m.getStyles)||g;return d.jsx(ue,{component:"p",ref:e,variant:h,size:c,...y("description",m!=null&&m.getStyles?{className:s,style:o}:void 0),...p})});Eo.classes=kt;Eo.displayName="@mantine/core/InputDescription";const M0={},T0=(n,{size:e})=>({error:{"--input-error-size":e===void 0?void 0:`calc(${qt(e)} - ${te(2)})`}}),Oo=Ne((n,e)=>{const t=ie("InputError",M0,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,size:c,__staticSelector:u,__inheritStyles:f=!0,variant:h,...p}=t,m=Pe({name:["InputWrapper",u],props:t,classes:kt,className:s,style:o,classNames:r,styles:i,unstyled:a,rootSelector:"error",vars:l,varsResolver:T0}),g=Do(),y=f&&(g==null?void 0:g.getStyles)||m;return d.jsx(ue,{component:"p",ref:e,variant:h,size:c,...y("error",g!=null&&g.getStyles?{className:s,style:o}:void 0),...p})});Oo.classes=kt;Oo.displayName="@mantine/core/InputError";const Cc={labelElement:"label"},D0=(n,{size:e})=>({label:{"--input-label-size":qt(e),"--input-asterisk-color":void 0}}),No=Ne((n,e)=>{const t=ie("InputLabel",Cc,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,labelElement:c,size:u,required:f,htmlFor:h,onMouseDown:p,children:m,__staticSelector:g,variant:y,mod:b,...v}=ie("InputLabel",Cc,t),w=Pe({name:["InputWrapper",g],props:t,classes:kt,className:s,style:o,classNames:r,styles:i,unstyled:a,rootSelector:"label",vars:l,varsResolver:D0}),C=Do(),M=(C==null?void 0:C.getStyles)||w;return d.jsxs(ue,{...M("label",C!=null&&C.getStyles?{className:s,style:o}:void 0),component:c,variant:y,size:u,ref:e,htmlFor:c==="label"?h:void 0,mod:[{required:f},b],onMouseDown:k=>{p==null||p(k),!k.defaultPrevented&&k.detail>1&&k.preventDefault()},...v,children:[m,f&&d.jsx("span",{...M("required"),"aria-hidden":!0,children:" *"})]})});No.classes=kt;No.displayName="@mantine/core/InputLabel";const Sc={},rl=Ne((n,e)=>{const t=ie("InputPlaceholder",Sc,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,__staticSelector:c,variant:u,error:f,mod:h,...p}=ie("InputPlaceholder",Sc,t),m=Pe({name:["InputPlaceholder",c],props:t,classes:kt,className:s,style:o,classNames:r,styles:i,unstyled:a,rootSelector:"placeholder"});return d.jsx(ue,{...m("placeholder"),mod:[{error:!!f},h],component:"span",variant:u,ref:e,...p})});rl.classes=kt;rl.displayName="@mantine/core/InputPlaceholder";function E0(n,{hasDescription:e,hasError:t}){const r=n.findIndex(l=>l==="input"),s=n.slice(0,r),o=n.slice(r+1),i=e&&s.includes("description")||t&&s.includes("error");return{offsetBottom:e&&o.includes("description")||t&&o.includes("error"),offsetTop:i}}const O0={labelElement:"label",inputContainer:n=>n,inputWrapperOrder:["label","description","input","error"]},N0=(n,{size:e})=>({label:{"--input-label-size":qt(e),"--input-asterisk-color":void 0},error:{"--input-error-size":e===void 0?void 0:`calc(${qt(e)} - ${te(2)})`},description:{"--input-description-size":e===void 0?void 0:`calc(${qt(e)} - ${te(2)})`}}),sl=Ne((n,e)=>{const t=ie("InputWrapper",O0,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,size:c,variant:u,__staticSelector:f,inputContainer:h,inputWrapperOrder:p,label:m,error:g,description:y,labelProps:b,descriptionProps:v,errorProps:w,labelElement:C,children:M,withAsterisk:k,id:T,required:E,__stylesApiProps:I,mod:F,...V}=t,W=Pe({name:["InputWrapper",f],props:I||t,classes:kt,className:s,style:o,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:N0}),_={size:c,variant:u,__staticSelector:f},D=Aa(T),A=typeof k=="boolean"?k:E,R=(w==null?void 0:w.id)||`${D}-error`,P=(v==null?void 0:v.id)||`${D}-description`,B=D,Y=!!g&&typeof g!="boolean",$=!!y,O=`${Y?R:""} ${$?P:""}`,ae=O.trim().length>0?O.trim():void 0,ve=(b==null?void 0:b.id)||`${D}-label`,De=m&&d.jsx(No,{labelElement:C,id:ve,htmlFor:B,required:A,..._,...b,children:m},"label"),J=$&&d.jsx(Eo,{...v,..._,size:(v==null?void 0:v.size)||_.size,id:(v==null?void 0:v.id)||P,children:y},"description"),ee=d.jsx(x.Fragment,{children:h(M)},"input"),oe=Y&&x.createElement(Oo,{...w,..._,size:(w==null?void 0:w.size)||_.size,key:"error",id:(w==null?void 0:w.id)||R},g),fe=p.map(re=>{switch(re){case"label":return De;case"input":return ee;case"description":return J;case"error":return oe;default:return null}});return d.jsx(C0,{value:{getStyles:W,describedBy:ae,inputId:B,labelId:ve,...E0(p,{hasDescription:$,hasError:Y})},children:d.jsx(ue,{ref:e,variant:u,size:c,mod:[{error:!!g},F],...W("root"),...V,children:fe})})});sl.classes=kt;sl.displayName="@mantine/core/InputWrapper";const I0={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0},P0=(n,e,t)=>({wrapper:{"--input-margin-top":t.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":t.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":nt(e.size,"input-height"),"--input-fz":qt(e.size),"--input-radius":e.radius===void 0?void 0:nr(e.radius),"--input-left-section-width":e.leftSectionWidth!==void 0?te(e.leftSectionWidth):void 0,"--input-right-section-width":e.rightSectionWidth!==void 0?te(e.rightSectionWidth):void 0,"--input-padding-y":e.multiline?nt(e.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":e.leftSectionPointerEvents,"--input-right-section-pointer-events":e.rightSectionPointerEvents}}),It=Rr((n,e)=>{const t=ie("Input",I0,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,required:l,__staticSelector:c,__stylesApiProps:u,size:f,wrapperProps:h,error:p,disabled:m,leftSection:g,leftSectionProps:y,leftSectionWidth:b,rightSection:v,rightSectionProps:w,rightSectionWidth:C,rightSectionPointerEvents:M,leftSectionPointerEvents:k,variant:T,vars:E,pointer:I,multiline:F,radius:V,id:W,withAria:_,withErrorStyles:D,mod:A,inputSize:R,...P}=t,{styleProps:B,rest:Y}=ja(P),$=Do(),O={offsetBottom:$==null?void 0:$.offsetBottom,offsetTop:$==null?void 0:$.offsetTop},ae=Pe({name:["Input",c],props:u||t,classes:kt,className:s,style:o,classNames:r,styles:i,unstyled:a,stylesCtx:O,rootSelector:"wrapper",vars:E,varsResolver:P0}),ve=_?{required:l,disabled:m,"aria-invalid":!!p,"aria-describedby":$==null?void 0:$.describedBy,id:($==null?void 0:$.inputId)||W}:{};return d.jsxs(ue,{...ae("wrapper"),...B,...h,mod:[{error:!!p&&D,pointer:I,disabled:m,multiline:F,"data-with-right-section":!!v,"data-with-left-section":!!g},A],variant:T,size:f,children:[g&&d.jsx("div",{...y,"data-position":"left",...ae("section",{className:y==null?void 0:y.className,style:y==null?void 0:y.style}),children:g}),d.jsx(ue,{component:"input",...Y,...ve,ref:e,required:l,mod:{disabled:m,error:!!p&&D},variant:T,__size:R,...ae("input")}),v&&d.jsx("div",{...w,"data-position":"right",...ae("section",{className:w==null?void 0:w.className,style:w==null?void 0:w.style}),children:v})]})});It.classes=kt;It.Wrapper=sl;It.Label=No;It.Error=Oo;It.Description=Eo;It.Placeholder=rl;It.displayName="@mantine/core/Input";function A0(n,e,t){const r=ie(n,e,t),{label:s,description:o,error:i,required:a,classNames:l,styles:c,className:u,unstyled:f,__staticSelector:h,__stylesApiProps:p,errorProps:m,labelProps:g,descriptionProps:y,wrapperProps:b,id:v,size:w,style:C,inputContainer:M,inputWrapperOrder:k,withAsterisk:T,variant:E,vars:I,mod:F,...V}=r,{styleProps:W,rest:_}=ja(V),D={label:s,description:o,error:i,required:a,classNames:l,className:u,__staticSelector:h,__stylesApiProps:p||r,errorProps:m,labelProps:g,descriptionProps:y,unstyled:f,styles:c,size:w,style:C,inputContainer:M,inputWrapperOrder:k,withAsterisk:T,variant:E,id:v,mod:F,...b};return{..._,classNames:l,styles:c,unstyled:f,wrapperProps:{...D,...W},inputProps:{required:a,classNames:l,styles:c,unstyled:f,size:w,__staticSelector:h,__stylesApiProps:p||r,error:i,variant:E,id:v}}}const R0={__staticSelector:"InputBase",withAria:!0},Io=Rr((n,e)=>{const{inputProps:t,wrapperProps:r,...s}=A0("InputBase",R0,n);return d.jsx(It.Wrapper,{...r,children:d.jsx(It,{...t,...s,ref:e})})});Io.classes={...It.classes,...It.Wrapper.classes};Io.displayName="@mantine/core/InputBase";var Po={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844"};const Mc={orientation:"horizontal"},j0=(n,{borderWidth:e})=>({group:{"--button-border-width":te(e)}}),ol=Ne((n,e)=>{const t=ie("ButtonGroup",Mc,n),{className:r,style:s,classNames:o,styles:i,unstyled:a,orientation:l,vars:c,borderWidth:u,variant:f,mod:h,...p}=ie("ButtonGroup",Mc,n),m=Pe({name:"ButtonGroup",props:t,classes:Po,className:r,style:s,classNames:o,styles:i,unstyled:a,vars:c,varsResolver:j0,rootSelector:"group"});return d.jsx(ue,{...m("group"),ref:e,variant:f,mod:[{"data-orientation":l},h],role:"group",...p})});ol.classes=Po;ol.displayName="@mantine/core/ButtonGroup";const L0={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${te(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},F0={},$0=(n,{radius:e,color:t,gradient:r,variant:s,size:o,justify:i,autoContrast:a})=>{const l=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:a});return{root:{"--button-justify":i,"--button-height":nt(o,"button-height"),"--button-padding-x":nt(o,"button-padding-x"),"--button-fz":o!=null&&o.includes("compact")?qt(o.replace("compact-","")):qt(o),"--button-radius":e===void 0?void 0:nr(e),"--button-bg":t||s?l.background:void 0,"--button-hover":t||s?l.hover:void 0,"--button-color":l.color,"--button-bd":t||s?l.border:void 0,"--button-hover-color":t||s?l.hoverColor:void 0}}},Ao=Rr((n,e)=>{const t=ie("Button",F0,n),{style:r,vars:s,className:o,color:i,disabled:a,children:l,leftSection:c,rightSection:u,fullWidth:f,variant:h,radius:p,loading:m,loaderProps:g,gradient:y,classNames:b,styles:v,unstyled:w,"data-disabled":C,autoContrast:M,mod:k,...T}=t,E=Pe({name:"Button",props:t,classes:Po,className:o,style:r,classNames:b,styles:v,unstyled:w,vars:s,varsResolver:$0}),I=!!c,F=!!u;return d.jsxs(jr,{ref:e,...E("root",{active:!a&&!m&&!C}),unstyled:w,variant:h,disabled:a||m,mod:[{disabled:a||C,loading:m,block:f,"with-left-section":I,"with-right-section":F},k],...T,children:[d.jsx(gs,{mounted:!!m,transition:L0,duration:150,children:V=>d.jsx(ue,{component:"span",...E("loader",{style:V}),"aria-hidden":!0,children:d.jsx(ys,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...g})})}),d.jsxs("span",{...E("inner"),children:[c&&d.jsx(ue,{component:"span",...E("section"),mod:{position:"left"},children:c}),d.jsx(ue,{component:"span",mod:{loading:m},...E("label"),children:l}),u&&d.jsx(ue,{component:"span",...E("section"),mod:{position:"right"},children:u})]})]})});Ao.classes=Po;Ao.displayName="@mantine/core/Button";Ao.Group=ol;var df={root:"m_de3d2490",colorOverlay:"m_862f3d1b",shadowOverlay:"m_98ae7f22",alphaOverlay:"m_95709ac0",childrenOverlay:"m_93e74e3"};const Tc={withShadow:!0},B0=(n,{radius:e,size:t})=>({root:{"--cs-radius":e===void 0?void 0:nr(e),"--cs-size":te(t)}}),Yn=Rr((n,e)=>{const t=ie("ColorSwatch",Tc,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,color:c,size:u,radius:f,withShadow:h,children:p,variant:m,...g}=ie("ColorSwatch",Tc,t),y=Pe({name:"ColorSwatch",props:t,classes:df,className:s,style:o,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:B0});return d.jsxs(ue,{ref:e,variant:m,size:u,...y("root",{focusable:!0}),...g,children:[d.jsx("span",{...y("alphaOverlay")}),h&&d.jsx("span",{...y("shadowOverlay")}),d.jsx("span",{...y("colorOverlay",{style:{backgroundColor:c}})}),d.jsx("span",{...y("childrenOverlay"),children:p})]})});Yn.classes=df;Yn.displayName="@mantine/core/ColorSwatch";const[_0,il]=bd(null),al=x.forwardRef(({position:n,...e},t)=>d.jsx(ue,{ref:t,__vars:{"--thumb-y-offset":`${n.y*100}%`,"--thumb-x-offset":`${n.x*100}%`},...e}));al.displayName="@mantine/core/ColorPickerThumb";var ll={wrapper:"m_fee9c77",preview:"m_9dddfbac",body:"m_bffecc3e",sliders:"m_3283bb96",thumb:"m_40d572ba",swatch:"m_d8ee6fd8",swatches:"m_5711e686",saturation:"m_202a296e",saturationOverlay:"m_11b3db02",slider:"m_d856d47d",sliderOverlay:"m_8f327113"};const z0={},cl=Ne((n,e)=>{var B;const t=ie("ColorSlider",z0,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,onChange:c,onChangeEnd:u,maxValue:f,round:h,size:p="md",focusable:m=!0,value:g,overlays:y,thumbColor:b="transparent",onScrubStart:v,onScrubEnd:w,__staticSelector:C="ColorPicker",...M}=t,k=Pe({name:C,classes:ll,props:t,className:s,style:o,classNames:r,styles:i,unstyled:a}),E=((B=il())==null?void 0:B.getStyles)||k,I=Xt(),[F,V]=x.useState({y:0,x:g/f}),W=x.useRef(F),_=Y=>h?Math.round(Y*f):Y*f,{ref:D}=Td(({x:Y,y:$})=>{W.current={x:Y,y:$},c==null||c(_(Y))},{onScrubEnd:()=>{const{x:Y}=W.current;u==null||u(_(Y)),w==null||w()},onScrubStart:v});zt(()=>{V({y:0,x:g/f})},[g]);const A=(Y,$)=>{Y.preventDefault();const O=Md($);c==null||c(_(O.x)),u==null||u(_(O.x))},R=Y=>{switch(Y.key){case"ArrowRight":{A(Y,{x:F.x+.05,y:F.y});break}case"ArrowLeft":{A(Y,{x:F.x-.05,y:F.y});break}}},P=y.map((Y,$)=>x.createElement("div",{...E("sliderOverlay"),style:Y,key:$}));return d.jsxs(ue,{...M,ref:Ar(D,e),...E("slider"),role:"slider","aria-valuenow":g,"aria-valuemax":f,"aria-valuemin":0,tabIndex:m?0:-1,onKeyDown:R,"data-focus-ring":I.focusRing,__vars:{"--cp-thumb-size":`var(--cp-thumb-size-${p})`},children:[P,d.jsx(al,{position:F,...E("thumb",{style:{top:te(1),background:b}})})]})});cl.displayName="@mantine/core/ColorSlider";function xt(n,e=0,t=10**e){return Math.round(t*n)/t}function H0({h:n,s:e,l:t,a:r}){const s=e*((t<50?t:100-t)/100);return{h:n,s:s>0?2*s/(t+s)*100:0,v:t+s,a:r}}const V0={grad:360/400,turn:360,rad:360/(Math.PI*2)};function W0(n,e="deg"){return Number(n)*(V0[e]||1)}const U0=/hsla?\(?\s*(-?\d*\.?\d+)(deg|rad|grad|turn)?[,\s]+(-?\d*\.?\d+)%?[,\s]+(-?\d*\.?\d+)%?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;function Dc(n){const e=U0.exec(n);return e?H0({h:W0(e[1],e[2]),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)}):{h:0,s:0,v:0,a:1}}function Xi({r:n,g:e,b:t,a:r}){const s=Math.max(n,e,t),o=s-Math.min(n,e,t),i=o?s===n?(e-t)/o:s===e?2+(t-n)/o:4+(n-e)/o:0;return{h:xt(60*(i<0?i+6:i),3),s:xt(s?o/s*100:0,3),v:xt(s/255*100,3),a:r}}function Zi(n){const e=n[0]==="#"?n.slice(1):n;return e.length===3?Xi({r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:1}):Xi({r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16),a:1})}function q0(n){const e=n[0]==="#"?n.slice(1):n,t=i=>xt(parseInt(i,16)/255,3);if(e.length===4){const i=e.slice(0,3),a=t(e[3]+e[3]);return{...Zi(i),a}}const r=e.slice(0,6),s=t(e.slice(6,8));return{...Zi(r),a:s}}const Y0=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i;function Ec(n){const e=Y0.exec(n);return e?Xi({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):{h:0,s:0,v:0,a:1}}const ff={hex:/^#?([0-9A-F]{3}){1,2}$/i,hexa:/^#?([0-9A-F]{4}){1,2}$/i,rgb:/^rgb\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/i,rgba:/^rgba\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/i,hsl:/hsl\(\s*(\d+)\s*,\s*(\d+(?:\.\d+)?%)\s*,\s*(\d+(?:\.\d+)?%)\)/i,hsla:/^hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)$/i},K0={hex:Zi,hexa:q0,rgb:Ec,rgba:Ec,hsl:Dc,hsla:Dc};function G0(n){for(const[,e]of Object.entries(ff))if(e.test(n))return!0;return!1}function Ms(n){if(typeof n!="string")return{h:0,s:0,v:0,a:1};if(n==="transparent")return{h:0,s:0,v:0,a:0};const e=n.trim();for(const[t,r]of Object.entries(ff))if(r.test(e))return K0[t](e);return{h:0,s:0,v:0,a:1}}const J0={},hf=x.forwardRef((n,e)=>{const{value:t,onChange:r,onChangeEnd:s,color:o,...i}=ie("AlphaSlider",J0,n);return d.jsx(cl,{...i,ref:e,value:t,onChange:a=>r==null?void 0:r(xt(a,2)),onChangeEnd:a=>s==null?void 0:s(xt(a,2)),maxValue:1,round:!1,"data-alpha":!0,overlays:[{backgroundImage:"linear-gradient(45deg, var(--slider-checkers) 25%, transparent 25%), linear-gradient(-45deg, var(--slider-checkers) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, var(--slider-checkers) 75%), linear-gradient(-45deg, var(--mantine-color-body) 75%, var(--slider-checkers) 75%)",backgroundSize:`${te(8)} ${te(8)}`,backgroundPosition:`0 0, 0 ${te(4)}, ${te(4)} ${te(-4)}, ${te(-4)} 0`},{backgroundImage:`linear-gradient(90deg, transparent, ${o})`},{boxShadow:`rgba(0, 0, 0, .1) 0 0 0 ${te(1)} inset, rgb(0, 0, 0, .15) 0 0 ${te(4)} inset`}]})});hf.displayName="@mantine/core/AlphaSlider";function pf({h:n,s:e,v:t,a:r}){const s=n/360*6,o=e/100,i=t/100,a=Math.floor(s),l=i*(1-o),c=i*(1-(s-a)*o),u=i*(1-(1-s+a)*o),f=a%6;return{r:xt([i,c,l,l,u,i][f]*255),g:xt([u,i,i,c,l,l][f]*255),b:xt([l,l,u,i,i,c][f]*255),a:xt(r,2)}}function Oc(n,e){const{r:t,g:r,b:s,a:o}=pf(n);return e?`rgba(${t}, ${r}, ${s}, ${xt(o,2)})`:`rgb(${t}, ${r}, ${s})`}function Nc({h:n,s:e,v:t,a:r},s){const o=(200-e)*t/100,i={h:Math.round(n),s:Math.round(o>0&&o<200?e*t/100/(o<=100?o:200-o)*100:0),l:Math.round(o/2)};return s?`hsla(${i.h}, ${i.s}%, ${i.l}%, ${xt(r,2)})`:`hsl(${i.h}, ${i.s}%, ${i.l}%)`}function zs(n){const e=n.toString(16);return e.length<2?`0${e}`:e}function mf(n){const{r:e,g:t,b:r}=pf(n);return`#${zs(e)}${zs(t)}${zs(r)}`}function Q0(n){const e=Math.round(n.a*255);return`${mf(n)}${zs(e)}`}const oi={hex:mf,hexa:n=>Q0(n),rgb:n=>Oc(n,!1),rgba:n=>Oc(n,!0),hsl:n=>Nc(n,!1),hsla:n=>Nc(n,!0)};function rn(n,e){return e?n in oi?oi[n](e):oi.hex(e):"#000000"}const gf=x.forwardRef((n,e)=>{const{value:t,onChange:r,onChangeEnd:s,color:o,...i}=ie("HueSlider",{},n);return d.jsx(cl,{...i,ref:e,value:t,onChange:r,onChangeEnd:s,maxValue:360,thumbColor:`hsl(${t}, 100%, 50%)`,round:!0,"data-hue":!0,overlays:[{backgroundImage:"linear-gradient(to right,hsl(0,100%,50%),hsl(60,100%,50%),hsl(120,100%,50%),hsl(170,100%,50%),hsl(240,100%,50%),hsl(300,100%,50%),hsl(360,100%,50%))"},{boxShadow:`rgba(0, 0, 0, .1) 0 0 0 ${te(1)} inset, rgb(0, 0, 0, .15) 0 0 ${te(4)} inset`}]})});gf.displayName="@mantine/core/HueSlider";function yf({className:n,onChange:e,onChangeEnd:t,value:r,saturationLabel:s,focusable:o=!0,size:i,color:a,onScrubStart:l,onScrubEnd:c,...u}){const{getStyles:f}=il(),[h,p]=x.useState({x:r.s/100,y:1-r.v/100}),m=x.useRef(h),{ref:g}=Td(({x:v,y:w})=>{m.current={x:v,y:w},e({s:Math.round(v*100),v:Math.round((1-w)*100)})},{onScrubEnd:()=>{const{x:v,y:w}=m.current;t({s:Math.round(v*100),v:Math.round((1-w)*100)}),c==null||c()},onScrubStart:l});x.useEffect(()=>{p({x:r.s/100,y:1-r.v/100})},[r.s,r.v]);const y=(v,w)=>{v.preventDefault();const C=Md(w);e({s:Math.round(C.x*100),v:Math.round((1-C.y)*100)}),t({s:Math.round(C.x*100),v:Math.round((1-C.y)*100)})},b=v=>{switch(v.key){case"ArrowUp":{y(v,{y:h.y-.05,x:h.x});break}case"ArrowDown":{y(v,{y:h.y+.05,x:h.x});break}case"ArrowRight":{y(v,{x:h.x+.05,y:h.y});break}case"ArrowLeft":{y(v,{x:h.x-.05,y:h.y});break}}};return d.jsxs(ue,{...f("saturation"),ref:g,...u,role:"slider","aria-label":s,"aria-valuenow":h.x,"aria-valuetext":rn("rgba",r),tabIndex:o?0:-1,onKeyDown:b,children:[d.jsx("div",{...f("saturationOverlay",{style:{backgroundColor:`hsl(${r.h}, 100%, 50%)`}})}),d.jsx("div",{...f("saturationOverlay",{style:{backgroundImage:"linear-gradient(90deg, #fff, transparent)"}})}),d.jsx("div",{...f("saturationOverlay",{style:{backgroundImage:"linear-gradient(0deg, #000, transparent)"}})}),d.jsx(al,{position:h,...f("thumb",{style:{backgroundColor:a}})})]})}yf.displayName="@mantine/core/Saturation";const xf=x.forwardRef(({className:n,datatype:e,setValue:t,onChangeEnd:r,size:s,focusable:o,data:i,swatchesPerRow:a,...l},c)=>{const u=il(),f=i.map((h,p)=>x.createElement(Yn,{...u.getStyles("swatch"),unstyled:u.unstyled,component:"button",type:"button",color:h,key:p,radius:"sm",onClick:()=>{t(h),r==null||r(h)},"aria-label":h,tabIndex:o?0:-1,"data-swatch":!0}));return d.jsx(ue,{...u.getStyles("swatches"),ref:c,...l,children:f})});xf.displayName="@mantine/core/Swatches";const X0={swatchesPerRow:7,withPicker:!0,focusable:!0,size:"md",__staticSelector:"ColorPicker"},Z0=(n,{size:e,swatchesPerRow:t})=>({wrapper:{"--cp-preview-size":nt(e,"cp-preview-size"),"--cp-width":nt(e,"cp-width"),"--cp-body-spacing":Dt(e),"--cp-swatch-size":`${100/t}%`,"--cp-thumb-size":nt(e,"cp-thumb-size"),"--cp-saturation-height":nt(e,"cp-saturation-height")}}),ul=Ne((n,e)=>{const t=ie("ColorPicker",X0,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,format:c,value:u,defaultValue:f,onChange:h,onChangeEnd:p,withPicker:m,size:g,saturationLabel:y,hueLabel:b,alphaLabel:v,focusable:w,swatches:C,swatchesPerRow:M,fullWidth:k,onColorSwatchClick:T,__staticSelector:E,mod:I,...F}=t,V=Pe({name:E,props:t,classes:ll,className:s,style:o,classNames:r,styles:i,unstyled:a,rootSelector:"wrapper",vars:l,varsResolver:Z0}),W=x.useRef(c),_=x.useRef(),D=x.useRef(-1),A=x.useRef(!1),R=c==="hexa"||c==="rgba"||c==="hsla",[P,B,Y]=Dd({value:u,defaultValue:f,finalValue:"#FFFFFF",onChange:h}),[$,O]=x.useState(Ms(P)),ae=()=>{window.clearTimeout(D.current),A.current=!0},ve=()=>{window.clearTimeout(D.current),D.current=window.setTimeout(()=>{A.current=!1},200)},De=J=>{O(ee=>{const oe={...ee,...J};return _.current=rn(W.current,oe),oe}),B(_.current)};return zt(()=>{G0(u)&&!A.current&&O(Ms(u))},[u]),zt(()=>{W.current=c,B(rn(c,$))},[c]),d.jsx(_0,{value:{getStyles:V,unstyled:a},children:d.jsxs(ue,{ref:e,...V("wrapper"),size:g,mod:[{"full-width":k},I],...F,children:[m&&d.jsxs(d.Fragment,{children:[d.jsx(yf,{value:$,onChange:De,onChangeEnd:({s:J,v:ee})=>p==null?void 0:p(rn(W.current,{...$,s:J,v:ee})),color:P,size:g,focusable:w,saturationLabel:y,onScrubStart:ae,onScrubEnd:ve}),d.jsxs("div",{...V("body"),children:[d.jsxs("div",{...V("sliders"),children:[d.jsx(gf,{value:$.h,onChange:J=>De({h:J}),onChangeEnd:J=>p==null?void 0:p(rn(W.current,{...$,h:J})),size:g,focusable:w,"aria-label":b,onScrubStart:ae,onScrubEnd:ve}),R&&d.jsx(hf,{value:$.a,onChange:J=>De({a:J}),onChangeEnd:J=>{p==null||p(rn(W.current,{...$,a:J}))},size:g,color:rn("hex",$),focusable:w,"aria-label":v,onScrubStart:ae,onScrubEnd:ve})]}),R&&d.jsx(Yn,{color:P,radius:"sm",size:"var(--cp-preview-size)",...V("preview")})]})]}),Array.isArray(C)&&d.jsx(xf,{data:C,swatchesPerRow:M,focusable:w,setValue:B,onChangeEnd:J=>{const ee=rn(c,Ms(J));T==null||T(ee),p==null||p(ee),Y||O(Ms(J))}})]})})});ul.classes=ll;ul.displayName="@mantine/core/ColorPicker";var bf={root:"m_3eebeb36",label:"m_9e365f20"};const ex={orientation:"horizontal"},tx=(n,{color:e,variant:t,size:r})=>({root:{"--divider-color":e?xo(e,n):void 0,"--divider-border-style":t,"--divider-size":nt(r,"divider-size")}}),on=Ne((n,e)=>{const t=ie("Divider",ex,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,color:c,orientation:u,label:f,labelPosition:h,mod:p,...m}=t,g=Pe({name:"Divider",classes:bf,props:t,className:s,style:o,classNames:r,styles:i,unstyled:a,vars:l,varsResolver:tx});return d.jsx(ue,{ref:e,mod:[{orientation:u,"with-label":!!f},p],...g("root"),...m,role:"separator",children:f&&d.jsx(ue,{component:"span",mod:{position:h},...g("label"),children:f})})});on.classes=bf;on.displayName="@mantine/core/Divider";const nx={duration:100,transition:"fade"};function rx(n,e){return{...nx,...e,...n}}function sx({offset:n,position:e,defaultOpened:t}){const[r,s]=x.useState(t),o=x.useRef(),{x:i,y:a,elements:l,refs:c,update:u,placement:f}=Qa({placement:e,middleware:[Ya({crossAxis:!0,padding:5,rootBoundary:"document"})]}),h=f.includes("right")?n:e.includes("left")?n*-1:0,p=f.includes("bottom")?n:e.includes("top")?n*-1:0,m=x.useCallback(({clientX:g,clientY:y})=>{c.setPositionReference({getBoundingClientRect(){return{width:0,height:0,x:g,y,left:g+h,top:y+p,right:g,bottom:y}}})},[l.reference]);return x.useEffect(()=>{if(c.floating.current){const g=o.current;g.addEventListener("mousemove",m);const y=Yt(c.floating.current);return y.forEach(b=>{b.addEventListener("scroll",u)}),()=>{g.removeEventListener("mousemove",m),y.forEach(b=>{b.removeEventListener("scroll",u)})}}},[l.reference,c.floating.current,u,m,r]),{handleMouseMove:m,x:i,y:a,opened:r,setOpened:s,boundaryRef:o,floating:c.setFloating}}var Ro={tooltip:"m_1b3c8819",arrow:"m_f898399f"};const ox={refProp:"ref",withinPortal:!0,offset:10,defaultOpened:!1,position:"right",zIndex:Pa("popover")},ix=(n,{radius:e,color:t})=>({tooltip:{"--tooltip-radius":e===void 0?void 0:nr(e),"--tooltip-bg":t?xo(t,n):void 0,"--tooltip-color":t?"var(--mantine-color-white)":void 0}}),dl=Ne((n,e)=>{const t=ie("TooltipFloating",ox,n),{children:r,refProp:s,withinPortal:o,style:i,className:a,classNames:l,styles:c,unstyled:u,radius:f,color:h,label:p,offset:m,position:g,multiline:y,zIndex:b,disabled:v,defaultOpened:w,variant:C,vars:M,portalProps:k,...T}=t,E=Xt(),I=Pe({name:"TooltipFloating",props:t,classes:Ro,className:a,style:i,classNames:l,styles:c,unstyled:u,rootSelector:"tooltip",vars:M,varsResolver:ix}),{handleMouseMove:F,x:V,y:W,opened:_,boundaryRef:D,floating:A,setOpened:R}=sx({offset:m,position:g,defaultOpened:w});if(!wo(r))throw new Error("[@mantine/core] Tooltip.Floating component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");const P=Ar(D,r.ref,e),B=$=>{var O,ae;(ae=(O=r.props).onMouseEnter)==null||ae.call(O,$),F($),R(!0)},Y=$=>{var O,ae;(ae=(O=r.props).onMouseLeave)==null||ae.call(O,$),R(!1)};return d.jsxs(d.Fragment,{children:[d.jsx(Mo,{...k,withinPortal:o,children:d.jsx(ue,{...T,...I("tooltip",{style:{...Id(i,E),zIndex:b,display:!v&&_?"block":"none",top:(W&&Math.round(W))??"",left:(V&&Math.round(V))??""}}),variant:C,ref:A,mod:{multiline:y},children:p})}),x.cloneElement(r,{...r.props,[s]:P,onMouseEnter:B,onMouseLeave:Y})]})});dl.classes=Ro;dl.displayName="@mantine/core/TooltipFloating";const vf=x.createContext(!1),ax=vf.Provider,lx=()=>x.useContext(vf),cx={openDelay:0,closeDelay:0};function wf(n){const{openDelay:e,closeDelay:t,children:r}=ie("TooltipGroup",cx,n);return d.jsx(ax,{value:!0,children:d.jsx(Hy,{delay:{open:e,close:t},children:r})})}wf.displayName="@mantine/core/TooltipGroup";function ux(n){var k,T,E;const[e,t]=x.useState(n.defaultOpened),s=typeof n.opened=="boolean"?n.opened:e,o=lx(),i=Aa(),{delay:a,currentId:l,setCurrentId:c}=ef(),u=x.useCallback(I=>{t(I),I&&c(i)},[c,i]),{x:f,y:h,context:p,refs:m,update:g,placement:y,middlewareData:{arrow:{x:b,y:v}={}}}=Qa({strategy:n.strategy,placement:n.position,open:s,onOpenChange:u,middleware:[Gd(n.offset),Ya({padding:8}),Gi(),Jd({element:n.arrowRef,padding:n.arrowOffset}),...n.inline?[Ji()]:[]]}),{getReferenceProps:w,getFloatingProps:C}=Gy([zy(p,{enabled:(k=n.events)==null?void 0:k.hover,delay:o?a:{open:n.openDelay,close:n.closeDelay},mouseOnly:!((T=n.events)!=null&&T.touch)}),Ky(p,{enabled:(E=n.events)==null?void 0:E.focus,visibleOnly:!0}),Qy(p,{role:"tooltip"}),qy(p,{enabled:typeof n.opened>"u"}),Vy(p,{id:i})]);lf({opened:s,position:n.position,positionDependencies:n.positionDependencies,floating:{refs:m,update:g}}),zt(()=>{var I;(I=n.onPositionChange)==null||I.call(n,y)},[y]);const M=s&&l&&l!==i;return{x:f,y:h,arrowX:b,arrowY:v,reference:m.setReference,floating:m.setFloating,getFloatingProps:C,getReferenceProps:w,isGroupPhase:M,opened:s,placement:y}}const Ic={position:"top",refProp:"ref",withinPortal:!0,inline:!1,defaultOpened:!1,arrowSize:4,arrowOffset:5,arrowRadius:0,arrowPosition:"side",offset:5,transitionProps:{duration:100,transition:"fade"},events:{hover:!0,focus:!1,touch:!1},zIndex:Pa("popover"),positionDependencies:[]},dx=(n,{radius:e,color:t})=>({tooltip:{"--tooltip-radius":e===void 0?void 0:nr(e),"--tooltip-bg":t?xo(t,n):void 0,"--tooltip-color":t?"var(--mantine-color-white)":void 0}}),$r=Ne((n,e)=>{const t=ie("Tooltip",Ic,n),{children:r,position:s,refProp:o,label:i,openDelay:a,closeDelay:l,onPositionChange:c,opened:u,defaultOpened:f,withinPortal:h,radius:p,color:m,classNames:g,styles:y,unstyled:b,style:v,className:w,withArrow:C,arrowSize:M,arrowOffset:k,arrowRadius:T,arrowPosition:E,offset:I,transitionProps:F,multiline:V,events:W,zIndex:_,disabled:D,positionDependencies:A,onClick:R,onMouseEnter:P,onMouseLeave:B,inline:Y,variant:$,keepMounted:O,vars:ae,portalProps:ve,mod:De,floatingStrategy:J,...ee}=ie("Tooltip",Ic,t),{dir:oe}=Fa(),fe=x.useRef(null),re=ux({position:tf(oe,s),closeDelay:l,openDelay:a,onPositionChange:c,opened:u,defaultOpened:f,events:W,arrowRef:fe,arrowOffset:k,offset:typeof I=="number"?I+(C?M/2:0):I,positionDependencies:[...A,r],inline:Y,strategy:J}),pe=Pe({name:"Tooltip",props:t,classes:Ro,className:w,style:v,classNames:g,styles:y,unstyled:b,rootSelector:"tooltip",vars:ae,varsResolver:dx});if(!wo(r))throw new Error("[@mantine/core] Tooltip component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");const mt=Ar(re.reference,r.ref,e),St=rx(F,{duration:100,transition:"fade"});return d.jsxs(d.Fragment,{children:[d.jsx(Mo,{...ve,withinPortal:h,children:d.jsx(gs,{...St,keepMounted:O,mounted:!D&&!!re.opened,duration:re.isGroupPhase?10:St.duration,children:He=>d.jsxs(ue,{...ee,"data-fixed":J==="fixed"||void 0,variant:$,mod:[{multiline:V},De],...re.getFloatingProps({ref:re.floating,className:pe("tooltip").className,style:{...pe("tooltip").style,...He,zIndex:_,top:re.y??0,left:re.x??0}}),children:[i,d.jsx(Xa,{ref:fe,arrowX:re.arrowX,arrowY:re.arrowY,visible:C,position:re.placement,arrowSize:M,arrowOffset:k,arrowRadius:T,arrowPosition:E,...pe("arrow")})]})})}),x.cloneElement(r,re.getReferenceProps({onClick:R,onMouseEnter:P,onMouseLeave:B,onMouseMove:t.onMouseMove,onPointerDown:t.onPointerDown,onPointerEnter:t.onPointerEnter,[o]:mt,className:Zt(w,r.props.className),...r.props}))]})});$r.classes=Ro;$r.displayName="@mantine/core/Tooltip";$r.Floating=dl;$r.Group=wf;function fx({spacing:n,verticalSpacing:e,cols:t,selector:r}){var u;const s=Xt(),o=e===void 0?n:e,i=ps({"--sg-spacing-x":Dt(xr(n)),"--sg-spacing-y":Dt(xr(o)),"--sg-cols":(u=xr(t))==null?void 0:u.toString()}),a=$n(s.breakpoints).reduce((f,h)=>(f[h]||(f[h]={}),typeof n=="object"&&n[h]!==void 0&&(f[h]["--sg-spacing-x"]=Dt(n[h])),typeof o=="object"&&o[h]!==void 0&&(f[h]["--sg-spacing-y"]=Dt(o[h])),typeof t=="object"&&t[h]!==void 0&&(f[h]["--sg-cols"]=t[h]),f),{}),c=Em($n(a),s).filter(f=>$n(a[f.value]).length>0).map(f=>({query:`(min-width: ${s.breakpoints[f.value]})`,styles:a[f.value]}));return d.jsx(Ra,{styles:i,media:c,selector:r})}function ii(n){return typeof n=="object"&&n!==null?$n(n):[]}function hx(n){return n.sort((e,t)=>Ks(e)-Ks(t))}function px({spacing:n,verticalSpacing:e,cols:t}){const r=Array.from(new Set([...ii(n),...ii(e),...ii(t)]));return hx(r)}function mx({spacing:n,verticalSpacing:e,cols:t,selector:r}){var c;const s=e===void 0?n:e,o=ps({"--sg-spacing-x":Dt(xr(n)),"--sg-spacing-y":Dt(xr(s)),"--sg-cols":(c=xr(t))==null?void 0:c.toString()}),i=px({spacing:n,verticalSpacing:e,cols:t}),a=i.reduce((u,f)=>(u[f]||(u[f]={}),typeof n=="object"&&n[f]!==void 0&&(u[f]["--sg-spacing-x"]=Dt(n[f])),typeof s=="object"&&s[f]!==void 0&&(u[f]["--sg-spacing-y"]=Dt(s[f])),typeof t=="object"&&t[f]!==void 0&&(u[f]["--sg-cols"]=t[f]),u),{}),l=i.map(u=>({query:`simple-grid (min-width: ${u})`,styles:a[u]}));return d.jsx(Ra,{styles:o,container:l,selector:r})}var kf={container:"m_925c2d2c",root:"m_2415a157"};const gx={cols:1,spacing:"md",type:"media"},fl=Ne((n,e)=>{const t=ie("SimpleGrid",gx,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,cols:c,verticalSpacing:u,spacing:f,type:h,...p}=t,m=Pe({name:"SimpleGrid",classes:kf,props:t,className:s,style:o,classNames:r,styles:i,unstyled:a,vars:l}),g=Nd();return h==="container"?d.jsxs(d.Fragment,{children:[d.jsx(mx,{...t,selector:`.${g}`}),d.jsx("div",{...m("container"),children:d.jsx(ue,{ref:e,...m("root",{className:g}),...p})})]}):d.jsxs(d.Fragment,{children:[d.jsx(fx,{...t,selector:`.${g}`}),d.jsx(ue,{ref:e,...m("root",{className:g}),...p})]})});fl.classes=kf;fl.displayName="@mantine/core/SimpleGrid";const yx={},hl=Ne((n,e)=>{const t=ie("TextInput",yx,n);return d.jsx(Io,{component:"input",ref:e,...t,__staticSelector:"TextInput"})});hl.classes=Io.classes;hl.displayName="@mantine/core/TextInput";var Cf={root:"m_d6493fad"};const xx={},pl=Ne((n,e)=>{const t=ie("TypographyStylesProvider",xx,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,...l}=t,c=Pe({name:"TypographyStylesProvider",classes:Cf,props:t,className:s,style:o,classNames:r,styles:i,unstyled:a});return d.jsx(ue,{ref:e,...c("root"),...l})});pl.classes=Cf;pl.displayName="@mantine/core/TypographyStylesProvider";function Hs(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return isNaN(r)?new Date(NaN):(r&&t.setDate(t.getDate()+r),t)}function Vs(n,e){Q(2,arguments);var t=G(n),r=Oe(e);if(isNaN(r))return new Date(NaN);if(!r)return t;var s=t.getDate(),o=new Date(t.getTime());o.setMonth(t.getMonth()+r+1,0);var i=o.getDate();return s>=i?o:(t.setFullYear(o.getFullYear(),o.getMonth(),s),t)}var bx=36e5;function vx(n,e){Q(2,arguments);var t=Oe(e);return Da(n,t*bx)}function Bn(n,e){var t,r,s,o,i,a,l,c;Q(1,arguments);var u=Ir(),f=Oe((t=(r=(s=(o=e==null?void 0:e.weekStartsOn)!==null&&o!==void 0?o:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=G(n),p=h.getDay(),m=(p<f?7:0)+p-f;return h.setDate(h.getDate()-m),h.setHours(0,0,0,0),h}function Tr(n){Q(1,arguments);var e=G(n);return e.setHours(0,0,0,0),e}var wx=864e5;function kx(n,e){Q(2,arguments);var t=Tr(n),r=Tr(e),s=t.getTime()-Ri(t),o=r.getTime()-Ri(r);return Math.round((s-o)/wx)}var Cx=6e4;function Sx(n,e){Q(2,arguments);var t=Oe(e);return Da(n,t*Cx)}function Mx(n,e){Q(2,arguments);var t=Oe(e);return Da(n,t*1e3)}function Tx(n,e){Q(2,arguments);var t=Oe(e),r=t*7;return Hs(n,r)}function Pc(n,e){Q(2,arguments);var t=Oe(e);return Vs(n,t*12)}function Xr(n,e){Q(2,arguments);var t=G(n),r=G(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}var jo=6e4,Lo=36e5,Dx=1e3;function Ex(n,e){Q(2,arguments);var t=Tr(n),r=Tr(e);return t.getTime()===r.getTime()}function Ox(n,e){Q(2,arguments);var t=G(n),r=G(e),s=t.getFullYear()-r.getFullYear(),o=t.getMonth()-r.getMonth();return s*12+o}function Nx(n,e){Q(2,arguments);var t=G(n),r=G(e);return t.getFullYear()-r.getFullYear()}function Ac(n,e){var t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function Sf(n,e){Q(2,arguments);var t=G(n),r=G(e),s=Ac(t,r),o=Math.abs(kx(t,r));t.setDate(t.getDate()-s*o);var i=+(Ac(t,r)===-s),a=s*(o-i);return a===0?0:a}function Fo(n,e){return Q(2,arguments),G(n).getTime()-G(e).getTime()}var Rc={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},Ix="trunc";function xs(n){return n?Rc[n]:Rc[Ix]}function Px(n,e,t){Q(2,arguments);var r=Fo(n,e)/Lo;return xs(t==null?void 0:t.roundingMethod)(r)}function Ax(n,e,t){Q(2,arguments);var r=Fo(n,e)/jo;return xs(t==null?void 0:t.roundingMethod)(r)}function ea(n){Q(1,arguments);var e=G(n);return e.setHours(23,59,59,999),e}function ta(n){Q(1,arguments);var e=G(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Rx(n){Q(1,arguments);var e=G(n);return ea(e).getTime()===ta(e).getTime()}function Mf(n,e){Q(2,arguments);var t=G(n),r=G(e),s=Xr(t,r),o=Math.abs(Ox(t,r)),i;if(o<1)i=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*o);var a=Xr(t,r)===-s;Rx(G(n))&&o===1&&Xr(n,r)===1&&(a=!1),i=s*(o-Number(a))}return i===0?0:i}function jx(n,e,t){Q(2,arguments);var r=Mf(n,e)/3;return xs(t==null?void 0:t.roundingMethod)(r)}function Lx(n,e,t){Q(2,arguments);var r=Fo(n,e)/1e3;return xs(t==null?void 0:t.roundingMethod)(r)}function Fx(n,e,t){Q(2,arguments);var r=Sf(n,e)/7;return xs(t==null?void 0:t.roundingMethod)(r)}function $x(n,e){Q(2,arguments);var t=G(n),r=G(e),s=Xr(t,r),o=Math.abs(Nx(t,r));t.setFullYear(1584),r.setFullYear(1584);var i=Xr(t,r)===-s,a=s*(o-Number(i));return a===0?0:a}function Bx(n,e){var t;Q(1,arguments);var r=n||{},s=G(r.start),o=G(r.end),i=o.getTime();if(!(s.getTime()<=i))throw new RangeError("Invalid interval");var a=[],l=s;l.setHours(0,0,0,0);var c=Number((t=e==null?void 0:e.step)!==null&&t!==void 0?t:1);if(c<1||isNaN(c))throw new RangeError("`options.step` must be a number greater than 1");for(;l.getTime()<=i;)a.push(G(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return a}function jc(n){Q(1,arguments);var e=G(n);return e.setDate(1),e.setHours(0,0,0,0),e}function ai(n){Q(1,arguments);var e=G(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function Ts(n){Q(1,arguments);var e=G(n),t=new Date(0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function li(n,e){var t,r,s,o,i,a,l,c;Q(1,arguments);var u=Ir(),f=Oe((t=(r=(s=(o=e==null?void 0:e.weekStartsOn)!==null&&o!==void 0?o:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=G(n),p=h.getDay(),m=(p<f?-7:0)+6-(p-f);return h.setDate(h.getDate()+m),h.setHours(23,59,59,999),h}function _x(n,e){if(n==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function zx(n,e){var t,r;Q(1,arguments);var s=G(n);if(isNaN(s.getTime()))throw new RangeError("Invalid time value");var o=String((t=e==null?void 0:e.format)!==null&&t!==void 0?t:"extended"),i=String((r=e==null?void 0:e.representation)!==null&&r!==void 0?r:"complete");if(o!=="extended"&&o!=="basic")throw new RangeError("format must be 'extended' or 'basic'");if(i!=="date"&&i!=="time"&&i!=="complete")throw new RangeError("representation must be 'date', 'time', or 'complete'");var a="",l="",c=o==="extended"?"-":"",u=o==="extended"?":":"";if(i!=="time"){var f=nn(s.getDate(),2),h=nn(s.getMonth()+1,2),p=nn(s.getFullYear(),4);a="".concat(p).concat(c).concat(h).concat(c).concat(f)}if(i!=="date"){var m=s.getTimezoneOffset();if(m!==0){var g=Math.abs(m),y=nn(Math.floor(g/60),2),b=nn(g%60,2),v=m<0?"+":"-";l="".concat(v).concat(y,":").concat(b)}else l="Z";var w=nn(s.getHours(),2),C=nn(s.getMinutes(),2),M=nn(s.getSeconds(),2),k=a===""?"":"T",T=[w,C,M].join(u);a="".concat(a).concat(k).concat(T).concat(l)}return a}function Hx(n){Q(1,arguments);var e=G(n),t=e.getDate();return t}function Tf(n){Q(1,arguments);var e=G(n),t=e.getFullYear(),r=e.getMonth(),s=new Date(0);return s.setFullYear(t,r+1,0),s.setHours(0,0,0,0),s.getDate()}function Vx(n){Q(1,arguments);var e=G(n),t=e.getHours();return t}function Wx(n){Q(1,arguments);var e=G(n),t=e.getMilliseconds();return t}function Ux(n){Q(1,arguments);var e=G(n),t=e.getMinutes();return t}function qx(n){Q(1,arguments);var e=G(n),t=e.getMonth();return t}function Yx(n){Q(1,arguments);var e=G(n),t=e.getSeconds();return t}function Kx(n,e){var t,r,s,o,i,a,l,c;Q(1,arguments);var u=G(n),f=u.getFullYear(),h=Ir(),p=Oe((t=(r=(s=(o=e==null?void 0:e.firstWeekContainsDate)!==null&&o!==void 0?o:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&s!==void 0?s:h.firstWeekContainsDate)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=new Date(0);m.setFullYear(f+1,0,p),m.setHours(0,0,0,0);var g=Bn(m,e),y=new Date(0);y.setFullYear(f,0,p),y.setHours(0,0,0,0);var b=Bn(y,e);return u.getTime()>=g.getTime()?f+1:u.getTime()>=b.getTime()?f:f-1}function Gx(n,e){var t,r,s,o,i,a,l,c;Q(1,arguments);var u=Ir(),f=Oe((t=(r=(s=(o=e==null?void 0:e.firstWeekContainsDate)!==null&&o!==void 0?o:e==null||(i=e.locale)===null||i===void 0||(a=i.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1),h=Kx(n,e),p=new Date(0);p.setFullYear(h,0,f),p.setHours(0,0,0,0);var m=Bn(p,e);return m}var Jx=6048e5;function Qx(n,e){Q(1,arguments);var t=G(n),r=Bn(t,e).getTime()-Gx(t,e).getTime();return Math.round(r/Jx)+1}function Xx(n){return Q(1,arguments),G(n).getFullYear()}function ci(n,e){Q(2,arguments);var t=G(n),r=G(e);return t.getTime()>r.getTime()}function Wr(n,e){Q(2,arguments);var t=G(n),r=G(e);return t.getTime()<r.getTime()}function Zx(n,e){Q(2,arguments);var t=G(n),r=G(e);return t.getTime()===r.getTime()}function Lc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function eb(n,e){if(n){if(typeof n=="string")return Lc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Lc(n,e)}}function Fc(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=eb(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,s=function(){};return{s,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,i=!1,a;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return o=c.done,c},e:function(c){i=!0,a=c},f:function(){try{!o&&t.return!=null&&t.return()}finally{if(i)throw a}}}}function xe(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Fp(n,e)}function eo(n){return eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eo(n)}function Df(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Df=function(){return!!n})()}function tb(n,e){if(e&&(md(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K(n)}function be(n){var e=Df();return function(){var r=eo(n),s;if(e){var o=eo(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return tb(this,s)}}function ge(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function $c(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,gd(r.key),r)}}function ye(n,e,t){return e&&$c(n.prototype,e),t&&$c(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function q(n,e,t){return e=gd(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var nb=10,Ef=function(){function n(){ge(this,n),q(this,"priority",void 0),q(this,"subPriority",0)}return ye(n,[{key:"validate",value:function(t,r){return!0}}]),n}(),rb=function(n){xe(t,n);var e=be(t);function t(r,s,o,i,a){var l;return ge(this,t),l=e.call(this),l.value=r,l.validateValue=s,l.setValue=o,l.priority=i,a&&(l.subPriority=a),l}return ye(t,[{key:"validate",value:function(s,o){return this.validateValue(s,this.value,o)}},{key:"set",value:function(s,o,i){return this.setValue(s,o,this.value,i)}}]),t}(Ef),sb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",nb),q(K(r),"subPriority",-1),r}return ye(t,[{key:"set",value:function(s,o){if(o.timestampIsSet)return s;var i=new Date(0);return i.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),i.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),i}}]),t}(Ef),Ce=function(){function n(){ge(this,n),q(this,"incompatibleTokens",void 0),q(this,"priority",void 0),q(this,"subPriority",void 0)}return ye(n,[{key:"run",value:function(t,r,s,o){var i=this.parse(t,r,s,o);return i?{setter:new rb(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}},{key:"validate",value:function(t,r,s){return!0}}]),n}(),ob=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",140),q(K(r),"incompatibleTokens",["R","u","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"G":case"GG":case"GGG":return i.era(s,{width:"abbreviated"})||i.era(s,{width:"narrow"});case"GGGGG":return i.era(s,{width:"narrow"});case"GGGG":default:return i.era(s,{width:"wide"})||i.era(s,{width:"abbreviated"})||i.era(s,{width:"narrow"})}}},{key:"set",value:function(s,o,i){return o.era=i,s.setUTCFullYear(i,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),Be={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},jt={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function _e(n,e){return n&&{value:e(n.value),rest:n.rest}}function Ae(n,e){var t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function Lt(n,e){var t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,i=t[5]?parseInt(t[5],10):0;return{value:r*(s*Lo+o*jo+i*Dx),rest:e.slice(t[0].length)}}function Of(n){return Ae(Be.anyDigitsSigned,n)}function Fe(n,e){switch(n){case 1:return Ae(Be.singleDigit,e);case 2:return Ae(Be.twoDigits,e);case 3:return Ae(Be.threeDigits,e);case 4:return Ae(Be.fourDigits,e);default:return Ae(new RegExp("^\\d{1,"+n+"}"),e)}}function to(n,e){switch(n){case 1:return Ae(Be.singleDigitSigned,e);case 2:return Ae(Be.twoDigitsSigned,e);case 3:return Ae(Be.threeDigitsSigned,e);case 4:return Ae(Be.fourDigitsSigned,e);default:return Ae(new RegExp("^-?\\d{1,"+n+"}"),e)}}function ml(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Nf(n,e){var t=e>0,r=t?e:1-e,s;if(r<=50)s=n||100;else{var o=r+50,i=Math.floor(o/100)*100,a=n>=o%100;s=n+i-(a?100:0)}return t?s:1-s}function If(n){return n%400===0||n%4===0&&n%100!==0}var ib=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",130),q(K(r),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){var a=function(c){return{year:c,isTwoDigitYear:o==="yy"}};switch(o){case"y":return _e(Fe(4,s),a);case"yo":return _e(i.ordinalNumber(s,{unit:"year"}),a);default:return _e(Fe(o.length,s),a)}}},{key:"validate",value:function(s,o){return o.isTwoDigitYear||o.year>0}},{key:"set",value:function(s,o,i){var a=s.getUTCFullYear();if(i.isTwoDigitYear){var l=Nf(i.year,a);return s.setUTCFullYear(l,0,1),s.setUTCHours(0,0,0,0),s}var c=!("era"in o)||o.era===1?i.year:1-i.year;return s.setUTCFullYear(c,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),ab=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",130),q(K(r),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){var a=function(c){return{year:c,isTwoDigitYear:o==="YY"}};switch(o){case"Y":return _e(Fe(4,s),a);case"Yo":return _e(i.ordinalNumber(s,{unit:"year"}),a);default:return _e(Fe(o.length,s),a)}}},{key:"validate",value:function(s,o){return o.isTwoDigitYear||o.year>0}},{key:"set",value:function(s,o,i,a){var l=Jp(s,a);if(i.isTwoDigitYear){var c=Nf(i.year,l);return s.setUTCFullYear(c,0,a.firstWeekContainsDate),s.setUTCHours(0,0,0,0),ji(s,a)}var u=!("era"in o)||o.era===1?i.year:1-i.year;return s.setUTCFullYear(u,0,a.firstWeekContainsDate),s.setUTCHours(0,0,0,0),ji(s,a)}}]),t}(Ce),lb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",130),q(K(r),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o){return to(o==="R"?4:o.length,s)}},{key:"set",value:function(s,o,i){var a=new Date(0);return a.setUTCFullYear(i,0,4),a.setUTCHours(0,0,0,0),dd(a)}}]),t}(Ce),cb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",130),q(K(r),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o){return to(o==="u"?4:o.length,s)}},{key:"set",value:function(s,o,i){return s.setUTCFullYear(i,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),ub=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",120),q(K(r),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"Q":case"QQ":return Fe(o.length,s);case"Qo":return i.ordinalNumber(s,{unit:"quarter"});case"QQQ":return i.quarter(s,{width:"abbreviated",context:"formatting"})||i.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(s,{width:"wide",context:"formatting"})||i.quarter(s,{width:"abbreviated",context:"formatting"})||i.quarter(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,o){return o>=1&&o<=4}},{key:"set",value:function(s,o,i){return s.setUTCMonth((i-1)*3,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),db=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",120),q(K(r),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"q":case"qq":return Fe(o.length,s);case"qo":return i.ordinalNumber(s,{unit:"quarter"});case"qqq":return i.quarter(s,{width:"abbreviated",context:"standalone"})||i.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(s,{width:"wide",context:"standalone"})||i.quarter(s,{width:"abbreviated",context:"standalone"})||i.quarter(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,o){return o>=1&&o<=4}},{key:"set",value:function(s,o,i){return s.setUTCMonth((i-1)*3,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),fb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),q(K(r),"priority",110),r}return ye(t,[{key:"parse",value:function(s,o,i){var a=function(c){return c-1};switch(o){case"M":return _e(Ae(Be.month,s),a);case"MM":return _e(Fe(2,s),a);case"Mo":return _e(i.ordinalNumber(s,{unit:"month"}),a);case"MMM":return i.month(s,{width:"abbreviated",context:"formatting"})||i.month(s,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(s,{width:"wide",context:"formatting"})||i.month(s,{width:"abbreviated",context:"formatting"})||i.month(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,o){return o>=0&&o<=11}},{key:"set",value:function(s,o,i){return s.setUTCMonth(i,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),hb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",110),q(K(r),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){var a=function(c){return c-1};switch(o){case"L":return _e(Ae(Be.month,s),a);case"LL":return _e(Fe(2,s),a);case"Lo":return _e(i.ordinalNumber(s,{unit:"month"}),a);case"LLL":return i.month(s,{width:"abbreviated",context:"standalone"})||i.month(s,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(s,{width:"wide",context:"standalone"})||i.month(s,{width:"abbreviated",context:"standalone"})||i.month(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,o){return o>=0&&o<=11}},{key:"set",value:function(s,o,i){return s.setUTCMonth(i,1),s.setUTCHours(0,0,0,0),s}}]),t}(Ce);function pb(n,e,t){Q(2,arguments);var r=G(n),s=Oe(e),o=Qp(r,t)-s;return r.setUTCDate(r.getUTCDate()-o*7),r}var mb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",100),q(K(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"w":return Ae(Be.week,s);case"wo":return i.ordinalNumber(s,{unit:"week"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=1&&o<=53}},{key:"set",value:function(s,o,i,a){return ji(pb(s,i,a),a)}}]),t}(Ce);function gb(n,e){Q(2,arguments);var t=G(n),r=Oe(e),s=Xp(t)-r;return t.setUTCDate(t.getUTCDate()-s*7),t}var yb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",100),q(K(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"I":return Ae(Be.week,s);case"Io":return i.ordinalNumber(s,{unit:"week"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=1&&o<=53}},{key:"set",value:function(s,o,i){return dd(gb(s,i))}}]),t}(Ce),xb=[31,28,31,30,31,30,31,31,30,31,30,31],bb=[31,29,31,30,31,30,31,31,30,31,30,31],vb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",90),q(K(r),"subPriority",1),q(K(r),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"d":return Ae(Be.date,s);case"do":return i.ordinalNumber(s,{unit:"date"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){var i=s.getUTCFullYear(),a=If(i),l=s.getUTCMonth();return a?o>=1&&o<=bb[l]:o>=1&&o<=xb[l]}},{key:"set",value:function(s,o,i){return s.setUTCDate(i),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),wb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",90),q(K(r),"subpriority",1),q(K(r),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"D":case"DD":return Ae(Be.dayOfYear,s);case"Do":return i.ordinalNumber(s,{unit:"date"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){var i=s.getUTCFullYear(),a=If(i);return a?o>=1&&o<=366:o>=1&&o<=365}},{key:"set",value:function(s,o,i){return s.setUTCMonth(0,i),s.setUTCHours(0,0,0,0),s}}]),t}(Ce);function gl(n,e,t){var r,s,o,i,a,l,c,u;Q(2,arguments);var f=Ir(),h=Oe((r=(s=(o=(i=t==null?void 0:t.weekStartsOn)!==null&&i!==void 0?i:t==null||(a=t.locale)===null||a===void 0||(l=a.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&o!==void 0?o:f.weekStartsOn)!==null&&s!==void 0?s:(c=f.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=G(n),m=Oe(e),g=p.getUTCDay(),y=m%7,b=(y+7)%7,v=(b<h?7:0)+m-g;return p.setUTCDate(p.getUTCDate()+v),p}var kb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",90),q(K(r),"incompatibleTokens",["D","i","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"E":case"EE":case"EEE":return i.day(s,{width:"abbreviated",context:"formatting"})||i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(s,{width:"wide",context:"formatting"})||i.day(s,{width:"abbreviated",context:"formatting"})||i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,o){return o>=0&&o<=6}},{key:"set",value:function(s,o,i,a){return s=gl(s,i,a),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),Cb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",90),q(K(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i,a){var l=function(u){var f=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+f};switch(o){case"e":case"ee":return _e(Fe(o.length,s),l);case"eo":return _e(i.ordinalNumber(s,{unit:"day"}),l);case"eee":return i.day(s,{width:"abbreviated",context:"formatting"})||i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"});case"eeeee":return i.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(s,{width:"wide",context:"formatting"})||i.day(s,{width:"abbreviated",context:"formatting"})||i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,o){return o>=0&&o<=6}},{key:"set",value:function(s,o,i,a){return s=gl(s,i,a),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),Sb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",90),q(K(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i,a){var l=function(u){var f=Math.floor((u-1)/7)*7;return(u+a.weekStartsOn+6)%7+f};switch(o){case"c":case"cc":return _e(Fe(o.length,s),l);case"co":return _e(i.ordinalNumber(s,{unit:"day"}),l);case"ccc":return i.day(s,{width:"abbreviated",context:"standalone"})||i.day(s,{width:"short",context:"standalone"})||i.day(s,{width:"narrow",context:"standalone"});case"ccccc":return i.day(s,{width:"narrow",context:"standalone"});case"cccccc":return i.day(s,{width:"short",context:"standalone"})||i.day(s,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(s,{width:"wide",context:"standalone"})||i.day(s,{width:"abbreviated",context:"standalone"})||i.day(s,{width:"short",context:"standalone"})||i.day(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,o){return o>=0&&o<=6}},{key:"set",value:function(s,o,i,a){return s=gl(s,i,a),s.setUTCHours(0,0,0,0),s}}]),t}(Ce);function Mb(n,e){Q(2,arguments);var t=Oe(e);t%7===0&&(t=t-7);var r=1,s=G(n),o=s.getUTCDay(),i=t%7,a=(i+7)%7,l=(a<r?7:0)+t-o;return s.setUTCDate(s.getUTCDate()+l),s}var Tb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",90),q(K(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){var a=function(c){return c===0?7:c};switch(o){case"i":case"ii":return Fe(o.length,s);case"io":return i.ordinalNumber(s,{unit:"day"});case"iii":return _e(i.day(s,{width:"abbreviated",context:"formatting"})||i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"}),a);case"iiiii":return _e(i.day(s,{width:"narrow",context:"formatting"}),a);case"iiiiii":return _e(i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"}),a);case"iiii":default:return _e(i.day(s,{width:"wide",context:"formatting"})||i.day(s,{width:"abbreviated",context:"formatting"})||i.day(s,{width:"short",context:"formatting"})||i.day(s,{width:"narrow",context:"formatting"}),a)}}},{key:"validate",value:function(s,o){return o>=1&&o<=7}},{key:"set",value:function(s,o,i){return s=Mb(s,i),s.setUTCHours(0,0,0,0),s}}]),t}(Ce),Db=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",80),q(K(r),"incompatibleTokens",["b","B","H","k","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"a":case"aa":case"aaa":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"})||i.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})||i.dayPeriod(s,{width:"abbreviated",context:"formatting"})||i.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,o,i){return s.setUTCHours(ml(i),0,0,0),s}}]),t}(Ce),Eb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",80),q(K(r),"incompatibleTokens",["a","B","H","k","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"b":case"bb":case"bbb":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"})||i.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})||i.dayPeriod(s,{width:"abbreviated",context:"formatting"})||i.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,o,i){return s.setUTCHours(ml(i),0,0,0),s}}]),t}(Ce),Ob=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",80),q(K(r),"incompatibleTokens",["a","b","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"B":case"BB":case"BBB":return i.dayPeriod(s,{width:"abbreviated",context:"formatting"})||i.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(s,{width:"wide",context:"formatting"})||i.dayPeriod(s,{width:"abbreviated",context:"formatting"})||i.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,o,i){return s.setUTCHours(ml(i),0,0,0),s}}]),t}(Ce),Nb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",70),q(K(r),"incompatibleTokens",["H","K","k","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"h":return Ae(Be.hour12h,s);case"ho":return i.ordinalNumber(s,{unit:"hour"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=1&&o<=12}},{key:"set",value:function(s,o,i){var a=s.getUTCHours()>=12;return a&&i<12?s.setUTCHours(i+12,0,0,0):!a&&i===12?s.setUTCHours(0,0,0,0):s.setUTCHours(i,0,0,0),s}}]),t}(Ce),Ib=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",70),q(K(r),"incompatibleTokens",["a","b","h","K","k","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"H":return Ae(Be.hour23h,s);case"Ho":return i.ordinalNumber(s,{unit:"hour"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=0&&o<=23}},{key:"set",value:function(s,o,i){return s.setUTCHours(i,0,0,0),s}}]),t}(Ce),Pb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",70),q(K(r),"incompatibleTokens",["h","H","k","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"K":return Ae(Be.hour11h,s);case"Ko":return i.ordinalNumber(s,{unit:"hour"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=0&&o<=11}},{key:"set",value:function(s,o,i){var a=s.getUTCHours()>=12;return a&&i<12?s.setUTCHours(i+12,0,0,0):s.setUTCHours(i,0,0,0),s}}]),t}(Ce),Ab=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",70),q(K(r),"incompatibleTokens",["a","b","h","H","K","t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"k":return Ae(Be.hour24h,s);case"ko":return i.ordinalNumber(s,{unit:"hour"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=1&&o<=24}},{key:"set",value:function(s,o,i){var a=i<=24?i%24:i;return s.setUTCHours(a,0,0,0),s}}]),t}(Ce),Rb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",60),q(K(r),"incompatibleTokens",["t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"m":return Ae(Be.minute,s);case"mo":return i.ordinalNumber(s,{unit:"minute"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=0&&o<=59}},{key:"set",value:function(s,o,i){return s.setUTCMinutes(i,0,0),s}}]),t}(Ce),jb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",50),q(K(r),"incompatibleTokens",["t","T"]),r}return ye(t,[{key:"parse",value:function(s,o,i){switch(o){case"s":return Ae(Be.second,s);case"so":return i.ordinalNumber(s,{unit:"second"});default:return Fe(o.length,s)}}},{key:"validate",value:function(s,o){return o>=0&&o<=59}},{key:"set",value:function(s,o,i){return s.setUTCSeconds(i,0),s}}]),t}(Ce),Lb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",30),q(K(r),"incompatibleTokens",["t","T"]),r}return ye(t,[{key:"parse",value:function(s,o){var i=function(l){return Math.floor(l*Math.pow(10,-o.length+3))};return _e(Fe(o.length,s),i)}},{key:"set",value:function(s,o,i){return s.setUTCMilliseconds(i),s}}]),t}(Ce),Fb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",10),q(K(r),"incompatibleTokens",["t","T","x"]),r}return ye(t,[{key:"parse",value:function(s,o){switch(o){case"X":return Lt(jt.basicOptionalMinutes,s);case"XX":return Lt(jt.basic,s);case"XXXX":return Lt(jt.basicOptionalSeconds,s);case"XXXXX":return Lt(jt.extendedOptionalSeconds,s);case"XXX":default:return Lt(jt.extended,s)}}},{key:"set",value:function(s,o,i){return o.timestampIsSet?s:new Date(s.getTime()-i)}}]),t}(Ce),$b=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",10),q(K(r),"incompatibleTokens",["t","T","X"]),r}return ye(t,[{key:"parse",value:function(s,o){switch(o){case"x":return Lt(jt.basicOptionalMinutes,s);case"xx":return Lt(jt.basic,s);case"xxxx":return Lt(jt.basicOptionalSeconds,s);case"xxxxx":return Lt(jt.extendedOptionalSeconds,s);case"xxx":default:return Lt(jt.extended,s)}}},{key:"set",value:function(s,o,i){return o.timestampIsSet?s:new Date(s.getTime()-i)}}]),t}(Ce),Bb=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",40),q(K(r),"incompatibleTokens","*"),r}return ye(t,[{key:"parse",value:function(s){return Of(s)}},{key:"set",value:function(s,o,i){return[new Date(i*1e3),{timestampIsSet:!0}]}}]),t}(Ce),_b=function(n){xe(t,n);var e=be(t);function t(){var r;ge(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),q(K(r),"priority",20),q(K(r),"incompatibleTokens","*"),r}return ye(t,[{key:"parse",value:function(s){return Of(s)}},{key:"set",value:function(s,o,i){return[new Date(i),{timestampIsSet:!0}]}}]),t}(Ce),zb={G:new ob,y:new ib,Y:new ab,R:new lb,u:new cb,Q:new ub,q:new db,M:new fb,L:new hb,w:new mb,I:new yb,d:new vb,D:new wb,E:new kb,e:new Cb,c:new Sb,i:new Tb,a:new Db,b:new Eb,B:new Ob,h:new Nb,H:new Ib,K:new Pb,k:new Ab,m:new Rb,s:new jb,S:new Lb,X:new Fb,x:new $b,t:new Bb,T:new _b},Hb=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Vb=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Wb=/^'([^]*?)'?$/,Ub=/''/g,qb=/\S/,Yb=/[a-zA-Z]/;function Kb(n,e,t,r){var s,o,i,a,l,c,u,f,h,p,m,g,y,b,v,w,C,M;Q(3,arguments);var k=String(n),T=String(e),E=Ir(),I=(s=(o=r==null?void 0:r.locale)!==null&&o!==void 0?o:E.locale)!==null&&s!==void 0?s:fd;if(!I.match)throw new RangeError("locale must contain match property");var F=Oe((i=(a=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(u=r.locale)===null||u===void 0||(f=u.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&l!==void 0?l:E.firstWeekContainsDate)!==null&&a!==void 0?a:(h=E.locale)===null||h===void 0||(p=h.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(F>=1&&F<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var V=Oe((m=(g=(y=(b=r==null?void 0:r.weekStartsOn)!==null&&b!==void 0?b:r==null||(v=r.locale)===null||v===void 0||(w=v.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&y!==void 0?y:E.weekStartsOn)!==null&&g!==void 0?g:(C=E.locale)===null||C===void 0||(M=C.options)===null||M===void 0?void 0:M.weekStartsOn)!==null&&m!==void 0?m:0);if(!(V>=0&&V<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(T==="")return k===""?G(t):new Date(NaN);var W={firstWeekContainsDate:F,weekStartsOn:V,locale:I},_=[new sb],D=T.match(Vb).map(function(fe){var re=fe[0];if(re in Yl){var pe=Yl[re];return pe(fe,I.formatLong)}return fe}).join("").match(Hb),A=[],R=Fc(D),P;try{var B=function(){var re=P.value;!(r!=null&&r.useAdditionalWeekYearTokens)&&Zp(re)&&Kl(re,T,n),!(r!=null&&r.useAdditionalDayOfYearTokens)&&em(re)&&Kl(re,T,n);var pe=re[0],mt=zb[pe];if(mt){var St=mt.incompatibleTokens;if(Array.isArray(St)){var He=A.find(function(tn){return St.includes(tn.token)||tn.token===pe});if(He)throw new RangeError("The format string mustn't contain `".concat(He.fullToken,"` and `").concat(re,"` at the same time"))}else if(mt.incompatibleTokens==="*"&&A.length>0)throw new RangeError("The format string mustn't contain `".concat(re,"` and any other token at the same time"));A.push({token:pe,fullToken:re});var je=mt.run(k,re,I.match,W);if(!je)return{v:new Date(NaN)};_.push(je.setter),k=je.rest}else{if(pe.match(Yb))throw new RangeError("Format string contains an unescaped latin alphabet character `"+pe+"`");if(re==="''"?re="'":pe==="'"&&(re=Gb(re)),k.indexOf(re)===0)k=k.slice(re.length);else return{v:new Date(NaN)}}};for(R.s();!(P=R.n()).done;){var Y=B();if(md(Y)==="object")return Y.v}}catch(fe){R.e(fe)}finally{R.f()}if(k.length>0&&qb.test(k))return new Date(NaN);var $=_.map(function(fe){return fe.priority}).sort(function(fe,re){return re-fe}).filter(function(fe,re,pe){return pe.indexOf(fe)===re}).map(function(fe){return _.filter(function(re){return re.priority===fe}).sort(function(re,pe){return pe.subPriority-re.subPriority})}).map(function(fe){return fe[0]}),O=G(t);if(isNaN(O.getTime()))return new Date(NaN);var ae=tm(O,Ri(O)),ve={},De=Fc($),J;try{for(De.s();!(J=De.n()).done;){var ee=J.value;if(!ee.validate(ae,W))return new Date(NaN);var oe=ee.set(ae,ve,W);Array.isArray(oe)?(ae=oe[0],_x(ve,oe[1])):ae=oe}}catch(fe){De.e(fe)}finally{De.f()}return ae}function Gb(n){return n.match(Wb)[1].replace(Ub,"'")}function Bc(n){Q(1,arguments);var e=G(n);return e.setMinutes(0,0,0),e}function Jb(n,e){Q(2,arguments);var t=Bc(n),r=Bc(e);return t.getTime()===r.getTime()}function Qb(n,e){Q(2,arguments);var t=G(n),r=G(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function Xb(n,e){Q(2,arguments);var t=G(n),r=G(e);return t.getFullYear()===r.getFullYear()}function Zb(n,e){Q(2,arguments);var t=G(n).getTime(),r=G(e.start).getTime(),s=G(e.end).getTime();if(!(r<=s))throw new RangeError("Invalid interval");return t>=r&&t<=s}function ev(n,e){var t;Q(1,arguments);var r=Oe((t=e==null?void 0:e.additionalDigits)!==null&&t!==void 0?t:2);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof n=="string"||Object.prototype.toString.call(n)==="[object String]"))return new Date(NaN);var s=sv(n),o;if(s.date){var i=ov(s.date,r);o=iv(i.restDateString,i.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);var a=o.getTime(),l=0,c;if(s.time&&(l=av(s.time),isNaN(l)))return new Date(NaN);if(s.timezone){if(c=lv(s.timezone),isNaN(c))return new Date(NaN)}else{var u=new Date(a+l),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(a+l+c)}var Ds={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},tv=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,nv=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,rv=/^([+-])(\d{2})(?::?(\d{2}))?$/;function sv(n){var e={},t=n.split(Ds.dateTimeDelimiter),r;if(t.length>2)return e;if(/:/.test(t[0])?r=t[0]:(e.date=t[0],r=t[1],Ds.timeZoneDelimiter.test(e.date)&&(e.date=n.split(Ds.timeZoneDelimiter)[0],r=n.substr(e.date.length,n.length))),r){var s=Ds.timezone.exec(r);s?(e.time=r.replace(s[1],""),e.timezone=s[1]):e.time=r}return e}function ov(n,e){var t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=n.match(t);if(!r)return{year:NaN,restDateString:""};var s=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?s:o*100,restDateString:n.slice((r[1]||r[2]).length)}}function iv(n,e){if(e===null)return new Date(NaN);var t=n.match(tv);if(!t)return new Date(NaN);var r=!!t[4],s=Ur(t[1]),o=Ur(t[2])-1,i=Ur(t[3]),a=Ur(t[4]),l=Ur(t[5])-1;if(r)return hv(e,a,l)?cv(e,a,l):new Date(NaN);var c=new Date(0);return!dv(e,o,i)||!fv(e,s)?new Date(NaN):(c.setUTCFullYear(e,o,Math.max(s,i)),c)}function Ur(n){return n?parseInt(n):1}function av(n){var e=n.match(nv);if(!e)return NaN;var t=ui(e[1]),r=ui(e[2]),s=ui(e[3]);return pv(t,r,s)?t*Lo+r*jo+s*1e3:NaN}function ui(n){return n&&parseFloat(n.replace(",","."))||0}function lv(n){if(n==="Z")return 0;var e=n.match(rv);if(!e)return 0;var t=e[1]==="+"?-1:1,r=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return mv(r,s)?t*(r*Lo+s*jo):NaN}function cv(n,e,t){var r=new Date(0);r.setUTCFullYear(n,0,4);var s=r.getUTCDay()||7,o=(e-1)*7+t+1-s;return r.setUTCDate(r.getUTCDate()+o),r}var uv=[31,null,31,30,31,30,31,31,30,31,30,31];function Pf(n){return n%400===0||n%4===0&&n%100!==0}function dv(n,e,t){return e>=0&&e<=11&&t>=1&&t<=(uv[e]||(Pf(n)?29:28))}function fv(n,e){return e>=1&&e<=(Pf(n)?366:365)}function hv(n,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function pv(n,e,t){return n===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&n>=0&&n<25}function mv(n,e){return e>=0&&e<=59}function gv(n,e){Q(2,arguments);var t=G(n),r=Oe(e),s=t.getFullYear(),o=t.getDate(),i=new Date(0);i.setFullYear(s,r,15),i.setHours(0,0,0,0);var a=Tf(i);return t.setMonth(r,Math.min(o,a)),t}function yv(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return t.setDate(r),t}function xv(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return t.setHours(r),t}function bv(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return t.setMilliseconds(r),t}function vv(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return t.setMinutes(r),t}function wv(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return t.setSeconds(r),t}function kv(n,e){Q(2,arguments);var t=G(n),r=Oe(e);return isNaN(t.getTime())?new Date(NaN):(t.setFullYear(r),t)}const Cv=n=>{const[e,t]=x.useState(!0),[r,s]=x.useState(null),[o,i]=x.useState(null);return x.useEffect(()=>{n&&(async()=>{t(!0);try{const c=await Li(`/api/invoice/${n}`);s(c.invoice)}catch(c){console.error("Error fetching invoice:",c),i(c.message),ql({open:!0,message:"Error fetching invoice data.",variant:"alert",alert:{color:"error"},close:!1})}finally{t(!1)}})()},[n]),{loading:e,invoiceData:r,error:o,refetchInvoiceData:async()=>{try{t(!0);const l=await Li(`/api/invoice/${n}`);s(l.invoice),t(!1)}catch(l){console.error("Error refetching invoice:",l),i(l.message),ql({open:!0,message:"Error refetching invoice data.",variant:"alert",alert:{color:"error"},close:!1}),t(!1)}}}},Af=({client:n,invoiceData:e})=>{if(!n)return null;const t=e.date?Jr(new Date(e.date),"yyyy/MM/dd"):"",r=(s,o,i=!0)=>d.jsx(we,{fullWidth:i,value:o||"",label:s,variant:"outlined",sx:{"& .MuiInputBase-inputSizeSmall":{fontSize:"medium"},"& .MuiInputLabel-root":{fontSize:"1rem",color:o?"black":"#2196f3"},"& .MuiOutlinedInput-input.Mui-disabled":{WebkitTextFillColor:"#4C9EF5"}},disabled:!0,size:"small"});return d.jsx($e,{children:d.jsx(H,{container:!0,spacing:$p,children:d.jsx(H,{item:!0,xs:12,children:d.jsxs($e,{sx:{border:"1px solid #ccc",p:2,borderRadius:1,mb:2},children:[d.jsx($e,{sx:{fontWeight:"bold",mb:1,backgroundColor:"#ede7f66b",p:1,borderRadius:"4px"},children:"المعلومات"}),d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:3,children:r("رقم المرجع",e.reference_number)}),d.jsx(H,{item:!0,xs:3,children:r("تاريخ الفاتورة",t)}),d.jsx(H,{item:!0,xs:3,children:r("حالة الفاتورة",e.status)}),d.jsx(H,{item:!0,xs:3,children:r("حالة الدفع",e.paymentStatus)}),d.jsx(H,{item:!0,xs:8,children:r("العنوان",n.address)}),d.jsx(H,{item:!0,xs:4,children:r("الرقم الضريبي",n.vat)})]})]})})})})};Af.propTypes={client:se.shape({id:se.string,name:se.string,email:se.string,phone:se.string,location:se.string,category:se.string}),invoiceData:se.shape({invoice_id:se.string,date:se.oneOfType([se.string,se.instanceOf(Date)]),MobileNumber:se.string,status:se.string,paymentStatus:se.string})};const Rf=({invoiceData:n,orderTypeConfig:e,setShowStores:t,showStores:r})=>{const{control:s,setValue:o,formState:{errors:i}}=hd(),[a,l]=x.useState(null),[c,u]=x.useState(null),f=x.useCallback(async m=>{try{const g=await Li(`/api/client/${m}`);l(g),o("ClientID",g.ClientID),o("customerName",g.name),o("customerPhone",g.phone),o("customerAddress",g.address)}catch(g){console.error("Error fetching client data:",g)}},[o]),h=x.useCallback(m=>{m?(console.log("Selected client:",m),o("ClientID",m.ID),o("customerName",m.Name),e.settings.showClient&&f(m.ID)):(console.log("No client selected"),o("ClientID",null),o("customerName",""),o("customerEmail",""),o("customerPhone",""),o("customerAddress",""),l(null))},[o,f]),p=x.useCallback(({field:m,label:g,placeholder:y})=>d.jsx(we,{...m,size:"small",label:g,placeholder:y,fullWidth:!0,sx:{"& .MuiInputBase-inputSizeSmall":{fontSize:"medium"},"& .MuiInputLabel-root":{fontSize:"1rem",color:"black"}},InputLabelProps:{style:{fontSize:"1rem",color:"black"}}}),[]);return x.useMemo(()=>{n&&(console.log("invoiceData",n),u({ID:n.FTStore,Name:n.FTStoreName}),e.settings.showClient&&f(n.ClientID))},[n,f]),d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:12,md:3,children:d.jsx($e,{sx:{border:"0px solid #ccc",p:0,borderRadius:1,mb:2},children:d.jsxs(H,{container:!0,spacing:2,children:[e.settings.showClient&&d.jsxs(d.Fragment,{children:[d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"ClientID",control:s,render:({field:m})=>d.jsx($i,{...m,placeholder:" بحث عن "+e.settings.clientType,noOptionsText:"لا يوجد نتائج",onOptionSelect:h,value:a?{ID:a.ClientID,Name:a.name}:null,type:"Supplier"})})}),e.settings.isSupplier&&d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"SupplierInvoiceNumber",control:s,render:({field:m})=>p({field:m,label:"رقم فاتورة المورد",placeholder:"ادخل رقم فاتورة المورد"})})})]}),e.settings.showStore&&d.jsxs(H,{item:!0,xs:12,children:[d.jsx(ke,{name:"FTStore",control:s,render:({field:m})=>d.jsxs(d.Fragment,{children:[!r&&d.jsx($i,{...m,onOptionSelect:g=>{u(g),m.onChange(g.ID)},placeholder:"بحث عن موقع",type:"Store",LoadAllData:!0,value:c}),e.settings.showMultipleStores&&d.jsx(Sr,{size:"small",onClick:()=>t(!r),color:"primary",tabIndex:-1,children:d.jsx("span",{style:{fontSize:"14px",fontWeight:"bold"},children:r?"موقع واحد":"مواقع متعددة"})})]})}),i.store&&d.jsx(cm,{error:!0,children:i.store.message})]})]})})}),d.jsx(H,{item:!0,xs:12,md:3,children:d.jsx($e,{sx:{border:"0px solid #ccc",p:0,borderRadius:1,mb:2},children:d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"Comment",control:s,render:({field:m})=>d.jsx(we,{...m,fullWidth:!0,label:"ملاحظات",multiline:!0,rows:e.settings.showClient?6:1,size:"small",placeholder:"اضف ملاحظة",sx:{"& .MuiInputBase-inputSizeSmall":{fontSize:"medium"},"& .MuiInputLabel-root":{fontSize:"1rem",color:"black"}}})})})})}),e.settings.showClient&&d.jsx(H,{item:!0,xs:12,md:6,children:d.jsx(Af,{client:a||{},invoiceData:n})})]})};Rf.propTypes={invoiceData:se.object};let On=null,ur=!1,di=null;const jf=()=>{const[,n]=x.useState(),e=x.useCallback(()=>!On&&!ur?(ur=!0,n({}),Bp().then(r=>(On=r,ur=!1,di=null,n({}),r)).catch(r=>{throw di=r,ur=!1,On=null,n({}),r})):Promise.resolve(On),[]),t=x.useCallback(()=>(On=null,e()),[e]);return!On&&!ur&&e(),{products:On,isLoading:ur,error:di,reloadProducts:t}},yl=({open:n,onClose:e,onSelect:t})=>{const{products:r,isLoading:s,error:o,reloadProducts:i}=jf(),[a,l]=x.useState(null),[c,u]=x.useState(0),f=x.useMemo(()=>[{headerName:"الباركود",field:"BarCodeNo",flex:1,filter:"agTextColumnFilter",floatingFilter:!0},{headerName:"كود المنتج",field:"Supplier_Item_ID",flex:1,filter:"agTextColumnFilter",floatingFilter:!0},{headerName:"الاسم",field:"name",flex:1,filter:"agTextColumnFilter",floatingFilter:!0},{headerName:"السعر",field:"offerPrice",flex:1,filter:"agNumberColumnFilter",floatingFilter:!0},{headerName:"المورد",field:"ClientName",flex:1,filter:"agTextColumnFilter",floatingFilter:!0},{headerName:"التصنيف",field:"CategoryName",flex:1,filter:"agTextColumnFilter",floatingFilter:!0}],[]),h=x.useMemo(()=>({sortable:!0,filter:!0,resizable:!0,floatingFilter:!0}),[]),p=x.useCallback(g=>{l(g.api)},[]),m=x.useCallback(g=>{const y=new Date().getTime();y-c>300&&(t(g.data.itemid),e(),a&&a.deselectAll()),u(y)},[t,a,c,e]);return d.jsxs(Zn,{open:n,onClose:e,maxWidth:"md",fullWidth:!0,children:[d.jsxs(tr,{children:["بحث عن منتج",d.jsx(Sr,{"aria-label":"close",onClick:e,sx:{position:"absolute",right:8,top:8,color:g=>g.palette.grey[500]},children:d.jsx(rd,{})})]}),d.jsx(er,{children:d.jsx($e,{sx:{height:"100%",width:"100%"},children:d.jsx("div",{className:"ag-theme-alpine",style:{height:350,width:"100%",direction:"rtl"},children:d.jsx(pd,{rowData:r,columnDefs:f,defaultColDef:h,pagination:!0,paginationPageSize:5,paginationPageSizeSelector:[5],onRowClicked:m,onGridReady:p,enableRtl:!0,domLayout:"autoHeight",rowSelection:"single"})})})})]})};yl.propTypes={open:se.bool.isRequired,onClose:se.func.isRequired,onSelect:se.func.isRequired};var xl={},Sv=od;Object.defineProperty(xl,"__esModule",{value:!0});var Lf=xl.default=void 0,Mv=Sv(sd()),Tv=d;Lf=xl.default=(0,Mv.default)((0,Tv.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");var bl={},Dv=od;Object.defineProperty(bl,"__esModule",{value:!0});var Ff=bl.default=void 0,Ev=Dv(sd()),Ov=d;Ff=bl.default=(0,Ev.default)((0,Ov.jsx)("path",{d:"M7.5 11C9.43 11 11 9.43 11 7.5S9.43 4 7.5 4 4 5.57 4 7.5 5.57 11 7.5 11m0-5C8.33 6 9 6.67 9 7.5S8.33 9 7.5 9 6 8.33 6 7.5 6.67 6 7.5 6M4.0025 18.5832 18.59 3.9955l1.4142 1.4143L5.4167 19.9974zM16.5 13c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5m0 5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"Percent");const Nv=({units:n=[],categories:e=[],products:t=[],onUnitChange:r,onCategoryChange:s,onMarginChange:o,onProductSelect:i,onQuantityChange:a,handleOpenPopup:l,handleAddNewRow:c,handleDeleteClick:u,handleEditClick:f,selectedRowId:h,orderTypeConfig:p})=>{const[m,g]=x.useState(""),[y,b]=x.useState(1),[v,w]=x.useState(""),[C,M]=x.useState(1),[k,T]=x.useState(!1),[E,I]=x.useState(0),[F,V]=x.useState(!1),W=x.useRef(null),_=x.useMemo(()=>m!=="",[m]);x.useMemo(()=>e,[e]);const D=x.useCallback(ee=>{ee.key==="F9"&&(ee.preventDefault(),T(!0))},[]),A=x.useCallback(ee=>{const oe=parseFloat(ee.target.value)||0;I(oe),o(oe)},[o]),R=x.useCallback(()=>{P(),V(!0),setTimeout(()=>{W.current&&(W.current.focus(),W.current.select())},0)},[]),P=()=>{const ee=new(window.AudioContext||window.webkitAudioContext),oe=ee.createOscillator(),fe=ee.createGain();oe.connect(fe),fe.connect(ee.destination),oe.type="square",oe.frequency.setValueAtTime(440,ee.currentTime),fe.gain.setValueAtTime(1,ee.currentTime),oe.start(ee.currentTime),oe.stop(ee.currentTime+.1)},B=x.useCallback(ee=>{const oe=ee.target.value;if(g(oe),ee.key==="Enter")if(ee.preventDefault(),oe.trim()==="")R();else{const fe=t.find(re=>{var pe;return((pe=re.BarCodeNo)==null?void 0:pe.toLowerCase())===oe.toLowerCase()});fe?(i(fe.itemid),g("")):R()}},[t,i,R]),Y=x.useCallback(()=>{g("")},[]),$=x.useCallback(ee=>{const oe=ee.target.value;b(oe),r(oe)},[r]),O=x.useCallback((ee,oe)=>{const fe=oe?oe.CategoryID:"";w(fe),s(fe)},[s]),ae=x.useCallback(ee=>{const oe=parseInt(ee.target.value,10);M(oe),a(oe)},[a]),ve=x.useCallback(()=>T(!0),[]),De=x.useCallback(()=>T(!1),[]),J=x.useCallback(()=>V(!1),[]);return Ee.useEffect(()=>(window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)),[D]),d.jsxs($e,{display:"flex",flexDirection:"column",gap:2,children:[d.jsx($e,{children:d.jsxs(id,{direction:"row",spacing:2,alignItems:"center",children:[d.jsx(Qe,{color:"primary",startIcon:d.jsx(_i,{}),onClick:c,children:"اضافة سطر"}),d.jsx(Qe,{color:"error",startIcon:d.jsx(hm,{}),onClick:u,disabled:h===null,children:"حذف سطر"}),p.settings.addItem&&d.jsxs(d.Fragment,{children:[d.jsx(Qe,{color:"primary",startIcon:d.jsx(_i,{}),onClick:l,children:"اضافة منتج"}),d.jsx(Qe,{color:"primary",startIcon:d.jsx(Ea,{}),onClick:f,disabled:h===null,children:"تعديل منتج"})]})]})}),d.jsxs($e,{display:"flex",flexDirection:"row",gap:2,alignItems:"center",children:[d.jsx(cn,{sx:{margin:0},children:d.jsx(we,{size:"small",variant:"outlined",placeholder:"اضف الباركود",value:m,onChange:B,onKeyDown:B,inputRef:W,InputProps:{startAdornment:d.jsx(Qr,{position:"start",onClick:ve,sx:{cursor:"pointer"},children:d.jsx(fm,{})}),endAdornment:_&&d.jsx(Qr,{position:"end",sx:{cursor:"pointer"},onClick:Y,children:d.jsx(Lf,{})})},error:F,helperText:F?"المنتج غير موجود.":""})}),d.jsx(cn,{sx:{width:"150px"},children:d.jsx(we,{label:"هامش الربح",variant:"outlined",type:"tel",value:E,onChange:A,size:"small",InputProps:{endAdornment:d.jsx(Qr,{position:"end",children:d.jsx(Ff,{})}),sx:{"& .MuiInputBase-input":{paddingLeft:"0px"}}}})}),d.jsx(cn,{sx:{width:"100px"},children:d.jsx(we,{label:"الكمية",variant:"outlined",type:"number",value:C,onChange:ae,size:"small"})}),d.jsxs(cn,{sx:{minWidth:120},children:[d.jsx(Bi,{id:"unit-select-label",children:"الوحدة"}),d.jsx(Fi,{labelId:"unit-select-label",value:y,onChange:$,label:"الوحدة",size:"small",children:n.map(ee=>d.jsx(zi,{value:ee.UnitID,children:ee.Unit_Name},ee.UnitID))})]}),d.jsx(cn,{sx:{minWidth:250},children:d.jsx($i,{onOptionSelect:O,placeholder:"ابحث عن تصنيف",type:"Category",getOptionLabel:ee=>`${ee.Name}`,LoadAllData:!0})})]}),d.jsx(yl,{open:k,onClose:De,onSelect:i}),d.jsx(ad,{open:F,autoHideDuration:3e3,onClose:J,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:d.jsx(ld,{onClose:J,severity:"error",children:"المنتج غير موجود!"})})]})},Iv=Ee.memo(Nv),$f=({open:n,onClose:e,onConfirm:t,message:r})=>d.jsxs(Zn,{open:n,onClose:e,maxWidth:"xs",fullWidth:!0,children:[d.jsx(tr,{children:"تاكيد الحذف"}),d.jsx(er,{children:d.jsx(gt,{variant:"body1",children:r})}),d.jsxs(hs,{children:[d.jsx(Qe,{onClick:e,color:"primary",children:"الغاء"}),d.jsx(Qe,{onClick:t,color:"secondary",children:"تاكيد"})]})]});$f.propTypes={open:se.bool.isRequired,onClose:se.func.isRequired,onConfirm:se.func.isRequired,message:se.string.isRequired};const Es={stores:[],categories:[],units:[],image_types:[]},Pv=()=>{const[n,e]=x.useState(Es),[t,r]=x.useState(!1),[s,o]=x.useState(null),i=x.useCallback(()=>t?Promise.resolve(n):(r(!0),o(null),lm().then(l=>(e(l||Es),r(!1),l)).catch(l=>{o(l),r(!1),e(Es),console.error("Error loading section data:",l)})),[t,n]),a=x.useCallback(()=>(e(Es),i()),[i]);return!t&&!n.categories.length&&!n.stores.length&&!n.units.length&&!n.image_types&&i(),{sectionData:n,isLoading:t,error:s,reloadSectionData:a}},Av=Ee.memo(Pr),Rv=Ee.memo(Iv),jv=Ee.memo(um),Lv=Ee.memo(dm),Fv=Ee.memo($f),vl=({orderEntries:n,onOrderEntriesChange:e,setValue:t,ClientID:r,orderTypeConfig:s,showStores:o})=>{var Ul;const[i,a]=x.useState([]),[l,c]=x.useState(),[u,f]=x.useState(""),[h,p]=x.useState(),[m,g]=x.useState(!1),[y,b]=x.useState(!1),[v,w]=x.useState(null),[C,M]=x.useState(1),[k,T]=x.useState(!1),[E,I]=x.useState(!1),[F,V]=x.useState(null),[W,_]=x.useState(null),D=x.useRef(null),A=x.useRef(1),R=x.useRef(!1),{products:P,isLoading:B,error:Y,reloadProducts:$}=jf(),{sectionData:O,isLoading:ae,error:ve,reloadSectionData:De}=Pv();x.useEffect(()=>{(async()=>{if(!R.current)try{if(!P){console.log("Product data not yet available. Retrying...");return}De();const N=n.length>0?n.map(L=>{var X;return{...L,id:A.current++,ItemID:((X=P.find(le=>le.itemid===L.ItemID))==null?void 0:X.itemid)||""}}):[{id:-1,BarCodeNo:"",Supplier_Item_ID:"",name:"",CategoryID:u||0,offerPrice:0,Cost:0,Quantity:C||1,UnitID:l||1,unitPrice:0,total:0}];a(N),e(N.filter(L=>L.id!==-1)),R.current=!0}catch(N){console.error("Error fetching data:",N)}})()},[P,De,$]),x.useEffect(()=>{const S=N=>{N.key==="F2"&&cr()};return document.addEventListener("keydown",S),()=>{document.removeEventListener("keydown",S)}},[v]);const J=x.useCallback(async S=>{const N={...S.data};if(N.BarCodeNo==="/"){const X=S.node.rowIndex,le={...N,newRowIndex:X};V(le),I(!0);return}else if(N.BarCodeNo==="0"){const X=S.node.rowIndex,le={...N,newRowIndex:X,NewItem:!0};_(le),cr();return}const L=P.find(X=>X.BarCodeNo===N.BarCodeNo);if(L){const X={...N.id===-1?{}:N,id:N.id===-1?A.current++:N.id,ItemID:L.itemid,BarCodeNo:L.BarCodeNo,Supplier_Item_ID:L.Supplier_Item_ID,name:L.name,CategoryID:L.CategoryID,offerPrice:L.offerPrice,Cost:L.Cost,ClientID:r,Quantity:N.Quantity||1,UnitID:N.UnitID||l||1,unitPrice:re(L)||0,total:L.unitPrice*(N.Quantity||1)};if(pe(le=>{const Me=le.map(ut=>ut.id===N.id?X:ut);return N.id===-1&&Me.push({id:-1,BarCodeNo:"",Supplier_Item_ID:"",name:"",CategoryID:u||"",offerPrice:0,Cost:0,Quantity:C||1,UnitID:l||1,unitPrice:0,total:0,ClientID:r}),Me}),D.current){const le=S.node.rowIndex;setTimeout(()=>{D.current.api.ensureIndexVisible(le),s.settings.editPrice?D.current.api.setFocusedCell(le,"unitPrice"):D.current.api.setFocusedCell(le,"Quantity")},0)}S.api&&S.api.refreshCells({rowNodes:[S.node],columns:["Supplier_Item_ID","name","CategoryID","Cost","offerPrice","UnitID","unitPrice","total"]})}else{const X={...N,ItemID:"",Supplier_Item_ID:"",name:"",CategoryID:"",offerPrice:0,Cost:0,unitPrice:0,total:0};pe(le=>le.map(Me=>Me.id===N.id?X:Me))}},[P,u,l,r,C]),ee=x.useCallback((S,N)=>{if(S&&S.CategoryID){pe(X=>X.map((le,Me)=>Me===N?{...le,CategoryID:S.CategoryID}:le));const L=D.current.api.getDisplayedRowAtIndex(N).data;He(L)}},[O.categories]),oe=S=>d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{children:S.displayName}),d.jsx("div",{style:{fontSize:"0.8em",color:"#666"},children:S.subText})]}),fe=x.useMemo(()=>[{headerName:"الباركود",field:"BarCodeNo",rowDrag:!0,editable:!0,cellStyle:S=>S.value&&!S.data.ItemID?{border:"1px solid #ff0000"}:null,onCellValueChanged:S=>{J(S)}},{headerName:"كود المنتج",field:"Supplier_Item_ID",editable:S=>S.data.id!==-1,cellDataType:"text",onCellValueChanged:S=>He(S.data.id)},{headerName:"الاسم",field:"name",editable:S=>S.data.id!==-1,flex:2,onCellValueChanged:S=>He(S.data.id)},...s.settings.addItem?[{headerName:"التصنيف",field:"CategoryID",editable:S=>S.data.id!==-1,flex:1.5,cellEditor:pm,cellEditorParams:S=>{const N=O.categories.find(X=>X.CategoryID===S.value);return{value:N?`${N.Name}`:"",options:O.categories,getOptionLabel:X=>`${X.Name}`,api:S.api,rowIndex:S.node.rowIndex,column:S.column,onCategoryChange:ee}},suppressKeyboardEvent:S=>S.event.key==="Enter"&&S.editing,valueFormatter:S=>{const N=O.categories.find(L=>L.CategoryID===S.value);return N?`${N.Name}`:""}},{headerName:"التكلفة",field:"Cost",editable:!1,flex:1.5,cellStyle:{color:"#1e88e5"},valueGetter:S=>{var X;const N=(S.data.unitPrice/(((X=O.units.find(le=>le.UnitID===S.data.UnitID))==null?void 0:X.Quantity)||1)).toFixed(2),L=parseFloat(N);return isNaN(L)||L===0?S.data.Cost||0:L}},{headerName:"سعر البيع",field:"offerPrice",cellDataType:"float",editable:S=>S.data.id!==-1,onCellValueChanged:S=>{let N=parseFloat(S.newValue);if(N<0&&(N=0,S.data.offerPrice=N,S.api.refreshCells({rowNodes:[S.node],columns:["offerPrice"],force:!0})),N===0){const L=parseFloat(S.data.Cost)||0,X=L*h/100+L||0;S.data.offerPrice=X.toFixed(2),pe(le=>le.map(Me=>Me.id===S.data.id?{...Me,offerPrice:X.toFixed(2)}:Me)),S.api.refreshCells({rowNodes:[S.node],force:!0})}He(S.data.id)}}]:[],{headerName:"الكمية",field:"Quantity",cellDataType:"number",editable:S=>S.data.id!==-1,valueSetter:S=>{const N=parseFloat(S.newValue);if(!s.settings.acceptNegativeQTY&&N<0?S.data.Quantity=0:S.data.Quantity=N||0,S.data.total=(S.data.unitPrice*S.data.Quantity).toFixed(2),He(S.data.id),!s.settings.editPrice){const L=S.node.rowIndex+1;D.current&&setTimeout(()=>{D.current.api.ensureIndexVisible(L),D.current.api.setFocusedCell(L,"BarCodeNo")},0)}return!0}},{headerName:"الوحدة",field:"UnitID",cellDataType:"float",editable:S=>S.data.id!==-1,valueFormatter:S=>{const N=O.units.find(L=>L.UnitID===S.value);return N?N.Unit_Name:""},cellEditor:"agSelectCellEditor",cellEditorParams:{values:O.units.map(S=>S.UnitID),formatValue:S=>{const N=O.units.find(L=>L.UnitID===S);return N?N.Unit_Name:""}},onCellValueChanged:S=>{const N=S.newValue,L=O.units.find(X=>X.UnitID===N);if(L){const X=(S.data.unitPrice/(L.Quantity||1)).toFixed(2);pe(le=>le.map(Me=>Me.id===S.data.id?{...Me,UnitID:N,Cost:X}:Me)),S.api.refreshCells({rowNodes:[S.node],columns:["UnitID","Cost","Sell"]}),He(S.data.id)}}},{headerName:"السعر",field:"unitPrice",editable:S=>S.data.id!==-1&&s.settings.editPrice,cellStyle:S=>(S.value===0||S.value===void 0)&&S.data.ItemID?{border:"1px solid #ff0000"}:null,valueGetter:S=>{const N=s.settings.price,L=parseFloat(S.data.Cost)||0,X=parseFloat(S.data.offerPrice)||0,le=parseFloat(S.data.unitPrice)||0;switch(N){case"PUPrice":return le.toFixed(2);case"SEPrice":return X.toFixed(2);case"COPrice":return L.toFixed(2);case"STPrice":return Math.min(X,L).toFixed(2);default:return le.toFixed(2)}},valueSetter:S=>{var L;let N=parseFloat(S.newValue);return(isNaN(N)||N<0)&&(N=0),S.data.unitPrice=N,S.data.Cost=(N/(((L=O.units.find(X=>X.UnitID===S.data.UnitID))==null?void 0:L.Quantity)||1)).toFixed(2),S.data.total=(N*S.data.Quantity).toFixed(2),S.api.refreshCells({rowNodes:[S.node],columns:["unitPrice","Cost","total","offerPrice"]}),He(S.data.id),!0},onCellValueChanged:S=>{if(parseFloat(S.data.offerPrice)===0){const L=parseFloat(S.data.Cost)||0,X=L*h/100+L||0;S.data.offerPrice=X.toFixed(2),pe(le=>le.map(Me=>Me.id===S.data.id?{...Me,offerPrice:X.toFixed(2)}:Me)),S.api.refreshCells({rowNodes:[S.node],force:!0})}lr();const N=S.node.rowIndex+1;D.current&&setTimeout(()=>{D.current.api.ensureIndexVisible(N),D.current.api.setFocusedCell(N,"BarCodeNo")},0),He(S.data.id)}},{headerName:"الاجمالي",field:"total",editable:!1,valueGetter:S=>(parseFloat(S.data.unitPrice||0)*parseFloat(S.data.Quantity||0)).toFixed(2),cellStyle:{color:"#1e88e5"}},...s.settings.showVat?[{headerName:"الاجمالي شامل الضريبة",field:"totalIncVat",editable:!1,headerComponent:oe,headerComponentParams:{displayName:"الاجمالي",subText:"شامل الضريبة"},valueGetter:S=>{const N=parseFloat(S.data.unitPrice||0)*parseFloat(S.data.Quantity||0);return(N+N*.15).toFixed(2)},cellStyle:{color:"#4caf50"}}]:[],...o?[{headerName:"الموقع",field:"LStoreID",cellDataType:"float",editable:S=>S.data.id!==-1,valueFormatter:S=>{const N=O.stores.find(L=>L.StoreID===S.value);return N?N.StoreName:""},cellEditor:"agSelectCellEditor",cellEditorParams:{values:O.stores.map(S=>S.StoreID),formatValue:S=>{const N=O.stores.find(L=>L.StoreID===S);return N?N.StoreName:""}},cellStyle:S=>!S.value&&S.data.ItemID?{border:"1px solid #ff0000"}:null,onCellValueChanged:S=>{const N=S.newValue;O.stores.find(X=>X.StoreID===N)&&(pe(X=>X.map(le=>le.id===S.data.id?{...le,LStoreID:N}:le)),S.api.refreshCells({rowNodes:[S.node],columns:["LStoreID"]}),He(S.data.id))}}]:[]],[J,O.categories,O.units,h,o]);function re(S){const N=parseFloat(S.Cost)||0,L=parseFloat(S.offerPrice)||0,X=parseFloat(S.unitPrice)||0;switch(s.settings.price){case"PUPrice":return X||0;case"SEPrice":return L||0;case"COPrice":return N||0;case"STPrice":return Math.min(L,N)||0;default:return X||0}}const pe=x.useCallback(S=>{a(N=>{let L;return typeof S=="function"?L=S(N):L=S,L.some(le=>le.id===-1)&&(L=L.filter((le,Me,ut)=>le.id!==-1||Me===ut.findIndex(At=>At.id===-1))),e(L),L})},[e]),mt=()=>{if(D.current&&D.current.api){const S=D.current.api,N=S.getDisplayedRowCount();S.ensureIndexVisible(N-1,"bottom")}},St=S=>{const N=P.find(L=>L.itemid===S);if(F&&S){const L={...F,BarCodeNo:N.BarCodeNo};J({data:L}),V(null),I(!1)}},He=x.useCallback(S=>{pe(N=>N.map(X=>{if(X.id===S){const le=O.units.find(Me=>Me.UnitID===X.UnitID);le&&X.unitPrice&&(X.Cost=(X.unitPrice/(le.Quantity||1)).toFixed(2)),X.total=(X.unitPrice*X.Quantity).toFixed(2)}return X}))},[O.units,t]),je=()=>{v!==null&&T(!0)},tn=()=>{pe(S=>S.filter(N=>N.id!==v)),w(null),T(!1)},zr=()=>{T(!1)},or=()=>{v!==null&&g(!0)},ir=()=>{g(!1)},ar=S=>{console.log(S),console.log(i),pe(N=>N.map(L=>L.id===v?{...L,...S,ItemID:S.ID}:L)),g(!1)},lr=()=>{if(!i.some(S=>S.id===-1)){const S={id:-1,ItemID:"",Supplier_Item_ID:"",BarCodeNo:"",name:"",CategoryID:u||"",offerPrice:0,Cost:0,Quantity:C||1,UnitID:l||1,unitPrice:0,total:0,ClientID:r};pe(N=>[...N,S])}},cr=()=>{b(!0)},ks=()=>{_(null),b(!1)},En=S=>{if(W!==null){const N={...W,...S.item};J(N);return}pe(N=>{const L=N.filter(ut=>ut.id!==-1);let X;if(S.item.name!=="0")X={id:A.current++,ItemID:S.item.ItemID,BarCodeNo:S.item.BarCodeNo,Supplier_Item_ID:S.item.ItemLookupCode,name:S.item.name,CategoryID:u||0,offerPrice:0,Cost:0,Quantity:C||1,UnitID:l||1,unitPrice:0,total:0,ClientID:r};else if(v){const ut=L.find(At=>At.id===v);if(ut)X={...ut,id:Math.min(...L.map(At=>At.id),0)-1,ItemID:S.item.ItemID,BarCodeNo:S.item.BarCodeNo,Supplier_Item_ID:S.item.ItemLookupCode};else return console.error("Selected row not found."),L}else{const ut=Math.max(...L.map(Hr=>Hr.id),0),At=L.find(Hr=>Hr.id===ut);if(At)X={...At,id:Math.min(...L.map(Hr=>Hr.id),0)-1,ItemID:S.item.ItemID,BarCodeNo:S.item.BarCodeNo,Supplier_Item_ID:S.item.ItemLookupCode,ClientID:r};else return console.error("No row found with the largest ID."),L}const le=[...L,X],Me=le.length-1;return D.current&&setTimeout(()=>{D.current.api.ensureIndexVisible(Me),s.settings.editPrice?D.current.api.setFocusedCell(Me,"unitPrice"):D.current.api.setFocusedCell(Me,"Quantity")},0),le})},Dp=(S,N)=>{const L=P.find(X=>X.itemid===S);L&&pe(X=>{const le=X.filter(At=>At.id!==-1),Me={id:A.current++,ItemID:L.itemid,Supplier_Item_ID:L.Supplier_Item_ID,BarCodeNo:L.BarCodeNo,name:L.name,CategoryID:L.CategoryID||u||0,offerPrice:L.offerPrice||0,Cost:L.Cost||0,Quantity:C||1,UnitID:l||1,unitPrice:re(L),total:(L.unitPrice||0)*(C||1),ClientID:r},ut=[...le,Me];return setTimeout(()=>{mt()},20),ut})},Ep=x.useCallback(S=>{const N=[];S.api.forEachNode(L=>{N.push(L.data)}),a(N),e(N)},[e]),Op=S=>{const N=S.api.getSelectedRows()[0];N&&w(N.id)};return d.jsxs(d.Fragment,{children:[d.jsx($e,{mb:2,style:{marginBottom:"0px",PaddingTop:"10px"},children:d.jsx(Av,{title:"ادوات اضافية",children:d.jsx(Rv,{units:O.units,onUnitChange:c,categories:O.categories,onMarginChange:p,onProductSelect:(S,N)=>Dp(S),onCategoryChange:f,onQuantityChange:M,products:P,handleOpenPopup:cr,handleAddNewRow:lr,handleDeleteClick:je,handleEditClick:or,selectedRowId:v,orderTypeConfig:s})})}),d.jsx("div",{className:"ag-theme-alpine",style:{height:300,width:"100%"},children:d.jsx(pd,{ref:D,rowData:i,columnDefs:fe,defaultColDef:{sortable:!0,flex:1,minWidth:100,filter:!0},rowSelection:"single",enableRtl:!0,onSelectionChanged:Op,deltaRowDataMode:!0,getRowNodeId:S=>S.id,suppressScrollOnNewData:!0,rowDragManaged:!0,onRowDragEnd:Ep})}),s.settings.addItem&&d.jsxs(d.Fragment,{children:[d.jsx(jv,{open:y,onClose:ks,onAddItem:En}),d.jsx(Lv,{open:m,onClose:ir,selectedSubRowId:((Ul=i.find(S=>S.id===v))==null?void 0:Ul.ItemID)||void 0,onUpdate:ar})]}),d.jsx(Fv,{open:k,onClose:zr,onConfirm:tn,message:"هل انت متأكد من حذف السطر؟"}),d.jsx(yl,{open:E,onClose:()=>I(!1),onSelect:St})]})};vl.propTypes={orderEntries:se.array,defaultUnit:se.number,defaultMargin:se.number};vl.defaultProps={orderEntries:[],defaultUnit:1,defaultMargin:0};const $v=Ee.memo(vl),Bv=({discountAmount:n,subTotal:e,setTaxAmount:t,orderTypeConfig:r})=>{const[s,o]=x.useState(!1),[i,a]=x.useState(0),[l,c]=x.useState(0),u=.15;x.useEffect(()=>{console.log("subTotal",e,"discountAmount",n);const p=parseFloat(e)||0,m=parseFloat(n)||0,g=p-m;let y=0;r.settings.showVat&&(y=g*u);const b=g+y;a(y),c(b),t(y)},[n,e,t,r.settings.showVat]);const f=()=>{o(!s)},h=()=>r.settings.showVat?s?"الاجمالي (غير شامل الضريبة)":"الاجمالي (شامل الضريبة)":"الاجمالي";return d.jsx(Pr,{expanded:s,onChange:f,customBackgroundColor:"rgb(227 242 253 / 90%)",customTextColor:"#2196f3",title:d.jsx(H,{item:!0,container:!0,xs:12,children:d.jsxs(H,{container:!0,alignItems:"center",children:[d.jsx(H,{item:!0,xs:10,children:d.jsx(gt,{children:h()})}),d.jsx(H,{item:!0,xs:2,children:d.jsxs(gt,{children:["$",s?(l-i).toFixed(2):l.toFixed(2)]})})]})}),children:d.jsx(vo,{children:d.jsxs(H,{container:!0,spacing:1,children:[n>0&&d.jsxs(H,{item:!0,container:!0,xs:12,children:[d.jsxs(H,{item:!0,xs:2,children:[d.jsx(gt,{variant:"body2",children:"مبلغ الخصم:"}),d.jsx(on,{})]}),d.jsx(H,{item:!0,xs:1,children:d.jsxs(gt,{variant:"body2",children:["-$",parseFloat(n).toFixed(2),d.jsx(on,{})]})})]}),r.settings.showVat&&d.jsxs(H,{item:!0,container:!0,xs:12,children:[d.jsxs(H,{item:!0,xs:2,children:[d.jsx(gt,{variant:"body2",children:"الضريبة (15%)"}),d.jsx(on,{})]}),d.jsxs(H,{item:!0,xs:1,children:[d.jsxs(gt,{variant:"body2",children:["$",i.toFixed(2)]}),d.jsx(on,{})]})]}),d.jsxs(H,{item:!0,container:!0,xs:12,children:[d.jsxs(H,{item:!0,xs:2,children:[d.jsx(gt,{variant:"body1",children:r.settings.showVat?"الاجمالي (شامل الضريبة)":"الاجمالي"}),d.jsx(on,{})]}),d.jsxs(H,{item:!0,xs:1,children:[d.jsxs(gt,{variant:"body1",children:["$",l.toFixed(2)]}),d.jsx(on,{})]})]})]})})})},_v=({control:n,setValue:e,subTotal:t,currentDiscount:r})=>{const[s,o]=x.useState("fixed"),[i,a]=x.useState("");x.useEffect(()=>{s==="fixed"&&(a(r.toString()),e("discountValue",r.toString()))},[s,r,e]);const l=f=>{const h=f.target.value;if(o(h),h==="percentage"){const p=parseFloat(i),m=parseFloat(t);if(!isNaN(p)&&m>0){const g=p/m*100;a(Math.min(g,100).toString())}}else h==="fixed"&&(a(r.toString()),e("discountValue",r.toString()))},c=f=>{let h=parseFloat(f.target.value);if(s==="percentage"){h=Math.min(h,100);const p=u(h);a(h.toString()),e("discountValue",p)}else h=Math.min(h,t),a(h.toString()),e("discountValue",h.toString())},u=f=>{if(!f)return"0.00";const h=parseFloat(f);return s==="percentage"?(h/100*t).toFixed(2):h.toFixed(2)};return d.jsx(Pr,{title:"الخصم",children:d.jsx(vo,{children:d.jsxs(cn,{component:"fieldset",fullWidth:!0,children:[d.jsxs(H,{container:!0,alignItems:"center",spacing:2,children:[d.jsx(H,{item:!0,xs:4,children:d.jsx(gt,{variant:"subtitle1",children:"مبلغ الخصم:"})}),d.jsx(H,{item:!0,xs:8,children:d.jsxs(mm,{row:!0,"aria-label":"discount",name:"discount",value:s,onChange:l,children:[d.jsx(Xl,{value:"percentage",control:d.jsx(Ql,{}),label:"نسبة"}),d.jsx(Xl,{value:"fixed",control:d.jsx(Ql,{}),label:"مبلغ",sx:{marginLeft:"80px"}})]})})]}),d.jsx($e,{mt:2,children:d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:4}),d.jsxs(H,{item:!0,xs:4,children:[d.jsx(we,{label:s==="percentage"?"نسبة الخصم":"مبلغ الخصم",type:"number",value:i,onChange:c,margin:"normal",sx:{width:"100%"}}),s==="percentage"&&d.jsxs(gt,{variant:"body2",color:"textSecondary",children:["يعادل: ",u(i)]})]})]})})]})})})};var na={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(l,c){switch(l){case"P":return c.date({width:"short"});case"PP":return c.date({width:"medium"});case"PPP":return c.date({width:"long"});case"PPPP":default:return c.date({width:"full"})}},r=function(l,c){switch(l){case"p":return c.time({width:"short"});case"pp":return c.time({width:"medium"});case"ppp":return c.time({width:"long"});case"pppp":default:return c.time({width:"full"})}},s=function(l,c){var u=l.match(/(P+)(p+)?/)||[],f=u[1],h=u[2];if(!h)return t(l,c);var p;switch(f){case"P":p=c.dateTime({width:"short"});break;case"PP":p=c.dateTime({width:"medium"});break;case"PPP":p=c.dateTime({width:"long"});break;case"PPPP":default:p=c.dateTime({width:"full"});break}return p.replace("{{date}}",t(f,c)).replace("{{time}}",r(h,c))},o={p:r,P:s},i=o;e.default=i,n.exports=e.default})(na,na.exports);var zv=na.exports;const Hv=_p(zv),Vv={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},Wv={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",fullDateWithWeekday:"PPPP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",monthAndYear:"LLLL yyyy",monthAndDate:"MMMM d",fullTime:"p",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",fullDateTime:"PP p",fullDateTime12h:"PP hh:mm aa",fullDateTime24h:"PP HH:mm",keyboardDateTime:"P p",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class Uv{constructor(e){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib="date-fns",this.locale=void 0,this.formats=void 0,this.formatTokenMap=Vv,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=o=>typeof o>"u"?new Date:o===null?null:new Date(o),this.dateWithTimezone=o=>this.date(o),this.getTimezone=()=>"default",this.setTimezone=o=>o,this.toJsDate=o=>o,this.getCurrentLocaleCode=()=>{var o;return((o=this.locale)==null?void 0:o.code)||"en-US"},this.is12HourCycleInCurrentLocale=()=>this.locale?/a/.test(this.locale.formatLong.time({width:"short"})):!0,this.expandFormat=o=>{const i=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;return o.match(i).map(a=>{const l=a[0];if(l==="p"||l==="P"){const c=this.longFormatters[l];return c(a,this.locale.formatLong)}return a}).join("")},this.getFormatHelperText=o=>this.expandFormat(o).replace(/(aaa|aa|a)/g,"(a|p)m").toLocaleLowerCase(),this.isNull=o=>o===null,this.formatNumber=o=>o,this.getMeridiemText=o=>o==="am"?"AM":"PM";const{locale:t,formats:r,longFormatters:s}=e;this.locale=t,this.formats=cd({},Wv,r),this.longFormatters=s}}class wl extends Uv{constructor({locale:e,formats:t}={}){if(typeof Hs!="function")throw new Error(["MUI: The `date-fns` package v3.x is not compatible with this adapter.","Please, install v2.x of the package or use the `AdapterDateFnsV3` instead."].join(`
`));super({locale:e??fd,formats:t,longFormatters:Hv}),this.parseISO=r=>ev(r),this.toISO=r=>zx(r,{format:"extended"}),this.parse=(r,s)=>r===""?null:Kb(r,s,new Date,{locale:this.locale}),this.isValid=r=>nm(this.date(r)),this.format=(r,s)=>this.formatByString(r,this.formats[s]),this.formatByString=(r,s)=>Jr(r,s,{locale:this.locale}),this.getDiff=(r,s,o)=>{switch(o){case"years":return $x(r,this.date(s));case"quarters":return jx(r,this.date(s));case"months":return Mf(r,this.date(s));case"weeks":return Fx(r,this.date(s));case"days":return Sf(r,this.date(s));case"hours":return Px(r,this.date(s));case"minutes":return Ax(r,this.date(s));case"seconds":return Lx(r,this.date(s));default:return Fo(r,this.date(s))}},this.isEqual=(r,s)=>r===null&&s===null?!0:Zx(r,s),this.isSameYear=(r,s)=>Xb(r,s),this.isSameMonth=(r,s)=>Qb(r,s),this.isSameDay=(r,s)=>Ex(r,s),this.isSameHour=(r,s)=>Jb(r,s),this.isAfter=(r,s)=>ci(r,s),this.isAfterYear=(r,s)=>ci(r,ai(s)),this.isAfterDay=(r,s)=>ci(r,ea(s)),this.isBefore=(r,s)=>Wr(r,s),this.isBeforeYear=(r,s)=>Wr(r,Ts(s)),this.isBeforeDay=(r,s)=>Wr(r,Tr(s)),this.isWithinRange=(r,[s,o])=>Zb(r,{start:s,end:o}),this.startOfYear=r=>Ts(r),this.startOfMonth=r=>jc(r),this.startOfWeek=r=>Bn(r,{locale:this.locale}),this.startOfDay=r=>Tr(r),this.endOfYear=r=>ai(r),this.endOfMonth=r=>ta(r),this.endOfWeek=r=>li(r,{locale:this.locale}),this.endOfDay=r=>ea(r),this.addYears=(r,s)=>Pc(r,s),this.addMonths=(r,s)=>Vs(r,s),this.addWeeks=(r,s)=>Tx(r,s),this.addDays=(r,s)=>Hs(r,s),this.addHours=(r,s)=>vx(r,s),this.addMinutes=(r,s)=>Sx(r,s),this.addSeconds=(r,s)=>Mx(r,s),this.getYear=r=>Xx(r),this.getMonth=r=>qx(r),this.getDate=r=>Hx(r),this.getHours=r=>Vx(r),this.getMinutes=r=>Ux(r),this.getSeconds=r=>Yx(r),this.getMilliseconds=r=>Wx(r),this.setYear=(r,s)=>kv(r,s),this.setMonth=(r,s)=>gv(r,s),this.setDate=(r,s)=>yv(r,s),this.setHours=(r,s)=>xv(r,s),this.setMinutes=(r,s)=>vv(r,s),this.setSeconds=(r,s)=>wv(r,s),this.setMilliseconds=(r,s)=>bv(r,s),this.getDaysInMonth=r=>Tf(r),this.getNextMonth=r=>Vs(r,1),this.getPreviousMonth=r=>Vs(r,-1),this.getMonthArray=r=>{const o=[Ts(r)];for(;o.length<12;){const i=o[o.length-1];o.push(this.getNextMonth(i))}return o},this.mergeDateAndTime=(r,s)=>this.setSeconds(this.setMinutes(this.setHours(r,this.getHours(s)),this.getMinutes(s)),this.getSeconds(s)),this.getWeekdays=()=>{const r=new Date;return Bx({start:Bn(r,{locale:this.locale}),end:li(r,{locale:this.locale})}).map(s=>this.formatByString(s,"EEEEEE"))},this.getWeekArray=r=>{const s=Bn(jc(r),{locale:this.locale}),o=li(ta(r),{locale:this.locale});let i=0,a=s;const l=[];for(;Wr(a,o);){const c=Math.floor(i/7);l[c]=l[c]||[],l[c].push(a),a=Hs(a,1),i+=1}return l},this.getWeekNumber=r=>Qx(r,{locale:this.locale}),this.getYearRange=(r,s)=>{const o=Ts(r),i=ai(s),a=[];let l=o;for(;Wr(l,i);)a.push(l),l=Pc(l,1);return a}}}const Bf=({open:n,onClose:e,clientId:t,invoiceId:r,onPaymentSubmit:s,dAmount:o})=>{const{handleSubmit:i,control:a,reset:l,setValue:c}=bo({defaultValues:{amount:o||0,method:"",reference:r,date:new Date,note:""}}),[u,f]=x.useState([]),[h,p]=x.useState([]),[m,g]=x.useState(!1),[y,b]=x.useState(""),[v,w]=x.useState("success");x.useEffect(()=>{(async()=>{try{const k=await gm(),T=k.safes.filter(E=>parseInt(t)===1||parseInt(t)===2?!E.isBank:E.isBank);f(T),p(k.paymentMethods),T.length>0&&(c("safe",T[0].safeID),c("method",T[0].safePD))}catch(k){console.error("Failed to fetch safes:",k)}})()},[t,c]);const C=async()=>{var k,T;const M={clientID:t,SandType:3,amount:o||0,date:new Date,reference:r,paymentMethod:((k=u[0])==null?void 0:k.safePD)||"",safe:((T=u[0])==null?void 0:T.safeID)||"",payment_image:"",comment:"",note:"",account:"",transactions:[{invoiceId:r,paymentID:"",amount:o||0,note:""}]};try{const E=await ym(M);console.log("Payment created successfully:",E),s(E),b("تم إنشاء الدفعة بنجاح"),w("success"),g(!0),e()}catch(E){console.error("Error creating payment:",E),b("حدث خطأ أثناء إنشاء الدفعة"),w("error"),g(!0)}};return d.jsxs(Zn,{open:n,onClose:e,fullWidth:!0,maxWidth:"sm",children:[d.jsx(tr,{children:"الدفع"}),d.jsxs("form",{children:[d.jsxs(er,{children:[d.jsx(ke,{name:"amount",control:a,rules:{required:"Amount is required"},render:({field:M,fieldState:{error:k}})=>d.jsx(we,{...M,label:"المبلغ",fullWidth:!0,margin:"dense",size:"small",type:"number",error:!!k,helperText:k?k.message:""})}),d.jsx(H,{item:!0,xs:12,children:d.jsxs(cn,{fullWidth:!0,margin:"dense",children:[" ",d.jsx(Bi,{id:"safe-select-label",size:"small",children:parseInt(t)===1||parseInt(t)===2?"الصندوق":"البنك"}),d.jsx(ke,{name:"safe",control:a,render:({field:M})=>d.jsx(Fi,{...M,labelId:"safe-select-label",label:parseInt(t)===1||parseInt(t)===2?"الصندوق":"البنك",size:"small",fullWidth:!0,children:u.map(k=>d.jsx(zi,{value:k.safeID,children:k.safeName},k.safeID))})})]})}),d.jsx(H,{item:!0,xs:12,children:d.jsxs(cn,{fullWidth:!0,margin:"dense",children:[" ",d.jsx(Bi,{id:"payment-method-label",size:"small",children:"طريقة الدفع"}),d.jsx(ke,{name:"method",control:a,render:({field:M})=>d.jsx(Fi,{...M,labelId:"payment-method-label",label:"طريقة الدفع",size:"small",fullWidth:!0,children:h.map(k=>d.jsx(zi,{value:k.paymentMethodID,children:k.paymentMethodName},k.paymentMethodID))})})]})}),d.jsx(ke,{name:"reference",control:a,render:({field:M})=>d.jsx(we,{...M,label:"المرجع",fullWidth:!0,size:"small",margin:"dense"})}),d.jsx(ke,{name:"note",control:a,render:({field:M})=>d.jsx(we,{...M,label:"ملاحظة",fullWidth:!0,size:"small",margin:"dense",multiline:!0,rows:3})}),d.jsx(Oa,{dateAdapter:wl,children:d.jsx(ke,{name:"date",control:a,render:({field:M})=>d.jsx(Na,{...M,label:"تاريخ الدفع",inputFormat:"dd/MM/yyyy",slots:{textField:k=>d.jsx(we,{...k,fullWidth:!0,margin:"dense",size:"small"})}})})})]}),d.jsxs(hs,{children:[d.jsx(Qe,{onClick:e,color:"secondary",children:"الغاء"}),d.jsx(Qe,{color:"primary",onClick:C,children:"تاكيد الدفع"})]})]}),d.jsx(ad,{open:m,autoHideDuration:6e3,onClose:()=>g(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:d.jsx(ld,{onClose:()=>g(!1),severity:v,sx:{width:"100%"},children:y})})]})};Bf.propTypes={open:se.bool.isRequired,onClose:se.func.isRequired,clientId:se.string.isRequired,invoiceId:se.string.isRequired,onPaymentSubmit:se.func.isRequired};const qv=(n,e)=>{var t;return{components:{MuiDataGrid:{defaultProps:{localeText:cd({},n,{MuiTablePagination:(e==null||(t=e.components)==null||(t=t.MuiTablePagination)==null?void 0:t.defaultProps)||{}})}}}}},Yv={noRowsLabel:"لا توجد صفوف",noResultsOverlayLabel:"لم يتم العثور على نتائج.",toolbarDensity:"الكثافة",toolbarDensityLabel:"الكثافة",toolbarDensityCompact:"مضغوط",toolbarDensityStandard:"قياسي",toolbarDensityComfortable:"مريح",toolbarColumns:"الأعمدة",toolbarColumnsLabel:"حدد أعمدة",toolbarFilters:"المُرشِحات",toolbarFiltersLabel:"إظهار المرشِحات",toolbarFiltersTooltipHide:"إخفاء المرشِحات",toolbarFiltersTooltipShow:"اظهر المرشِحات",toolbarFiltersTooltipActive:n=>n!==1?`${n} من المرشِحات النشطة`:"مرشِح نشط",toolbarQuickFilterPlaceholder:"بحث...",toolbarQuickFilterLabel:"بحث",toolbarQuickFilterDeleteIconLabel:"أزال",toolbarExport:"تصدير",toolbarExportLabel:"تصدير",toolbarExportCSV:"تنزيل كملف CSV",toolbarExportPrint:"طباعة",toolbarExportExcel:"تحميل كملف الإكسل",columnsPanelTextFieldLabel:"البحث عن العمود",columnsPanelTextFieldPlaceholder:"عنوان العمود",columnsPanelDragIconLabel:"إعادة ترتيب العمود",columnsPanelShowAllButton:"إظهار الكل",columnsPanelHideAllButton:"إخفاء الكل",filterPanelAddFilter:"إضافة مرشِح",filterPanelRemoveAll:"حذف الكل",filterPanelDeleteIconLabel:"حذف",filterPanelLogicOperator:"عامل منطقي",filterPanelOperator:"عامل",filterPanelOperatorAnd:"و",filterPanelOperatorOr:"أو",filterPanelColumns:"الأعمدة",filterPanelInputLabel:"القيمة",filterPanelInputPlaceholder:"ترشِيح قيمة",filterOperatorContains:"يحتوي",filterOperatorEquals:"يساوي",filterOperatorStartsWith:"يبدأ بـ",filterOperatorEndsWith:"ينتهي بـ",filterOperatorIs:"يكون",filterOperatorNot:"ليس",filterOperatorAfter:"بعد",filterOperatorOnOrAfter:"عند أو بعد",filterOperatorBefore:"قبل",filterOperatorOnOrBefore:"عند أو قبل",filterOperatorIsEmpty:"خالي",filterOperatorIsNotEmpty:"غير خالي",filterOperatorIsAnyOf:"أي من","filterOperator=":"=","filterOperator!=":"!=","filterOperator>":">","filterOperator>=":">=","filterOperator<":"<","filterOperator<=":"<=",headerFilterOperatorContains:"يحتوي على",headerFilterOperatorEquals:"يساوي",headerFilterOperatorStartsWith:"يبدأ ب",headerFilterOperatorEndsWith:"ينتهي ب",headerFilterOperatorIs:"هو",headerFilterOperatorNot:"هو ليس",headerFilterOperatorAfter:"يقع بعد",headerFilterOperatorOnOrAfter:"هو على او بعد",headerFilterOperatorBefore:"يقع قبل",headerFilterOperatorOnOrBefore:"هو على او بعد",headerFilterOperatorIsEmpty:"هو فارغ",headerFilterOperatorIsNotEmpty:"هو ليس فارغ",headerFilterOperatorIsAnyOf:"هو أي من","headerFilterOperator=":"يساوي","headerFilterOperator!=":"لا يساوي","headerFilterOperator>":"أكبر من","headerFilterOperator>=":"أكبر من او يساوي","headerFilterOperator<":"اصغر من","headerFilterOperator<=":"اصغر من او يساوي",filterValueAny:"أي",filterValueTrue:"صائب",filterValueFalse:"خاطئ",columnMenuLabel:"القائمة",columnMenuShowColumns:"إظهار الأعمدة",columnMenuManageColumns:"إدارة الأعمدة",columnMenuFilter:"المرشِح",columnMenuHideColumn:"إخفاء",columnMenuUnsort:"الغاء الفرز",columnMenuSortAsc:"الفرز تصاعدياً",columnMenuSortDesc:"الفرز تنازلياً",columnHeaderFiltersTooltipActive:n=>n!==1?`${n} من المرشِحات النشطة`:"مرشِح نشط",columnHeaderFiltersLabel:"إظهار المرشحات",columnHeaderSortIconLabel:"فرز",footerRowSelected:n=>n!==1?`تم تحديد ${n.toLocaleString()} من الصفوف`:"تم تحديد صف واحد",footerTotalRows:"إجمالي الصفوف:",footerTotalVisibleRows:(n,e)=>`${n.toLocaleString()} من ${e.toLocaleString()}`,checkboxSelectionHeaderName:"تحديد خانة الاختيار",checkboxSelectionSelectAllRows:"تحديد كل الصفوف",checkboxSelectionUnselectAllRows:"الغاء تحديد كل الصفوف",checkboxSelectionSelectRow:"تحديد صف",checkboxSelectionUnselectRow:"الغاء تحديد الصف",booleanCellTrueLabel:"نعم",booleanCellFalseLabel:"لا",actionsCellMore:"المزيد",pinToLeft:"التدبيس يميناً",pinToRight:"التدبيس يساراً",unpin:"الغاء التدبيس",treeDataGroupingHeaderName:"تجميع",treeDataExpand:"رؤية الأبناء",treeDataCollapse:"إخفاء الأبناء",groupingColumnHeaderName:"تجميع",groupColumn:n=>`تجميع حسب ${n}`,unGroupColumn:n=>`إيقاف التجميع حسب ${n}`,detailPanelToggle:"اظهار/اخفاء لوحة التفاصيل",expandDetailPanel:"توسيع",collapseDetailPanel:"طوي",rowReorderingHeaderName:"أعادة ترتيب الصفوف",aggregationMenuItemHeader:"الدلالات الحسابية",aggregationFunctionLabelSum:"مجموع",aggregationFunctionLabelAvg:"معدل",aggregationFunctionLabelMin:"الحد الادنى",aggregationFunctionLabelMax:"الحد الاقصى",aggregationFunctionLabelSize:"الحجم"},Kv=qv(Yv,zp),_f=({invoiceId:n,open:e,onClose:t})=>{const[r,s]=x.useState([]),[o,i]=x.useState(!1),a=ud(),l=Hp();x.useEffect(()=>{e&&(async()=>{i(!0);try{const p=(await sm(n)).map(m=>({id:m.paymentID,paymentNumber:m.paymentID,paymentAmount:m.amount,paymentDate:m.date,paymentReference:m.reference}));s(p)}catch(h){console.error("Failed to fetch transactions",h)}finally{i(!1)}})()},[n,e]);const c=[{field:"paymentNumber",headerName:"رقم الدفعة",flex:1},{field:"paymentAmount",headerName:"المبلغ",flex:1},{field:"paymentDate",headerName:"التاريخ",flex:1},{field:"paymentReference",headerName:"المرجع",flex:1},{field:"actions",headerName:"الإجراءات",flex:.5,renderCell:f=>d.jsx(Sr,{color:"primary",onClick:()=>a(`/apps/invoice/payment/payment-edit/${f.id}`),children:d.jsx(Ea,{})})}],u=Ee.useMemo(()=>Vp({},Kv,l,{direction:"rtl"}),[l]);return d.jsxs(Zn,{open:e,onClose:t,fullWidth:!0,maxWidth:"md",children:[d.jsx(tr,{children:"سجل المدفوعات"}),d.jsx(er,{children:d.jsx(Wp,{theme:u,children:o?d.jsx($e,{display:"flex",justifyContent:"center",alignItems:"center",children:d.jsx(Ia,{})}):d.jsx($e,{sx:{height:400,width:"100%"},children:d.jsx(xm,{rows:r,columns:c,pageSize:5,rowsPerPageOptions:[5],disableSelectionOnClick:!0})})})}),d.jsx(hs,{children:d.jsx(Qe,{onClick:t,color:"primary",children:"اغلاق"})})]})};_f.propTypes={invoiceId:se.string.isRequired,open:se.bool.isRequired,onClose:se.func.isRequired};const Gv=({open:n,onClose:e,imageID:t})=>{const[r,s]=x.useState(null),[o,i]=x.useState(!0),[a,l]=x.useState(!1),[c,u]=x.useState(!1);x.useEffect(()=>(n&&(async()=>{if(!t){console.error("No imageID provided!");return}console.log("Fetching file with imageID:",t),i(!0),l(!1),u(!1);try{const m=await Up.get(`/api/invoice/file/${t}`,{responseType:"blob",validateStatus:function(y){return y===200}}),g=URL.createObjectURL(m.data);s(g)}catch(m){console.error("Error fetching file:",m),l(!0)}finally{i(!1)}})(),()=>{r&&URL.revokeObjectURL(r)}),[t,n]);const f=()=>{u(!0)},h=()=>{l(!0),u(!1)};return d.jsxs(Zn,{open:n,onClose:e,maxWidth:"md",fullWidth:!0,children:[d.jsxs(tr,{children:["مشاهدة الملف",d.jsx(Sr,{"aria-label":"close",onClick:e,sx:{position:"absolute",right:8,top:8},children:d.jsx(rd,{})})]}),d.jsx(er,{dividers:!0,style:{minHeight:"600px",display:"flex",justifyContent:"center",alignItems:"center"},children:o?d.jsx(Ia,{}):a?d.jsx(gt,{color:"error",children:"An error occurred while loading the file. Please verify that the file exists and try again."}):d.jsx("div",{style:{textAlign:"center",width:"100%"},children:d.jsx("embed",{src:r,type:"application/pdf",width:"100%",height:"600px",style:{border:"1px solid #ddd"},onLoad:f,onError:h})})})]})},zf=({control:n,setValue:e,watch:t,clientId:r,invoiceId:s,subTotal:o})=>{const i=t("paid"),a=t("balance"),[l,c]=x.useState(!1),[u,f]=x.useState(!1),[h,p]=x.useState(!1);x.useEffect(()=>{e("paymentStatus",a===0?"مدفوع":"غير مدفوع")},[a,e]);const m=()=>{c(!0)},g=y=>{console.log("Payment submitted:",y)};return d.jsx(Pr,{title:"الدفع",children:d.jsxs(vo,{children:[d.jsxs($e,{display:"flex",justifyContent:"flex-start",mb:2,children:[d.jsx(Qe,{variant:"contained",color:"primary",onClick:m,sx:{mr:1},children:"الدفع"}),d.jsx(Qe,{variant:"outlined",color:"secondary",onClick:()=>f(!0),children:"سجل المدفوعات"})]}),d.jsxs(id,{spacing:2,mt:2,children:[d.jsx(ke,{name:"paymentStatus",control:n,render:({field:y})=>d.jsx(we,{...y,label:"حالة الدفع",value:y.value||"",fullWidth:!0,size:"small",InputProps:{readOnly:!0}})}),d.jsx(ke,{name:"paid",control:n,render:({field:y})=>d.jsx(we,{...y,label:"المبلغ المدفوع",value:i||0,fullWidth:!0,size:"small",type:"number",InputProps:{readOnly:!0}})}),d.jsx(ke,{name:"balance",control:n,render:({field:y})=>(o&&i!==null&&(o+o*.15-i).toFixed(2),d.jsx(we,{...y,label:"الرصيد المتبقي",value:a||"",fullWidth:!0,size:"small",type:"number",InputProps:{readOnly:!0}}))}),d.jsx(Oa,{dateAdapter:wl,children:d.jsx(ke,{name:"dueDate",control:n,render:({field:y})=>d.jsx(Na,{...y,label:"تاريخ الاستحقاق",format:"dd/MM/yyyy",value:y.value||null,onChange:b=>e("dueDate",b),slots:{textField:b=>d.jsx(we,{...b,fullWidth:!0,size:"small"})}})})})]}),d.jsx(Bf,{open:l,onClose:()=>c(!1),clientId:r,invoiceId:s,onPaymentSubmit:g,dAmount:a}),d.jsx(_f,{invoiceId:s,open:u,onClose:()=>f(!1)}),d.jsx(Gv,{open:h,onClose:()=>p(!1),invoiceId:s})]})})};zf.propTypes={control:se.object.isRequired,setValue:se.func.isRequired,watch:se.func.isRequired,clientId:se.string.isRequired,invoiceId:se.string.isRequired,subTotal:se.number.isRequired};const Hf=({open:n,handleClose:e,onCompanyAdded:t})=>{const{handleSubmit:r,control:s,formState:{errors:o},reset:i}=bo(),[a,l]=x.useState(!1),c=async u=>{l(!0);try{const f=await om(u);console.log("Added shipping company:",f,f.new_ship_id),t(f.new_ship_id),i(),e()}catch(f){console.error("Error adding new shipping company:",f)}finally{l(!1)}};return d.jsxs(Zn,{open:n,onClose:e,fullWidth:!0,maxWidth:"sm",children:[d.jsx(tr,{children:"إضافة شركة شحن جديدة"}),d.jsx(er,{children:d.jsx("form",{onSubmit:r(c),children:d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipName",control:s,rules:{required:"اسم شركة الشحن مطلوب"},render:({field:u})=>{var f;return d.jsx(we,{...u,label:"اسم شركة الشحن",fullWidth:!0,size:"small",error:!!o.shipName,helperText:(f=o.shipName)==null?void 0:f.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipVat",control:s,rules:{required:"الرقم الضريبي مطلوب"},render:({field:u})=>{var f;return d.jsx(we,{...u,label:"الرقم الضريبي",fullWidth:!0,size:"small",error:!!o.shipVat,helperText:(f=o.shipVat)==null?void 0:f.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipTel",control:s,rules:{required:"رقم الهاتف مطلوب"},render:({field:u})=>{var f;return d.jsx(we,{...u,label:"رقم الهاتف",fullWidth:!0,size:"small",error:!!o.shipTel,helperText:(f=o.shipTel)==null?void 0:f.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipAddress",control:s,rules:{required:"العنوان مطلوب"},render:({field:u})=>{var f;return d.jsx(we,{...u,label:"العنوان",fullWidth:!0,size:"small",error:!!o.shipAddress,helperText:(f=o.shipAddress)==null?void 0:f.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"DeliveryTime",control:s,rules:{required:"ايام التوصيل مطلوبة"},render:({field:u})=>{var f;return d.jsx(we,{...u,label:"ايام التوصيل",size:"small",fullWidth:!0,error:!!o.DeliveryTime,helperText:(f=o.DeliveryTime)==null?void 0:f.message})}})})]})})}),d.jsxs(hs,{children:[d.jsx(Qe,{onClick:e,color:"secondary",children:"إلغاء"}),d.jsx(Qe,{onClick:r(c),color:"primary",variant:"contained",disabled:a,children:a?"جارٍ الإضافة...":"إضافة"})]})]})};Hf.propTypes={open:se.bool.isRequired,handleClose:se.func.isRequired,onCompanyAdded:se.func.isRequired};const Vf=({open:n,handleClose:e,shippingCompanyData:t,onCompanyEdited:r})=>{const{handleSubmit:s,control:o,formState:{errors:i},reset:a,setValue:l}=bo(),[c,u]=x.useState(!1);x.useEffect(()=>{t&&(console.log("Setting initial form values:",t),l("shipName",t.label),l("shipVat",t.shipVat),l("shipTel",t.shipTel),l("shipAddress",t.shipAddress),l("DeliveryTime",t.DeliveryTime))},[t,l]);const f=async h=>{u(!0);try{const p=await im(t.id,h);console.log("Edited shipping company:",p),r(t.id),a(),e()}catch(p){console.error("Error updating shipping company:",p)}finally{u(!1)}};return d.jsxs(Zn,{open:n,onClose:e,fullWidth:!0,maxWidth:"sm",children:[d.jsx(tr,{children:"تعديل شركة شحن"}),d.jsx(er,{children:d.jsx("form",{onSubmit:s(f),children:d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipName",control:o,rules:{required:"اسم شركة الشحن مطلوب"},render:({field:h})=>{var p;return d.jsx(we,{...h,label:"اسم شركة الشحن",fullWidth:!0,size:"small",error:!!i.shipName,helperText:(p=i.shipName)==null?void 0:p.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipVat",control:o,rules:{required:"الرقم الضريبي مطلوب"},render:({field:h})=>{var p;return d.jsx(we,{...h,label:"الرقم الضريبي",fullWidth:!0,size:"small",error:!!i.shipVat,helperText:(p=i.shipVat)==null?void 0:p.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipTel",control:o,rules:{required:"رقم الهاتف مطلوب"},render:({field:h})=>{var p;return d.jsx(we,{...h,label:"رقم الهاتف",fullWidth:!0,size:"small",error:!!i.shipTel,helperText:(p=i.shipTel)==null?void 0:p.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"shipAddress",control:o,rules:{required:"العنوان مطلوب"},render:({field:h})=>{var p;return d.jsx(we,{...h,label:"العنوان",fullWidth:!0,size:"small",error:!!i.shipAddress,helperText:(p=i.shipAddress)==null?void 0:p.message})}})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(ke,{name:"DeliveryTime",control:o,rules:{required:"ايام التوصيل مطلوبة"},render:({field:h})=>{var p;return d.jsx(we,{...h,label:"ايام التوصيل",size:"small",fullWidth:!0,error:!!i.DeliveryTime,helperText:(p=i.DeliveryTime)==null?void 0:p.message})}})})]})})}),d.jsxs(hs,{children:[d.jsx(Qe,{onClick:e,color:"secondary",children:"إلغاء"}),d.jsx(Qe,{onClick:s(f),color:"primary",variant:"contained",disabled:c,children:c?"جارٍ التعديل...":"تعديل"})]})]})};Vf.propTypes={open:se.bool.isRequired,handleClose:se.func.isRequired,shippingCompanyData:se.object.isRequired,onCompanyEdited:se.func.isRequired};const Jv=({invoiceData:n,setInvoiceValue:e})=>{const{control:t,setValue:r}=hd(),[s,o]=x.useState([]),[i,a]=x.useState(null),[l,c]=x.useState(!1),[u,f]=x.useState(!1),[h,p]=x.useState(null);x.useEffect(()=>{(async()=>{try{const M=(await Jl()).shipping_companies.map(k=>({label:k.shipName,id:k.shipID,DeliveryTime:k.DeliveryTime,shipTel:k.shipTel,shipVat:k.shipVat,shipAddress:k.shipAddress}));if(o(M),n.shipping_service_id){const k=M.find(T=>T.id===n.shipping_service_id);k&&(a(k),r("shippingCompany",k),r("shippingCompanyNumber",k.shipTel),r("vatNumber",k.shipVat),r("estimatedShippingTime",k.DeliveryTime))}r("shippingFees",n.shipping_charge_on_order||""),r("shippingTrackingNumber",n.shipping_tracking_number||""),r("DeliveryDate",n.delivery_date),e("shipping_service_id",n.shipping_service_id||"")}catch(C){console.error("Failed to fetch shipping companies:",C)}})()},[r,e,n]);const m=(w,C)=>{a(C),C?(r("shippingCompany",C),r("shippingCompanyNumber",C.shipTel),r("vatNumber",C.shipVat),r("estimatedShippingTime",C.DeliveryTime),e("shipping_service_id",C.id)):(r("shippingCompanyNumber",""),r("vatNumber",""),r("estimatedShippingTime",""),e("shipping_service_id",""))},g=()=>{c(!0)},y=()=>{c(!1)},b=async w=>{try{const M=(await Jl()).shipping_companies.map(T=>({label:T.shipName,id:T.shipID,DeliveryTime:T.DeliveryTime,shipTel:T.shipTel,shipVat:T.shipVat,shipAddress:T.shipAddress}));o(M);const k=M.find(T=>T.id===w);k&&(a(k),r("shippingCompany",k),r("shippingCompanyNumber",k.shipTel),r("vatNumber",k.shipVat),r("estimatedShippingTime",k.DeliveryTime),e("shipping_service_id",k.id)),c(!1)}catch(C){console.error("Failed to refetch shipping companies:",C)}},v=()=>{i&&(p(i),f(!0))};return d.jsxs(d.Fragment,{children:[d.jsx(Pr,{title:"شركة الشحن",children:d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:12,md:6,children:d.jsxs($e,{sx:{border:"1px solid #ccc",p:2,borderRadius:1,mb:2},children:[d.jsx($e,{sx:{fontWeight:"bold",mb:1,backgroundColor:"#ede7f66b",p:1,borderRadius:"4px"},children:"الشحنة"}),d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:4,children:d.jsx(ke,{name:"shippingCompany",control:t,render:({field:{onChange:w,value:C,...M}})=>d.jsx(bm,{...M,options:s,getOptionLabel:k=>k.label||"",isOptionEqualToValue:(k,T)=>k.id===T.id,onChange:(k,T)=>{w(T),m(k,T)},value:C||i||null,renderInput:k=>d.jsx(we,{...k,label:"اختر شركة الشحن",size:"small",variant:"outlined",fullWidth:!0,required:!0,InputProps:{...k.InputProps,style:{padding:"8px 0px"},startAdornment:d.jsx(Qr,{position:"start",children:d.jsx(Sr,{size:"small",onClick:v,children:d.jsx(Ea,{sx:{color:"#2196f3"}})})}),endAdornment:d.jsx(Qr,{position:"end",children:d.jsx(Sr,{size:"small",onClick:g,children:d.jsx(_i,{sx:{color:"#2196f3"}})})})}})})})}),d.jsx(H,{item:!0,xs:4,children:d.jsx(ke,{name:"shippingFees",control:t,render:({field:{value:w,onChange:C,...M}})=>d.jsx(we,{...M,label:"رسوم الشحن",size:"small",variant:"outlined",fullWidth:!0,value:w||"",onChange:k=>{C(k),e("shipping_charge_on_order",k.target.value)}})})}),d.jsx(H,{item:!0,xs:4,children:d.jsx(ke,{name:"shippingTrackingNumber",control:t,render:({field:{value:w,onChange:C,...M}})=>d.jsx(we,{...M,label:"رقم التتبع",size:"small",variant:"outlined",fullWidth:!0,value:w||"",onChange:k=>{C(k),e("shipping_tracking_number",k.target.value)}})})})]})]})}),d.jsx(H,{item:!0,xs:12,md:6,children:d.jsxs($e,{sx:{border:"1px solid #ccc",p:2,borderRadius:1,mb:2},children:[d.jsx($e,{sx:{fontWeight:"bold",mb:1,backgroundColor:"#ede7f66b",p:1,borderRadius:"4px"},children:"شركة الشحن"}),d.jsxs(H,{container:!0,spacing:2,children:[d.jsx(H,{item:!0,xs:3,children:d.jsx(ke,{name:"shippingCompanyNumber",control:t,render:({field:{value:w,...C}})=>d.jsx(we,{...C,label:"رقم الهاتف",size:"small",variant:"outlined",fullWidth:!0,sx:{"& .MuiInputLabel-root":{color:w?"black":"#2196f3"},"& .MuiOutlinedInput-input.Mui-disabled":{WebkitTextFillColor:"#4C9EF5"}},value:w||"",disabled:!0})})}),d.jsx(H,{item:!0,xs:3,children:d.jsx(ke,{name:"vatNumber",control:t,render:({field:{value:w,...C}})=>d.jsx(we,{...C,label:"الرقم الضريبي",size:"small",variant:"outlined",fullWidth:!0,value:w||"",sx:{"& .MuiInputLabel-root":{color:w?"black":"#2196f3"},"& .MuiOutlinedInput-input.Mui-disabled":{WebkitTextFillColor:"#4C9EF5"}},disabled:!0})})}),d.jsx(H,{item:!0,xs:2,children:d.jsx(ke,{name:"estimatedShippingTime",control:t,render:({field:{value:w,...C}})=>d.jsx(we,{...C,label:"ايام الشحن",variant:"outlined",size:"small",type:"number",fullWidth:!0,sx:{"& .MuiInputLabel-root":{color:w?"black":"#2196f3"},"& .MuiOutlinedInput-input.Mui-disabled":{WebkitTextFillColor:"#4C9EF5"}},value:w||"",disabled:!0})})}),d.jsx(H,{item:!0,xs:4,children:d.jsx(Oa,{dateAdapter:wl,children:d.jsx(ke,{name:"DeliveryDate",control:t,render:({field:w})=>{const C=w.value?new Date(w.value):null,M=C instanceof Date&&!isNaN(C)?C:null;return d.jsx(Na,{...w,label:"تاريخ الاستلام",format:"dd/MM/yyyy",value:M,onChange:k=>e("delivery_date",k),slots:{textField:k=>d.jsx(we,{...k,fullWidth:!0,size:"small"})}})}})})})]})]})})]})}),d.jsx(Hf,{open:l,handleClose:y,onCompanyAdded:b}),d.jsx(Vf,{open:u,handleClose:()=>f(!1),shippingCompanyData:h,onCompanyEdited:b})]})};qp("input")({position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",whiteSpace:"nowrap",clipPath:"inset(100%)",clip:"rect(0 0 0 0)",overflow:"hidden"});function Ke(n){this.content=n}Ke.prototype={constructor:Ke,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),o=r.content.slice();return s==-1?o.push(t||n,e):(o[s+1]=e,t&&(o[s]=t)),new Ke(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Ke(t)},addToStart:function(n,e){return new Ke([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Ke(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),o=r.find(n);return s.splice(o==-1?s.length:o,0,e,t),new Ke(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Ke.from(n),n.size?new Ke(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Ke.from(n),n.size?new Ke(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Ke.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Ke.from=function(n){if(n instanceof Ke)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Ke(e)};function Wf(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),o=e.child(r);if(s==o){t+=s.nodeSize;continue}if(!s.sameMarkup(o))return t;if(s.isText&&s.text!=o.text){for(let i=0;s.text[i]==o.text[i];i++)t++;return t}if(s.content.size||o.content.size){let i=Wf(s.content,o.content,t+1);if(i!=null)return i}t+=s.nodeSize}}function Uf(n,e,t,r){for(let s=n.childCount,o=e.childCount;;){if(s==0||o==0)return s==o?null:{a:t,b:r};let i=n.child(--s),a=e.child(--o),l=i.nodeSize;if(i==a){t-=l,r-=l;continue}if(!i.sameMarkup(a))return{a:t,b:r};if(i.isText&&i.text!=a.text){let c=0,u=Math.min(i.text.length,a.text.length);for(;c<u&&i.text[i.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(i.content.size||a.content.size){let c=Uf(i.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class j{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,o){for(let i=0,a=0;a<t;i++){let l=this.content[i],c=a+l.nodeSize;if(c>e&&r(l,s+a,o||null,i)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let o="",i=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(i?i=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)s.push(e.content[o]);return new j(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let o=0,i=0;i<t;o++){let a=this.content[o],l=i+a.nodeSize;l>e&&((i<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a=a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),r.push(a),s+=a.nodeSize),i=l}return new j(r,s)}cutByIndex(e,t){return e==t?j.empty:e==0&&t==this.content.length?this:new j(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new j(s,o)}addToStart(e){return new j([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new j(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return Wf(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Uf(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Os(0,e);if(e==this.size)return Os(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let o=this.child(r),i=s+o.nodeSize;if(i>=e)return i==e||t>0?Os(r+1,i):Os(r,s);s=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return j.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new j(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return j.empty;let t,r=0;for(let s=0;s<e.length;s++){let o=e[s];r+=o.nodeSize,s&&o.isText&&e[s-1].sameMarkup(o)?(t||(t=e.slice(0,s)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new j(t||e,r)}static from(e){if(!e)return j.empty;if(e instanceof j)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new j([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}j.empty=new j([],0);const fi={index:0,offset:0};function Os(n,e){return fi.index=n,fi.offset=e,fi}function no(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!no(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!no(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Te=class ra{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let o=e[s];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,s));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&no(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return ra.none;if(e instanceof ra)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Te.none=[];class ro extends Error{}class U{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Yf(this.content,e+this.openStart,t);return r&&new U(r,this.openStart,this.openEnd)}removeBetween(e,t){return new U(qf(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return U.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new U(j.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)s++;return new U(e,r,s)}}U.empty=new U(j.empty,0,0);function qf(n,e,t){let{index:r,offset:s}=n.findIndex(e),o=n.maybeChild(r),{index:i,offset:a}=n.findIndex(t);if(s==e||o.isText){if(a!=t&&!n.child(i).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=i)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(qf(o.content,e-s-1,t-s-1)))}function Yf(n,e,t,r){let{index:s,offset:o}=n.findIndex(e),i=n.maybeChild(s);if(o==e||i.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=Yf(i.content,e-o-1,t);return a&&n.replaceChild(s,i.copy(a))}function Qv(n,e,t){if(t.openStart>n.depth)throw new ro("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new ro("Inconsistent open depths");return Kf(n,e,t,0)}function Kf(n,e,t,r){let s=n.index(r),o=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let i=Kf(n,e,t,r+1);return o.copy(o.content.replaceChild(s,i))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let i=n.parent,a=i.content;return zn(i,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:i,end:a}=Xv(t,n);return zn(o,Jf(n,i,a,e,r))}else return zn(o,so(n,e,r))}function Gf(n,e){if(!e.type.compatibleContent(n.type))throw new ro("Cannot join "+e.type.name+" onto "+n.type.name)}function sa(n,e,t){let r=n.node(t);return Gf(r,e.node(t)),r}function _n(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Zr(n,e,t,r){let s=(e||n).node(t),o=0,i=e?e.index(t):s.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(_n(n.nodeAfter,r),o++));for(let a=o;a<i;a++)_n(s.child(a),r);e&&e.depth==t&&e.textOffset&&_n(e.nodeBefore,r)}function zn(n,e){return n.type.checkContent(e),n.copy(e)}function Jf(n,e,t,r,s){let o=n.depth>s&&sa(n,e,s+1),i=r.depth>s&&sa(t,r,s+1),a=[];return Zr(null,n,s,a),o&&i&&e.index(s)==t.index(s)?(Gf(o,i),_n(zn(o,Jf(n,e,t,r,s+1)),a)):(o&&_n(zn(o,so(n,e,s+1)),a),Zr(e,t,s,a),i&&_n(zn(i,so(t,r,s+1)),a)),Zr(r,null,s,a),new j(a)}function so(n,e,t){let r=[];if(Zr(null,n,t,r),n.depth>t){let s=sa(n,e,t+1);_n(zn(s,so(n,e,t+1)),r)}return Zr(e,null,t,r),new j(r)}function Xv(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)s=e.node(o).copy(j.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class ss{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)s+=r.child(o).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Te.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let o=r.marks;for(var i=0;i<o.length;i++)o[i].type.spec.inclusive===!1&&(!s||!o[i].isInSet(s.marks))&&(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!s||!r[o].isInSet(s.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new oo(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,o=t;for(let i=e;;){let{index:a,offset:l}=i.content.findIndex(o),c=o-l;if(r.push(i,a,s+l),!c||(i=i.child(a),i.isText))break;o=c-1,s+=l+1}return new ss(t,r,o)}static resolveCached(e,t){let r=_c.get(e);if(r)for(let o=0;o<r.elts.length;o++){let i=r.elts[o];if(i.pos==t)return i}else _c.set(e,r=new Zv);let s=r.elts[r.i]=ss.resolve(e,t);return r.i=(r.i+1)%e1,s}}class Zv{constructor(){this.elts=[],this.i=0}}const e1=12,_c=new WeakMap;class oo{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const t1=Object.create(null);let Hn=class oa{constructor(e,t,r,s=Te.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||j.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&no(this.attrs,t||e.defaultAttrs||t1)&&Te.sameSet(this.marks,r||Te.none)}copy(e=null){return e==this.content?this:new oa(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new oa(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return U.empty;let s=this.resolve(e),o=this.resolve(t),i=r?0:s.sharedDepth(t),a=s.start(i),c=s.node(i).content.cut(s.pos-a,o.pos-a);return new U(c,s.depth-i,o.depth-i)}replace(e,t,r){return Qv(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return ss.resolveCached(this,e)}resolveNoCache(e){return ss.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Qf(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=j.empty,s=0,o=r.childCount){let i=this.contentMatchAt(e).matchFragment(r,s,o),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let o=this.contentMatchAt(e).matchType(r),i=o&&o.matchFragment(this.content,t);return i?i.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Te.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Te.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=j.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,s,r);return o.type.checkAttrs(o.attrs),o}};Hn.prototype.text=void 0;class io extends Hn{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Qf(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new io(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new io(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Qf(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Kn{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new n1(e,t);if(r.next==null)return Kn.empty;let s=Xf(r);r.next&&r.err("Unexpected trailing text");let o=c1(l1(s));return u1(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let o=t;s&&o<r;o++)s=s.matchType(e.child(o).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function o(i,a){let l=i.matchFragment(e,r);if(l&&(!t||l.validEnd))return j.from(a.map(c=>c.createAndFill()));for(let c=0;c<i.next.length;c++){let{type:u,next:f}=i.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(f)==-1){s.push(f);let h=o(f,a.concat(u));if(h)return h}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),o=s.match;if(o.matchType(e)){let i=[];for(let a=s;a.type;a=a.via)i.push(a.type);return i.reverse()}for(let i=0;i<o.next.length;i++){let{type:a,next:l}=o.next[i];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let o=s+(r.validEnd?"*":" ")+" ";for(let i=0;i<r.next.length;i++)o+=(i?", ":"")+r.next[i].type.name+"->"+e.indexOf(r.next[i].next);return o}).join(`
`)}}Kn.empty=new Kn(!0);class n1{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Xf(n){let e=[];do e.push(r1(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function r1(n){let e=[];do e.push(s1(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function s1(n){let e=a1(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=o1(n,e);else break;return e}function zc(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function o1(n,e){let t=zc(n),r=t;return n.eat(",")&&(n.next!="}"?r=zc(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function i1(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let o in t){let i=t[o];i.groups.indexOf(e)>-1&&s.push(i)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function a1(n){if(n.eat("(")){let e=Xf(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=i1(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function l1(n){let e=[[]];return s(o(n,0),t()),e;function t(){return e.push([])-1}function r(i,a,l){let c={term:l,to:a};return e[i].push(c),c}function s(i,a){i.forEach(l=>l.to=a)}function o(i,a){if(i.type=="choice")return i.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(i.type=="seq")for(let l=0;;l++){let c=o(i.exprs[l],a);if(l==i.exprs.length-1)return c;s(c,a=t())}else if(i.type=="star"){let l=t();return r(a,l),s(o(i.expr,l),l),[r(l)]}else if(i.type=="plus"){let l=t();return s(o(i.expr,a),l),s(o(i.expr,l),l),[r(l)]}else{if(i.type=="opt")return[r(a)].concat(o(i.expr,a));if(i.type=="range"){let l=a;for(let c=0;c<i.min;c++){let u=t();s(o(i.expr,l),u),l=u}if(i.max==-1)s(o(i.expr,l),l);else for(let c=i.min;c<i.max;c++){let u=t();r(l,u),s(o(i.expr,l),u),l=u}return[r(l)]}else{if(i.type=="name")return[r(a,void 0,i.value)];throw new Error("Unknown expr type")}}}}function Zf(n,e){return e-n}function Hc(n,e){let t=[];return r(e),t.sort(Zf);function r(s){let o=n[s];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(s);for(let i=0;i<o.length;i++){let{term:a,to:l}=o[i];!a&&t.indexOf(l)==-1&&r(l)}}}function c1(n){let e=Object.create(null);return t(Hc(n,0));function t(r){let s=[];r.forEach(i=>{n[i].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);Hc(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new Kn(r.indexOf(n.length-1)>-1);for(let i=0;i<s.length;i++){let a=s[i][1].sort(Zf);o.next.push({type:s[i][0],next:e[a.join(",")]||t(a)})}return o}}function u1(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],o=!s.validEnd,i=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];i.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function eh(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function th(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let o=n[r];if(o.hasDefault)s=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function nh(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let o=n[s];o.validate&&o.validate(e[s])}}function rh(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new f1(n,r,e[r]);return t}let Vc=class sh{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=rh(e,r.attrs),this.defaultAttrs=eh(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Kn.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:th(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Hn(this,this.computeAttrs(e),j.from(t),Te.setFrom(r))}createChecked(e=null,t,r){return t=j.from(t),this.checkContent(t),new Hn(this,this.computeAttrs(e),t,Te.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=j.from(t),t.size){let i=this.contentMatch.fillBefore(t);if(!i)return null;t=i.append(t)}let s=this.contentMatch.matchFragment(t),o=s&&s.fillBefore(j.empty,!0);return o?new Hn(this,e,t.append(o),Te.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){nh(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Te.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,i)=>r[o]=new sh(o,t,i));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function d1(n,e,t){let r=t.split("|");return s=>{let o=s===null?"null":typeof s;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class f1{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?d1(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class $o{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=rh(e,s.attrs),this.excluded=null;let o=eh(this.attrs);this.instance=o?new Te(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Te(this,th(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((o,i)=>r[o]=new $o(o,s++,t,i)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){nh(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class oh{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=Ke.from(e.nodes),t.marks=Ke.from(e.marks||{}),this.nodes=Vc.compile(this.spec.nodes,this),this.marks=$o.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let o=this.nodes[s],i=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[i]||(r[i]=Kn.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Wc(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let s in this.marks){let o=this.marks[s],i=o.spec.excludes;o.excluded=i==null?[o]:i==""?[]:Wc(this,i.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Vc){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new io(r,r.defaultAttrs,e,Te.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Hn.fromJSON(this,e)}markFromJSON(e){return Te.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Wc(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],o=n.marks[s],i=o;if(o)t.push(o);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(i=l)}if(!i)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function h1(n){return n.tag!=null}function p1(n){return n.style!=null}class gn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(h1(s))this.tags.push(s);else if(p1(s)){let o=/[^=]*/.exec(s.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let o=e.nodes[s.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new qc(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new qc(this,t,!0);return r.addAll(e,t.from,t.to),U.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let o=this.tags[s];if(y1(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let i=o.getAttrs(e);if(i===!1)continue;o.attrs=i||void 0}return o}}}matchStyle(e,t,r,s){for(let o=s?this.styles.indexOf(s)+1:0;o<this.styles.length;o++){let i=this.styles[o],a=i.style;if(!(a.indexOf(e)!=0||i.context&&!r.matchesContext(i.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(i.getAttrs){let l=i.getAttrs(t);if(l===!1)continue;i.attrs=l||void 0}return i}}}static schemaRules(e){let t=[];function r(s){let o=s.priority==null?50:s.priority,i=0;for(;i<t.length;i++){let a=t[i];if((a.priority==null?50:a.priority)<o)break}t.splice(i,0,s)}for(let s in e.marks){let o=e.marks[s].spec.parseDOM;o&&o.forEach(i=>{r(i=Yc(i)),i.mark||i.ignore||i.clearMark||(i.mark=s)})}for(let s in e.nodes){let o=e.nodes[s].spec.parseDOM;o&&o.forEach(i=>{r(i=Yc(i)),i.node||i.ignore||i.mark||(i.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new gn(e,gn.schemaRules(e)))}}const ih={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},m1={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ah={ol:!0,ul:!0},ao=1,lo=2,es=4;function Uc(n,e,t){return e!=null?(e?ao:0)|(e==="full"?lo:0):n&&n.whitespace=="pre"?ao|lo:t&~es}class Ns{constructor(e,t,r,s,o,i,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=s,this.solid=o,this.options=a,this.content=[],this.activeMarks=Te.none,this.stashMarks=[],this.match=i||(a&es?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(j.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ao)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-s[0].length))}}let t=j.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(j.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let s=r[t];(this.type?this.type.allowsMarkType(s.type):x1(s.type,e))&&!s.isInSet(this.activeMarks)&&(this.activeMarks=s.addToSet(this.activeMarks),this.pendingMarks=s.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!ih.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class qc{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let s=t.topNode,o,i=Uc(null,t.preserveWhitespace,0)|(r?es:0);s?o=new Ns(s.type,s.attrs,Te.none,Te.none,!0,t.topMatch||s.type.contentMatch,i):r?o=new Ns(null,null,Te.none,Te.none,!0,null,i):o=new Ns(e.schema.topNodeType,null,Te.none,Te.none,!0,null,i),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.style;if(!r||!r.length)return t();let s=this.readStyles(e.style);if(!s)return;let[o,i]=s,a=this.top;for(let l=0;l<i.length;l++)this.removePendingMark(i[l],a);for(let l=0;l<o.length;l++)this.addPendingMark(o[l]);t();for(let l=0;l<o.length;l++)this.removePendingMark(o[l],a);for(let l=0;l<i.length;l++)this.addPendingMark(i[l])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&lo||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&ao)r.options&lo?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let s=r.content[r.content.length-1],o=e.previousSibling;(!s||o&&o.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),s;ah.hasOwnProperty(r)&&this.parser.normalizeLists&&g1(e);let o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,t));if(o?o.ignore:m1.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);let i,a=this.top,l=this.needsBlock;if(ih.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),i=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}o&&o.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),i&&this.sync(a),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,o,o.consuming===!1?s:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=Te.none,r=Te.none;if(e.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let o=this.parser.matchedStyles[s],i=e.getPropertyValue(o);if(i)for(let a=void 0;;){let l=this.parser.matchStyle(o,i,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(c=>{l.clearMark(c)&&(r=c.addToSet(r))}):t=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(t),l.consuming===!1)a=l;else break}}return[t,r]}addElementByRule(e,t,r){let s,o,i;t.node?(o=this.parser.schema.nodes[t.node],o.isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):s=this.enter(o,t.attrs||null,t.preserveWhitespace)):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}s&&this.sync(a)&&this.open--,i&&this.removePendingMark(i,a)}addAll(e,t,r){let s=t||0;for(let o=t?e.childNodes[t]:e.firstChild,i=r==null?null:e.childNodes[r];o!=i;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o);this.findAtPoint(e,s)}findPlace(e){let t,r;for(let s=this.open;s>=0;s--){let o=this.nodes[s],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,r=o,!i.length)||o.solid)break}if(!t)return!1;this.sync(r);for(let s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let s=0;s<e.marks.length;s++)(!t.type||t.type.allowsMarkType(e.marks[s].type))&&(r=e.marks[s].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let s=this.findPlace(e.create(t));return s&&this.enterInner(e,t,!0,r),s}enterInner(e,t=null,r=!1,s){this.closeExtra();let o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e);let i=Uc(e,s,o.options);o.options&es&&o.content.length==0&&(i|=es),this.nodes.push(new Ns(e,t,o.activeMarks,o.pendingMarks,r,null,i)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(s?0:1),i=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=o;l--)if(i(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=b1(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let s=this.nodes[r];if(s.pendingMarks.lastIndexOf(e)>-1)s.pendingMarks=e.removeFromSet(s.pendingMarks);else{s.activeMarks=e.removeFromSet(s.activeMarks);let i=s.popFromStashMark(e);i&&s.type&&s.type.allowsMarkType(i.type)&&(s.activeMarks=i.addToSet(s.activeMarks))}if(s==t)break}}}function g1(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&ah.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function y1(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Yc(n){let e={};for(let t in n)e[t]=n[t];return e}function x1(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let o=[],i=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&i(u))return!0}};if(i(s.contentMatch))return!0}}function b1(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class rr{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=hi(t).createDocumentFragment());let s=r,o=[];return e.forEach(i=>{if(o.length||i.marks.length){let a=0,l=0;for(;a<o.length&&l<i.marks.length;){let c=i.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)s=o.pop()[1];for(;l<i.marks.length;){let c=i.marks[l++],u=this.serializeMark(c,i.isInline,t);u&&(o.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(i,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=Ws(hi(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let o=this.serializeMark(e.marks[s],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&Ws(hi(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return Ws(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new rr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Kc(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Kc(e.marks)}}function Kc(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function hi(n){return n.document||window.document}const Gc=new WeakMap;function v1(n){let e=Gc.get(n);return e===void 0&&Gc.set(n,e=w1(n)),e}function w1(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function Ws(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],o;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=v1(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let i=s.indexOf(" ");i>0&&(t=s.slice(0,i),s=s.slice(i+1));let a,l=t?n.createElementNS(t,s):n.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let f in c)if(c[f]!=null){let h=f.indexOf(" ");h>0?l.setAttributeNS(f.slice(0,h),f.slice(h+1),c[f]):l.setAttribute(f,c[f])}}for(let f=u;f<e.length;f++){let h=e[f];if(h===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=Ws(n,h,t,r);if(l.appendChild(p),m){if(a)throw new RangeError("Multiple content holes");a=m}}}return{dom:l,contentDOM:a}}const lh=65535,ch=Math.pow(2,16);function k1(n,e){return n+e*ch}function Jc(n){return n&lh}function C1(n){return(n-(n&lh))/ch}const uh=1,dh=2,Us=4,fh=8;class ia{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&fh)>0}get deletedBefore(){return(this.delInfo&(uh|Us))>0}get deletedAfter(){return(this.delInfo&(dh|Us))>0}get deletedAcross(){return(this.delInfo&Us)>0}}class dt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&dt.empty)return dt.empty}recover(e){let t=0,r=Jc(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+C1(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+i],f=l+c;if(e<=f){let h=c?e==l?-1:e==f?1:t:t,p=l+s+(h<0?0:u);if(r)return p;let m=e==(t<0?l:f)?null:k1(a/3,e-l),g=e==l?dh:e==f?uh:Us;return(t<0?e!=l:e!=f)&&(g|=fh),new ia(p,g,m)}s+=u-c}return r?e+s:new ia(e+s,0,null)}touches(e,t){let r=0,s=Jc(t),o=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+i]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,o=0;s<this.ranges.length;s+=3){let i=this.ranges[s],a=i-(this.inverted?o:0),l=i+(this.inverted?0:o),c=this.ranges[s+t],u=this.ranges[s+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new dt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?dt.empty:new dt(e<0?[0,-e,0]:[0,0,e])}}dt.empty=new dt([]);class vr{constructor(e=[],t,r=0,s=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=s}slice(e=0,t=this.maps.length){return new vr(this.maps,this.mirror,e,t)}copy(){return new vr(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let s=e.getMirror(t);this.appendMap(e.maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e.maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new vr;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let o=this.from;o<this.to;o++){let i=this.maps[o],a=i.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this.maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new ia(e,s,null)}}const pi=Object.create(null);class tt{getMap(){return dt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=pi[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in pi)throw new RangeError("Duplicate use of step JSON ID "+e);return pi[e]=t,t.prototype.jsonID=e,t}}class ze{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ze(e,null)}static fail(e){return new ze(null,e)}static fromReplace(e,t,r,s){try{return ze.ok(e.replace(t,r,s))}catch(o){if(o instanceof ro)return ze.fail(o.message);throw o}}}function kl(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let o=n.child(s);o.content.size&&(o=o.copy(kl(o.content,e,o))),o.isInline&&(o=e(o,t,s)),r.push(o)}return j.fromArray(r)}class hn extends tt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),o=new U(kl(t.content,(i,a)=>!i.isAtom||!a.type.allowsMarkType(this.mark.type)?i:i.mark(this.mark.addToSet(i.marks)),s),t.openStart,t.openEnd);return ze.fromReplace(e,this.from,this.to,o)}invert(){return new $t(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new hn(t.pos,r.pos,this.mark)}merge(e){return e instanceof hn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new hn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new hn(t.from,t.to,e.markFromJSON(t.mark))}}tt.jsonID("addMark",hn);class $t extends tt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new U(kl(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return ze.fromReplace(e,this.from,this.to,r)}invert(){return new hn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new $t(t.pos,r.pos,this.mark)}merge(e){return e instanceof $t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new $t(t.from,t.to,e.markFromJSON(t.mark))}}tt.jsonID("removeMark",$t);class pn extends tt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ze.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ze.fromReplace(e,this.pos,this.pos+1,new U(j.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new pn(this.pos,t.marks[s]);return new pn(this.pos,this.mark)}}return new Dr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new pn(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new pn(t.pos,e.markFromJSON(t.mark))}}tt.jsonID("addNodeMark",pn);class Dr extends tt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ze.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ze.fromReplace(e,this.pos,this.pos+1,new U(j.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new pn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Dr(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Dr(t.pos,e.markFromJSON(t.mark))}}tt.jsonID("removeNodeMark",Dr);class We extends tt{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&aa(e,this.from,this.to)?ze.fail("Structure replace would overwrite content"):ze.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new dt([this.from,this.to-this.from,this.slice.size])}invert(e){return new We(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new We(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof We)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?U.empty:new U(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new We(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?U.empty:new U(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new We(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new We(t.from,t.to,U.fromJSON(e,t.slice),!!t.structure)}}tt.jsonID("replace",We);class Ue extends tt{constructor(e,t,r,s,o,i,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=o,this.insert=i,this.structure=a}apply(e){if(this.structure&&(aa(e,this.from,this.gapFrom)||aa(e,this.gapTo,this.to)))return ze.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ze.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ze.fromReplace(e,this.from,this.to,r):ze.fail("Content does not fit in gap")}getMap(){return new dt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ue(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||o>r.pos?null:new Ue(t.pos,r.pos,s,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ue(t.from,t.to,t.gapFrom,t.gapTo,U.fromJSON(e,t.slice),t.insert,!!t.structure)}}tt.jsonID("replaceAround",Ue);function aa(n,e,t){let r=n.resolve(e),s=t-e,o=r.depth;for(;s>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,s--;if(s>0){let i=r.node(o).maybeChild(r.indexAfter(o));for(;s>0;){if(!i||i.isLeaf)return!0;i=i.firstChild,s--}}return!1}function S1(n,e,t,r){let s=[],o=[],i,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),p=Math.min(c+l.nodeSize,t),m=r.addToSet(f);for(let g=0;g<f.length;g++)f[g].isInSet(m)||(i&&i.to==h&&i.mark.eq(f[g])?i.to=p:s.push(i=new $t(h,p,f[g])));a&&a.to==h?a.to=p:o.push(a=new hn(h,p,r))}}),s.forEach(l=>n.step(l)),o.forEach(l=>n.step(l))}function M1(n,e,t,r){let s=[],o=0;n.doc.nodesBetween(e,t,(i,a)=>{if(!i.isInline)return;o++;let l=null;if(r instanceof $o){let c=i.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(i.marks)&&(l=[r]):l=i.marks;if(l&&l.length){let c=Math.min(a+i.nodeSize,t);for(let u=0;u<l.length;u++){let f=l[u],h;for(let p=0;p<s.length;p++){let m=s[p];m.step==o-1&&f.eq(s[p].style)&&(h=m)}h?(h.to=c,h.step=o):s.push({style:f,from:Math.max(a,e),to:c,step:o})}}}),s.forEach(i=>n.step(new $t(i.from,i.to,i.style)))}function hh(n,e,t,r=t.contentMatch,s=!0){let o=n.doc.nodeAt(e),i=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,f=r.matchType(c.type);if(!f)i.push(new We(a,u,U.empty));else{r=f;for(let h=0;h<c.marks.length;h++)t.allowsMarkType(c.marks[h].type)||n.step(new $t(a,u,c.marks[h]));if(s&&c.isText&&t.whitespace!="pre"){let h,p=/\r?\n|\r/g,m;for(;h=p.exec(c.text);)m||(m=new U(j.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),i.push(new We(a+h.index,a+h.index+h[0].length,m))}}a=u}if(!r.validEnd){let l=r.fillBefore(j.empty,!0);n.replace(a,a,new U(l,0,0))}for(let l=i.length-1;l>=0;l--)n.step(i[l])}function T1(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Br(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),o=n.$from.index(r),i=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(o,i,t))return r;if(r==0||s.type.spec.isolating||!T1(s,o,i))break}return null}function D1(n,e,t){let{$from:r,$to:s,depth:o}=e,i=r.before(o+1),a=s.after(o+1),l=i,c=a,u=j.empty,f=0;for(let m=o,g=!1;m>t;m--)g||r.index(m)>0?(g=!0,u=j.from(r.node(m).copy(u)),f++):l--;let h=j.empty,p=0;for(let m=o,g=!1;m>t;m--)g||s.after(m+1)<s.end(m)?(g=!0,h=j.from(s.node(m).copy(h)),p++):c++;n.step(new Ue(l,c,i,a,new U(u.append(h),f,p),u.size-f,!0))}function Cl(n,e,t=null,r=n){let s=E1(n,e),o=s&&O1(r,e);return o?s.map(Qc).concat({type:e,attrs:t}).concat(o.map(Qc)):null}function Qc(n){return{type:n,attrs:null}}function E1(n,e){let{parent:t,startIndex:r,endIndex:s}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let i=o.length?o[0]:e;return t.canReplaceWith(r,s,i)?o:null}function O1(n,e){let{parent:t,startIndex:r,endIndex:s}=n,o=t.child(r),i=e.contentMatch.findWrapping(o.type);if(!i)return null;let l=(i.length?i[i.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:i}function N1(n,e,t){let r=j.empty;for(let i=t.length-1;i>=0;i--){if(r.size){let a=t[i].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=j.from(t[i].type.create(t[i].attrs,r))}let s=e.start,o=e.end;n.step(new Ue(s,o,s,o,new U(r,0,0),t.length,!0))}function I1(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(i,a)=>{if(i.isTextblock&&!i.hasMarkup(r,s)&&R1(n.doc,n.mapping.slice(o).map(a),r)){let l=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!p?l=!1:!h&&p&&(l=!0)}l===!1&&A1(n,i,a,o),hh(n,n.mapping.slice(o).map(a,1),r,void 0,l===null);let c=n.mapping.slice(o),u=c.map(a,1),f=c.map(a+i.nodeSize,1);return n.step(new Ue(u,f,u+1,f-1,new U(j.from(r.create(s,null,i.marks)),0,0),1,!0)),l===!0&&P1(n,i,a,o),!1}})}function P1(n,e,t,r){e.forEach((s,o)=>{if(s.isText){let i,a=/\r?\n|\r/g;for(;i=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+o+i.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function A1(n,e,t,r){e.forEach((s,o)=>{if(s.type==s.type.schema.linebreakReplacement){let i=n.mapping.slice(r).map(t+1+o);n.replaceWith(i,i+1,e.type.schema.text(`
`))}})}function R1(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function j1(n,e,t,r,s){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let i=t.create(r,null,s||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Ue(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new U(j.from(i),0,0),1,!0))}function wr(n,e,t=1,r){let s=n.resolve(e),o=s.depth-t,i=r&&r[r.length-1]||s.parent;if(o<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!i.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>o;c--,u--){let f=s.node(c),h=s.index(c);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(h,f.childCount),m=r&&r[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let g=r&&r[u]||f;if(!f.canReplace(h+1,f.childCount)||!g.type.validContent(p))return!1}let a=s.indexAfter(o),l=r&&r[0];return s.node(o).canReplaceWith(a,a,l?l.type:s.node(o+1).type)}function L1(n,e,t=1,r){let s=n.doc.resolve(e),o=j.empty,i=j.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){o=j.from(s.node(a).copy(o));let u=r&&r[c];i=j.from(u?u.type.create(u.attrs,i):s.node(a).copy(i))}n.step(new We(e,e,new U(o.append(i),t,t),!0))}function Cn(n,e){let t=n.resolve(e),r=t.index();return ph(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function ph(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Bo(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let o,i,a=r.index(s);if(s==r.depth?(o=r.nodeBefore,i=r.nodeAfter):t>0?(o=r.node(s+1),a++,i=r.node(s).maybeChild(a)):(o=r.node(s).maybeChild(a-1),i=r.node(s+1)),o&&!o.isTextblock&&ph(o,i)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function F1(n,e,t){let r=new We(e-t,e+t,U.empty,!0);n.step(r)}function $1(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let o=r.index(s);if(r.node(s).canReplaceWith(o,o,t))return r.before(s+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let o=r.indexAfter(s);if(r.node(s).canReplaceWith(o,o,t))return r.after(s+1);if(o<r.node(s).childCount)return null}return null}function mh(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let o=0;o<t.openStart;o++)s=s.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let i=r.depth;i>=0;i--){let a=i==r.depth?0:r.pos<=(r.start(i+1)+r.end(i+1))/2?-1:1,l=r.index(i)+(a>0?1:0),c=r.node(i),u=!1;if(o==1)u=c.canReplace(l,l,s);else{let f=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=f&&c.canReplaceWith(l,l,f[0])}if(u)return a==0?r.pos:a<0?r.before(i+1):r.after(i+1)}return null}function _o(n,e,t=e,r=U.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),o=n.resolve(t);return gh(s,o,r)?new We(e,t,r):new B1(s,o,r).fit()}function gh(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class B1{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=j.empty;for(let s=0;s<=e.depth;s++){let o=e.node(s);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=j.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let o=this.placed,i=r.depth,a=s.depth;for(;i&&a&&o.childCount==1;)o=o.firstChild.content,i--,a--;let l=new U(o,i,a);return e>-1?new Ue(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new We(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(s=0),o.type.spec.isolating&&s<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,o=null;r?(o=mi(this.unplaced.content,r-1).firstChild,s=o.content):s=this.unplaced.content;let i=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,f=null;if(t==1&&(i?c.matchType(i.type)||(f=c.fillBefore(j.from(i),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:f};if(t==2&&i&&(u=c.findWrapping(i.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=mi(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new U(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=mi(e,t);if(s.childCount<=1&&t>0){let o=e.size-t<=t+s.size;this.unplaced=new U(Yr(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new U(Yr(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let g=0;g<o.length;g++)this.openFrontierNode(o[g]);let i=this.unplaced,a=r?r.content:i.content,l=i.openStart-e,c=0,u=[],{match:f,type:h}=this.frontier[t];if(s){for(let g=0;g<s.childCount;g++)u.push(s.child(g));f=f.matchFragment(s)}let p=a.size+e-(i.content.size-i.openEnd);for(;c<a.childCount;){let g=a.child(c),y=f.matchType(g.type);if(!y)break;c++,(c>1||l==0||g.content.size)&&(f=y,u.push(yh(g.mark(h.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=Kr(this.placed,t,j.from(u)),this.frontier[t].match=f,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,y=a;g<p;g++){let b=y.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),y=b.content}this.unplaced=m?e==0?U.empty:new U(Yr(i.content,e-1,1),e-1,p<0?i.openEnd:e-1):new U(Yr(i.content,e,c),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!gi(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=gi(e,t,s,r,o);if(i){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=gi(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Kr(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),o=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,o)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Kr(this.placed,this.depth,j.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(j.empty,!0);t.childCount&&(this.placed=Kr(this.placed,this.frontier.length,t))}}function Yr(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Yr(n.firstChild.content,e-1,t)))}function Kr(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Kr(n.lastChild.content,e-1,t)))}function mi(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function yh(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,yh(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(j.empty,!0)))),n.copy(r)}function gi(n,e,t,r,s){let o=n.node(e),i=s?n.indexAfter(e):n.index(e);if(i==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,i);return a&&!_1(t,o.content,i)?a:null}function _1(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function z1(n){return n.spec.defining||n.spec.definingForContent}function H1(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),o=n.doc.resolve(t);if(gh(s,o,r))return n.step(new We(e,t,r));let i=bh(s,n.doc.resolve(t));i[i.length-1]==0&&i.pop();let a=-(s.depth+1);i.unshift(a);for(let h=s.depth,p=s.pos-1;h>0;h--,p--){let m=s.node(h).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;i.indexOf(h)>-1?a=h:s.before(h)==p&&i.splice(1,0,-h)}let l=i.indexOf(a),c=[],u=r.openStart;for(let h=r.content,p=0;;p++){let m=h.firstChild;if(c.push(m),p==r.openStart)break;h=m.content}for(let h=u-1;h>=0;h--){let p=c[h],m=z1(p.type);if(m&&!p.sameMarkup(s.node(Math.abs(a)-1)))u=h;else if(m||!p.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+u+1)%(r.openStart+1),m=c[p];if(m)for(let g=0;g<i.length;g++){let y=i[(g+l)%i.length],b=!0;y<0&&(b=!1,y=-y);let v=s.node(y-1),w=s.index(y-1);if(v.canReplaceWith(w,w,m.type,m.marks))return n.replace(s.before(y),b?o.after(y):t,new U(xh(r.content,0,r.openStart,p),p,r.openEnd))}}let f=n.steps.length;for(let h=i.length-1;h>=0&&(n.replace(e,t,r),!(n.steps.length>f));h--){let p=i[h];p<0||(e=s.before(p),t=o.after(p))}}function xh(n,e,t,r,s){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(xh(o.content,e+1,t,r,o)))}if(e>r){let o=s.contentMatchAt(0),i=o.fillBefore(n).append(n);n=i.append(o.matchFragment(i).fillBefore(j.empty,!0))}return n}function V1(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=$1(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new U(j.from(r),0,0))}function W1(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),o=bh(r,s);for(let i=0;i<o.length;i++){let a=o[i],l=i==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let i=1;i<=r.depth&&i<=s.depth;i++)if(e-r.start(i)==r.depth-i&&t>r.end(i)&&s.end(i)-t!=s.depth-i)return n.delete(r.before(i),t);n.delete(e,t)}function bh(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let o=n.start(s);if(o<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(o==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==o-1)&&t.push(s)}return t}class kr extends tt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ze.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return ze.fromReplace(e,this.pos,this.pos+1,new U(j.from(s),0,t.isLeaf?0:1))}getMap(){return dt.empty}invert(e){return new kr(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new kr(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new kr(t.pos,t.attr,t.value)}}tt.jsonID("attr",kr);class is extends tt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return ze.ok(r)}getMap(){return dt.empty}invert(e){return new is(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new is(t.attr,t.value)}}tt.jsonID("docAttr",is);let Er=class extends Error{};Er=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Er.prototype=Object.create(Error.prototype);Er.prototype.constructor=Er;Er.prototype.name="TransformError";class U1{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new vr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Er(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=U.empty){let s=_o(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new U(j.from(r),0,0))}delete(e,t){return this.replace(e,t,U.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return H1(this,e,t,r),this}replaceRangeWith(e,t,r){return V1(this,e,t,r),this}deleteRange(e,t){return W1(this,e,t),this}lift(e,t){return D1(this,e,t),this}join(e,t=1){return F1(this,e,t),this}wrap(e,t){return N1(this,e,t),this}setBlockType(e,t=e,r,s=null){return I1(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return j1(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new kr(e,t,r)),this}setDocAttribute(e,t){return this.step(new is(e,t)),this}addNodeMark(e,t){return this.step(new pn(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Te)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Dr(e,t)),this}split(e,t=1,r){return L1(this,e,t,r),this}addMark(e,t,r){return S1(this,e,t,r),this}removeMark(e,t,r){return M1(this,e,t,r),this}clearIncompatible(e,t,r){return hh(this,e,t,r),this}}const yi=Object.create(null);class de{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new q1(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=U.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let o=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:l,$to:c}=i[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?U.empty:t),a==0&&eu(e,o,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:i,$to:a}=s[o],l=e.mapping.slice(r),c=l.map(i.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),eu(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ce(e):pr(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let o=e.depth-1;o>=0;o--){let i=t<0?pr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):pr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(i)return i}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Ot(e.node(0))}static atStart(e){return pr(e,e,0,0,1)||new Ot(e)}static atEnd(e){return pr(e,e,e.content.size,e.childCount,-1)||new Ot(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=yi[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in yi)throw new RangeError("Duplicate use of selection JSON ID "+e);return yi[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ce.between(this.$anchor,this.$head).getBookmark()}}de.prototype.visible=!0;class q1{constructor(e,t){this.$from=e,this.$to=t}}let Xc=!1;function Zc(n){!Xc&&!n.parent.inlineContent&&(Xc=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ce extends de{constructor(e,t=e){Zc(e),Zc(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return de.near(r);let s=e.resolve(t.map(this.anchor));return new ce(s.parent.inlineContent?s:r,r)}replace(e,t=U.empty){if(super.replace(e,t),t==U.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ce&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new zo(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ce(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let o=de.findFrom(t,r,!0)||de.findFrom(t,-r,!0);if(o)t=o.$head;else return de.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(de.findFrom(e,-r,!0)||de.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ce(e,t)}}de.jsonID("text",ce);class zo{constructor(e,t){this.anchor=e,this.head=t}map(e){return new zo(e.map(this.anchor),e.map(this.head))}resolve(e){return ce.between(e.resolve(this.anchor),e.resolve(this.head))}}class ne extends de{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),o=e.resolve(s);return r?de.near(o):new ne(o)}content(){return new U(j.from(this.node),0,0)}eq(e){return e instanceof ne&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Sl(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ne(e.resolve(t.anchor))}static create(e,t){return new ne(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ne.prototype.visible=!1;de.jsonID("node",ne);class Sl{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new zo(r,r):new Sl(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ne.isSelectable(r)?new ne(t):de.near(t)}}class Ot extends de{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=U.empty){if(t==U.empty){e.delete(0,e.doc.content.size);let r=de.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Ot(e)}map(e){return new Ot(e)}eq(e){return e instanceof Ot}getBookmark(){return Y1}}de.jsonID("all",Ot);const Y1={map(){return this},resolve(n){return new Ot(n)}};function pr(n,e,t,r,s,o=!1){if(e.inlineContent)return ce.create(n,t);for(let i=r-(s>0?0:1);s>0?i<e.childCount:i>=0;i+=s){let a=e.child(i);if(a.isAtom){if(!o&&ne.isSelectable(a))return ne.create(n,t-(s<0?a.nodeSize:0))}else{let l=pr(n,a,t+s,s<0?a.childCount:0,s,o);if(l)return l}t+=a.nodeSize*s}return null}function eu(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof We||s instanceof Ue))return;let o=n.mapping.maps[r],i;o.forEach((a,l,c,u)=>{i==null&&(i=u)}),n.setSelection(de.near(n.doc.resolve(i),t))}const tu=1,Is=2,nu=4;class K1 extends U1{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|tu)&~Is,this.storedMarks=null,this}get selectionSet(){return(this.updated&tu)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Is,this}ensureMarks(e){return Te.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Is)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Is,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Te.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let i=this.doc.resolve(t);o=r==t?i.marks():i.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,o)),this.selection.empty||this.setSelection(de.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=nu,this}get scrolledIntoView(){return(this.updated&nu)>0}}function ru(n,e){return!e||!n?n:n.bind(e)}class Gr{constructor(e,t,r){this.name=e,this.init=ru(t.init,r),this.apply=ru(t.apply,r)}}const G1=[new Gr("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Gr("selection",{init(n,e){return n.selection||de.atStart(e.doc)},apply(n){return n.selection}}),new Gr("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Gr("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class xi{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=G1.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Gr(r.key,r.spec.state,r))})}}class gr{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let a=this.config.plugins[i];if(a.spec.appendTransaction){let l=s?s[i].n:0,c=s?s[i].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let f=0;f<this.config.plugins.length;f++)s.push(f<i?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),o=!0}s&&(s[i]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new gr(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let o=r[s];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new K1(this)}static create(e){let t=new xi(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new gr(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new xi(this.schema,e.plugins),r=t.fields,s=new gr(t);for(let o=0;o<r.length;o++){let i=r[o].name;s[i]=this.hasOwnProperty(i)?this[i]:r[o].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],o=s.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new xi(e.schema,e.plugins),o=new gr(s);return s.fields.forEach(i=>{if(i.name=="doc")o.doc=Hn.fromJSON(e.schema,t.doc);else if(i.name=="selection")o.selection=de.fromJSON(o.doc,t.selection);else if(i.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==i.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){o[i.name]=c.fromJSON.call(l,e,t[a],o);return}}o[i.name]=i.init(e,o)}}),o}}function vh(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=vh(s,e,{})),t[r]=s}return t}class Ct{constructor(e){this.spec=e,this.props={},e.props&&vh(e.props,this,this.props),this.key=e.key?e.key.key:wh("plugin")}getState(e){return e[this.key]}}const bi=Object.create(null);function wh(n){return n in bi?n+"$"+ ++bi[n]:(bi[n]=0,n+"$")}class Sn{constructor(e="key"){this.key=wh(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Ge=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},as=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let la=null;const Ut=function(n,e,t){let r=la||(la=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},J1=function(){la=null},Gn=function(n,e,t,r){return t&&(su(n,e,t,r,-1)||su(n,e,t,r,1))},Q1=/^(img|br|input|textarea|hr)$/i;function su(n,e,t,r,s){for(;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Ft(n))){let o=n.parentNode;if(!o||o.nodeType!=1||bs(n)||Q1.test(n.nodeName)||n.contentEditable=="false")return!1;e=Ge(n)+(s<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.contentEditable=="false")return!1;e=s<0?Ft(n):0}else return!1}}function Ft(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function X1(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Ft(n)}else if(n.parentNode&&!bs(n))e=Ge(n),n=n.parentNode;else return null}}function Z1(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!bs(n))e=Ge(n)+1,n=n.parentNode;else return null}}function ew(n,e,t){for(let r=e==0,s=e==Ft(n);r||s;){if(n==t)return!0;let o=Ge(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,s=s&&o==Ft(n)}}function bs(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Ho=function(n){return n.focusNode&&Gn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Pn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function tw(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function nw(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const Ht=typeof navigator<"u"?navigator:null,ou=typeof document<"u"?document:null,Mn=Ht&&Ht.userAgent||"",ca=/Edge\/(\d+)/.exec(Mn),kh=/MSIE \d/.exec(Mn),ua=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mn),at=!!(kh||ua||ca),yn=kh?document.documentMode:ua?+ua[1]:ca?+ca[1]:0,Pt=!at&&/gecko\/(\d+)/i.test(Mn);Pt&&+(/Firefox\/(\d+)/.exec(Mn)||[0,0])[1];const da=!at&&/Chrome\/(\d+)/.exec(Mn),et=!!da,Ch=da?+da[1]:0,rt=!at&&!!Ht&&/Apple Computer/.test(Ht.vendor),Or=rt&&(/Mobile\/\w+/.test(Mn)||!!Ht&&Ht.maxTouchPoints>2),yt=Or||(Ht?/Mac/.test(Ht.platform):!1),rw=Ht?/Win/.test(Ht.platform):!1,Mt=/Android \d/.test(Mn),vs=!!ou&&"webkitFontSmoothing"in ou.documentElement.style,sw=vs?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function ow(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Wt(n,e){return typeof n=="number"?n:n[e]}function iw(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function iu(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let i=t||n.dom;i;i=as(i)){if(i.nodeType!=1)continue;let a=i,l=a==o.body,c=l?ow(o):iw(a),u=0,f=0;if(e.top<c.top+Wt(r,"top")?f=-(c.top-e.top+Wt(s,"top")):e.bottom>c.bottom-Wt(r,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+Wt(s,"top")-c.top:e.bottom-c.bottom+Wt(s,"bottom")),e.left<c.left+Wt(r,"left")?u=-(c.left-e.left+Wt(s,"left")):e.right>c.right-Wt(r,"right")&&(u=e.right-c.right+Wt(s,"right")),u||f)if(l)o.defaultView.scrollBy(u,f);else{let h=a.scrollLeft,p=a.scrollTop;f&&(a.scrollTop+=f),u&&(a.scrollLeft+=u);let m=a.scrollLeft-h,g=a.scrollTop-p;e={left:e.left-m,top:e.top-g,right:e.right-m,bottom:e.bottom-g}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(i).position))break}}function aw(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let o=(e.left+e.right)/2,i=t+1;i<Math.min(innerHeight,e.bottom);i+=5){let a=n.root.elementFromPoint(o,i);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:Sh(n.dom)}}function Sh(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=as(r));return e}function lw({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Mh(t,r==0?0:r-e)}function Mh(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:o}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let dr=null;function cw(n){if(n.setActive)return n.setActive();if(dr)return n.focus(dr);let e=Sh(n);n.focus(dr==null?{get preventScroll(){return dr={preventScroll:!0},!0}}:void 0),dr||(dr=!1,Mh(e,0))}function Th(n,e){let t,r=2e8,s,o=0,i=e.top,a=e.top,l,c;for(let u=n.firstChild,f=0;u;u=u.nextSibling,f++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Ut(u).getClientRects();else continue;for(let p=0;p<h.length;p++){let m=h[p];if(m.top<=i&&m.bottom>=a){i=Math.max(m.bottom,i),a=Math.min(m.top,a);let g=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(g<r){t=u,r=g,s=g&&t.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&g&&(o=f+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!t&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(o=f+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?uw(t,s):!t||r&&t.nodeType==1?{node:n,offset:o}:Th(t,s)}function uw(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let o=sn(r,1);if(o.top!=o.bottom&&Ml(e,o))return{node:n,offset:s+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function Ml(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function dw(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function fw(n,e,t){let{node:r,offset:s}=Th(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let i=r.getBoundingClientRect();o=i.left!=i.right&&t.left>(i.left+i.right)/2?1:-1}return n.docView.posFromDOM(r,s,o)}function hw(n,e,t,r){let s=-1;for(let o=e,i=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)){let l=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&(!i&&l.left>r.left||l.top>r.top?s=a.posBefore:(!i&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),i=!0),!a.contentDOM&&s<0&&!a.node.isText)return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter}o=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function Dh(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=s;;){let i=n.childNodes[o];if(i.nodeType==1){let a=i.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Ml(e,c))return Dh(i,e,c)}}if((o=(o+1)%r)==s)break}return n}function pw(n,e){let t=n.dom.ownerDocument,r,s=0,o=nw(t,e.left,e.top);o&&({node:r,offset:s}=o);let i=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!i||!n.dom.contains(i.nodeType!=1?i.parentNode:i)){let c=n.dom.getBoundingClientRect();if(!Ml(e,c)||(i=Dh(n.dom,e,c),!i))return null}if(rt)for(let c=i;r&&c;c=as(c))c.draggable&&(r=void 0);if(i=dw(i,e),r){if(Pt&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&s++}let c;vs&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=hw(n,r,s,e))}a==null&&(a=fw(n,i,e));let l=n.docView.nearestDesc(i,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function au(n){return n.top<n.bottom||n.left<n.right}function sn(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(au(r))return r}return Array.prototype.find.call(t,au)||n.getBoundingClientRect()}const mw=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Eh(n,e,t){let{node:r,offset:s,atom:o}=n.docView.domFromPos(e,t<0?-1:1),i=vs||Pt;if(r.nodeType==3)if(i&&(mw.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=sn(Ut(r,s,s),t);if(Pt&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=sn(Ut(r,s-1,s-1),-1);if(c.top==l.top){let u=sn(Ut(r,s,s+1),-1);if(u.top!=l.top)return qr(u,u.left<c.left)}}return l}else{let l=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(l--,u=1):t<0?l--:c++,qr(sn(Ut(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&s&&(t<0||s==Ft(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return vi(l.getBoundingClientRect(),!1)}if(o==null&&s<Ft(r)){let l=r.childNodes[s];if(l.nodeType==1)return vi(l.getBoundingClientRect(),!0)}return vi(r.getBoundingClientRect(),t>=0)}if(o==null&&s&&(t<0||s==Ft(r))){let l=r.childNodes[s-1],c=l.nodeType==3?Ut(l,Ft(l)-(i?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return qr(sn(c,1),!1)}if(o==null&&s<Ft(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Ut(l,0,i?0:1):l.nodeType==1?l:null:null;if(c)return qr(sn(c,-1),!0)}return qr(sn(r.nodeType==3?Ut(r):r,-t),t>=0)}function qr(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function vi(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Oh(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function gw(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return Oh(n,e,()=>{let{node:o}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let i=Eh(n,s.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Ut(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?i.top-u.top>(u.bottom-i.top)*2:u.bottom-i.bottom>(i.bottom-u.top)*2))return!1}}return!0})}const yw=/[\u0590-\u08ac]/;function xw(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,o=!s,i=s==r.parent.content.size,a=n.domSelection();return!yw.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:i:Oh(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:f}=n.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",t,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:m,focusOffset:g}=n.domSelectionRange(),y=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==g;try{a.collapse(u,f),l&&(l!=u||c!=f)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),y})}let lu=null,cu=null,uu=!1;function bw(n,e,t){return lu==e&&cu==t?uu:(lu=e,cu=t,uu=t=="up"||t=="down"?gw(n,e,t):xw(n,e,t))}const vt=0,du=1,jn=2,Vt=3;class ws{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=vt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,i;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((i=o.pmViewDesc)&&i.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(i)+i.size:this.posAtStart}else{let o,i;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((i=o.pmViewDesc)&&i.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(i):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>Ge(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){s=!1;break}if(o.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){s=!0;break}if(o.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let o=this.getDesc(s),i;if(o&&(!t||o.node))if(r&&(i=o.nodeDOM)&&!(i.nodeType==1?i.contains(e.nodeType==1?e:e.parentNode):i==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let o=this.getDesc(s);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],o=r+s.size;if(r==e&&o!=r){for(;!s.border&&s.children.length;)s=s.children[0];return s}if(e<o)return s.descAt(e-r-s.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let o=0;r<this.children.length;r++){let i=this.children[r],a=o+i.size;if(a>e||i instanceof Ih){s=e-o;break}o=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Nh&&o.side>=0;r--);if(t<=0){let o,i=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,i=!1);return o&&t&&i&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?Ge(o.dom)+1:0}}else{let o,i=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,i=!1);return o&&i&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?Ge(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,o=-1;for(let i=r,a=0;;a++){let l=this.children[a],c=i+l.size;if(s==-1&&e<=c){let u=i+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=i;for(let f=a;f>0;f--){let h=this.children[f-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){s=Ge(h.dom)+1;break}e-=h.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=Ge(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let o=Math.min(e,t),i=Math.max(e,t);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],g=p+m.size;if(o>p&&i<g)return m.setSelection(e-p-m.border,t-p-m.border,r,s);p=g}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((Pt||rt)&&e==t){let{node:h,offset:p}=a;if(h.nodeType==3){if(u=!!(p&&h.nodeValue[p-1]==`
`),u&&p==h.nodeValue.length)for(let m=h,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(a=l={node:g.parentNode,offset:Ge(g)+1});break}let y=m.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let m=h.childNodes[p-1];u=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Pt&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let h=c.focusNode.childNodes[c.focusOffset];h&&h.contentEditable=="false"&&(s=!0)}if(!(s||u&&rt)&&Gn(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Gn(l.node,l.offset,c.focusNode,c.focusOffset))return;let f=!1;if((c.extend||e==t)&&!u){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>t){let p=a;a=l,l=p}let h=document.createRange();h.setEnd(l.node,l.offset),h.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let o=this.children[s],i=r+o.size;if(r==i?e<=i&&t>=r:e<i&&t>r){let a=r+o.border,l=i-o.border;if(e>=a&&t<=l){this.dirty=e==r||t==i?jn:du,e==a&&t==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Vt:o.markDirty(e-a,t-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?jn:Vt}r=i}this.dirty=jn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?jn:du;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class Nh extends ws{constructor(e,t,r,s){let o,i=t.type.toDOM;if(typeof i=="function"&&(i=i(r,()=>{if(!o)return s;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(i.nodeType!=1){let a=document.createElement("span");a.appendChild(i),i=a}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==vt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class vw extends ws{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Jn extends ws{constructor(e,t,r,s){super(e,[],r,s),this.mark=t}static create(e,t,r,s){let o=s.nodeViews[t.type.name],i=o&&o(t,s,r);return(!i||!i.dom)&&(i=rr.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Jn(e,t,i.dom,i.contentDOM||i.dom)}parseRule(){return this.dirty&Vt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Vt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=vt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=vt}}slice(e,t,r){let s=Jn.create(this.parent,this.mark,!0,r),o=this.children,i=this.size;t<i&&(o=pa(o,t,i,r)),e>0&&(o=pa(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=s;return s.children=o,s}}class xn extends ws{constructor(e,t,r,s,o,i,a,l,c){super(e,[],o,i),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,o,i){let a=o.nodeViews[t.type.name],l,c=a&&a(t,o,()=>{if(!l)return i;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,f=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=rr.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let h=u;return u=Rh(u,r,t),c?l=new ww(e,t,r,s,u,f||null,h,c,o,i+1):t.isText?new Vo(e,t,r,s,u,h,o):new xn(e,t,r,s,u,f||null,h,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>j.empty)}return e}matchesNode(e,t,r){return this.dirty==vt&&e.eq(this.node)&&ha(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,o=e.composing?this.localCompositionInfo(e,t):null,i=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new Cw(this,i&&i.node,e);Tw(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!f&&l.syncToMarks(u==this.node.childCount?Te.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,f,h)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,f,h)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(p=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,f,p,e)||l.updateNextNode(c,u,f,e,h,s)||l.addNode(c,u,f,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==jn)&&(i&&this.protectLocalComposition(e,i),Ph(this.contentDOM,this.children,e),Or&&Dw(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ce)||r<t||s>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let i=o.nodeValue,a=Ew(this.node.content,i,r-t,s-t);return a<0?null:{node:o,pos:a,text:i}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new vw(this,o,t,s);e.input.compositionNodes.push(i),this.children=pa(this.children,r,r+s.length,e,i)}update(e,t,r,s){return this.dirty==Vt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=vt}updateOuterDeco(e){if(ha(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Ah(this.dom,this.nodeDOM,fa(this.outerDeco,this.node,t),fa(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function fu(n,e,t,r,s){Rh(r,e,n);let o=new xn(void 0,n,e,t,r,r,r,s,0);return o.contentDOM&&o.updateChildren(s,0),o}class Vo extends xn{constructor(e,t,r,s,o,i,a){super(e,t,r,s,o,null,i,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==Vt||this.dirty!=vt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=vt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=vt,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),o=document.createTextNode(s.text);return new Vo(this.parent,s,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Vt)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Ih extends ws{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==vt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class ww extends xn{constructor(e,t,r,s,o,i,a,l,c,u){super(e,t,r,s,o,i,a,c,u),this.spec=l}update(e,t,r,s){if(this.dirty==Vt)return!1;if(this.spec.update){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,s),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Ph(n,e,t){let r=n.firstChild,s=!1;for(let o=0;o<e.length;o++){let i=e[o],a=i.dom;if(a.parentNode==n){for(;a!=r;)r=hu(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(i instanceof Jn){let l=r?r.previousSibling:n.lastChild;Ph(i.contentDOM,i.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=hu(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const ts=function(n){n&&(this.nodeName=n)};ts.prototype=Object.create(null);const Ln=[new ts];function fa(n,e,t){if(n.length==0)return Ln;let r=t?Ln[0]:new ts,s=[r];for(let o=0;o<n.length;o++){let i=n[o].type.attrs;if(i){i.nodeName&&s.push(r=new ts(i.nodeName));for(let a in i){let l=i[a];l!=null&&(t&&s.length==1&&s.push(r=new ts(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function Ah(n,e,t,r){if(t==Ln&&r==Ln)return e;let s=e;for(let o=0;o<r.length;o++){let i=r[o],a=t[o];if(o){let l;a&&a.nodeName==i.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==i.nodeName||(l=document.createElement(i.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=Ln[0]),s=l}kw(s,a||Ln[0],i)}return s}function kw(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)s.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<s.length;o++)r.indexOf(s[o])==-1&&n.classList.add(s[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function Rh(n,e,t){return Ah(n,n,Ln,fa(e,t,n.nodeType!=1))}function ha(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function hu(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Cw{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Sw(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,o=this.stack.length>>1,i=Math.min(o,e.length);for(;s<i&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=vt,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Jn.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,s){let o=-1,i;if(s>=this.preMatch.index&&(i=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&i.matchesNode(e,t,r))o=this.top.children.indexOf(i,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,s,o){let i=this.top.children[s];return i.dirty==Vt&&i.dom==i.contentDOM&&(i.dirty=jn),i.update(e,t,r,o)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,o,i){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof xn){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,f,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Vt&&ha(t,l.outerDeco));if(!h&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(f=this.recreateWrapper(l,e,t,r,s,i)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=jn,f.updateChildren(s,i+1),f.dirty=vt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,o,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=xn.create(this.top,t,r,s,o,i);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,o){let i=xn.create(this.top,e,t,r,s,o);i.contentDOM&&i.updateChildren(s,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let o=new Nh(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Jn;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Vo)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((rt||et)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new Ih(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Sw(n,e){let t=e,r=t.children.length,s=n.childCount,o=new Map,i=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Jn)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,o.set(a,s),i.push(a)}}return{index:s,matched:o,matches:i.reverse()}}function Mw(n,e){return n.type.side-e.type.side}function Tw(n,e,t,r){let s=e.locals(n),o=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(o,u),c),o+=u.nodeSize}return}let i=0,a=[],l=null;for(let c=0;;){let u,f;for(;i<s.length&&s[i].to==o;){let y=s[i++];y.widget&&(u?(f||(f=[u])).push(y):u=y)}if(u)if(f){f.sort(Mw);for(let y=0;y<f.length;y++)t(f[y],c,!!l)}else t(u,c,!!l);let h,p;if(l)p=-1,h=l,l=null;else if(c<n.childCount)p=c,h=n.child(c++);else break;for(let y=0;y<a.length;y++)a[y].to<=o&&a.splice(y--,1);for(;i<s.length&&s[i].from<=o&&s[i].to>o;)a.push(s[i++]);let m=o+h.nodeSize;if(h.isText){let y=m;i<s.length&&s[i].from<y&&(y=s[i].from);for(let b=0;b<a.length;b++)a[b].to<y&&(y=a[b].to);y<m&&(l=h.cut(y-o),h=h.cut(0,y-o),m=y,p=-1)}else for(;i<s.length&&s[i].to<m;)i++;let g=h.isInline&&!h.isLeaf?a.filter(y=>!y.inline):a.slice();r(h,g,e.forChild(o,h),p),o=m}}function Dw(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function Ew(n,e,t,r){for(let s=0,o=0;s<n.childCount&&o<=r;){let i=n.child(s++),a=o;if(o+=i.nodeSize,!i.isText)continue;let l=i.text;for(;s<n.childCount;){let c=n.child(s++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=t){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function pa(n,e,t,r,s){let o=[];for(let i=0,a=0;i<n.length;i++){let l=n[i],c=a,u=a+=l.size;c>=t||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),s&&(o.push(s),s=void 0),u>t&&o.push(l.slice(t-c,l.size,r)))}return o}function Tl(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),o=s&&s.size==0,i=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(i<0)return null;let a=r.resolve(i),l,c;if(Ho(t)){for(l=a;s&&!s.node;)s=s.parent;let u=s.node;if(s&&u.isAtom&&ne.isSelectable(u)&&s.parent&&!(u.isInline&&ew(t.focusNode,t.focusOffset,s.dom))){let f=s.posBefore;c=new ne(i==f?a:r.resolve(f))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;c=Dl(n,l,a,u)}return c}function jh(n){return n.editable?n.hasFocus():Fh(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Kt(n,e=!1){let t=n.state.selection;if(Lh(n,t),!!jh(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&et){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Gn(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Nw(n);else{let{anchor:r,head:s}=t,o,i;pu&&!(t instanceof ce)&&(t.$from.parent.inlineContent||(o=mu(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(i=mu(n,t.to))),n.docView.setSelection(r,s,n.root,e),pu&&(o&&gu(o),i&&gu(i)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Ow(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const pu=rt||et&&Ch<63;function mu(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(rt&&s&&s.contentEditable=="false")return wi(s);if((!s||s.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(s)return wi(s);if(o)return wi(o)}}function wi(n){return n.contentEditable="true",rt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function gu(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Ow(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!jh(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Nw(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setEnd(r.parentNode,Ge(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&at&&yn<=11&&(r.disabled=!0,r.disabled=!1)}function Lh(n,e){if(e instanceof ne){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(yu(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else yu(n)}function yu(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Dl(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ce.between(e,t,r)}function xu(n){return n.editable&&!n.hasFocus()?!1:Fh(n)}function Fh(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Iw(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Gn(e.node,e.offset,t.anchorNode,t.anchorOffset)}function ma(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),o=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return o&&de.findFrom(o,e)}function an(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function bu(n,e,t){let r=n.state.selection;if(r instanceof ce)if(t.indexOf("s")>-1){let{$head:s}=r,o=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=n.state.doc.resolve(s.pos+o.nodeSize*(e<0?-1:1));return an(n,new ce(r.$anchor,i))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=ma(n.state,e);return s&&s instanceof ne?an(n,s):!1}else if(!(yt&&t.indexOf("m")>-1)){let s=r.$head,o=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,i;if(!o||o.isText)return!1;let a=e<0?s.pos-o.nodeSize:s.pos;return o.isAtom||(i=n.docView.descAt(a))&&!i.contentDOM?ne.isSelectable(o)?an(n,new ne(e<0?n.state.doc.resolve(s.pos-o.nodeSize):s)):vs?an(n,new ce(n.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ne&&r.node.isInline)return an(n,new ce(e>0?r.$to:r.$from));{let s=ma(n.state,e);return s?an(n,s):!1}}}function co(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ns(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function fr(n,e){return e<0?Pw(n):Aw(n)}function Pw(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,o,i=!1;for(Pt&&t.nodeType==1&&r<co(t)&&ns(t.childNodes[r],-1)&&(i=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(ns(a,-1))s=t,o=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if($h(t))break;{let a=t.previousSibling;for(;a&&ns(a,-1);)s=t.parentNode,o=Ge(a),a=a.previousSibling;if(a)t=a,r=co(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}i?ga(n,t,r):s&&ga(n,s,o)}function Aw(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=co(t),o,i;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(ns(a,1))o=t,i=++r;else break}else{if($h(t))break;{let a=t.nextSibling;for(;a&&ns(a,1);)o=a.parentNode,i=Ge(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=co(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}o&&ga(n,o,i)}function $h(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Rw(n,e){for(;n&&e==n.childNodes.length&&!bs(n);)e=Ge(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function jw(n,e){for(;n&&!e&&!bs(n);)e=Ge(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function ga(n,e,t){if(e.nodeType!=3){let o,i;(i=Rw(e,t))?(e=i,t=0):(o=jw(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(Ho(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&Kt(n)},50)}function vu(n,e){let t=n.state.doc.resolve(e);if(!(et||rw)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),i=(o.top+o.bottom)/2;if(i>s.top&&i<s.bottom&&Math.abs(o.left-s.left)>1)return o.left<s.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),i=(o.top+o.bottom)/2;if(i>s.top&&i<s.bottom&&Math.abs(o.left-s.left)>1)return o.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function wu(n,e,t){let r=n.state.selection;if(r instanceof ce&&!r.empty||t.indexOf("s")>-1||yt&&t.indexOf("m")>-1)return!1;let{$from:s,$to:o}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let i=ma(n.state,e);if(i&&i instanceof ne)return an(n,i)}if(!s.parent.inlineContent){let i=e<0?s:o,a=r instanceof Ot?de.near(i,e):de.findFrom(i,e);return a?an(n,a):!1}return!1}function ku(n,e){if(!(n.state.selection instanceof ce))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let i=n.state.tr;return e<0?i.delete(t.pos-o.nodeSize,t.pos):i.delete(t.pos,t.pos+o.nodeSize),n.dispatch(i),!0}return!1}function Cu(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Lw(n){if(!rt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Cu(n,r,"true"),setTimeout(()=>Cu(n,r,"false"),20)}return!1}function Fw(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function $w(n,e){let t=e.keyCode,r=Fw(e);if(t==8||yt&&t==72&&r=="c")return ku(n,-1)||fr(n,-1);if(t==46&&!e.shiftKey||yt&&t==68&&r=="c")return ku(n,1)||fr(n,1);if(t==13||t==27)return!0;if(t==37||yt&&t==66&&r=="c"){let s=t==37?vu(n,n.state.selection.from)=="ltr"?-1:1:-1;return bu(n,s,r)||fr(n,s)}else if(t==39||yt&&t==70&&r=="c"){let s=t==39?vu(n,n.state.selection.from)=="ltr"?1:-1:1;return bu(n,s,r)||fr(n,s)}else{if(t==38||yt&&t==80&&r=="c")return wu(n,-1,r)||fr(n,-1);if(t==40||yt&&t==78&&r=="c")return Lw(n)||wu(n,1,r)||fr(n,1);if(r==(yt?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Bh(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:r,openStart:s,openEnd:o}=e;for(;s>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,o--;let p=r.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let i=n.someProp("clipboardSerializer")||rr.fromSchema(n.state.schema),a=Uh(),l=a.createElement("div");l.appendChild(i.serializeFragment(r,{document:a}));let c=l.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=Wh[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),f++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let h=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function _h(n,e,t,r,s){let o=s.parent.type.spec.code,i,a;if(!t&&!e)return null;let l=e&&(r||o||!t);if(l){if(n.someProp("transformPastedText",h=>{e=h(e,o||r,n)}),o)return e?new U(j.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):U.empty;let f=n.someProp("clipboardTextParser",h=>h(e,s,r,n));if(f)a=f;else{let h=s.marks(),{schema:p}=n.state,m=rr.fromSchema(p);i=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let y=i.appendChild(document.createElement("p"));g&&y.appendChild(m.serializeNode(p.text(g,h)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),i=zw(t),vs&&Hw(i);let c=i&&i.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let h=i.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;i=h}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||gn.fromSchema(n.state.schema)).parseSlice(i,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!Bw.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=Vw(Su(a,+u[1],+u[2]),u[4]);else if(a=U.maxOpen(_w(a.content,s),!0),a.openStart||a.openEnd){let f=0,h=0;for(let p=a.content.firstChild;f<a.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=a.content.lastChild;h<a.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);a=Su(a,f,h)}return n.someProp("transformPasted",f=>{a=f(a,n)}),a}const Bw=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function _w(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),o,i=[];if(n.forEach(a=>{if(!i)return;let l=s.findWrapping(a.type),c;if(!l)return i=null;if(c=i.length&&o.length&&Hh(l,o,a,i[i.length-1],0))i[i.length-1]=c;else{i.length&&(i[i.length-1]=Vh(i[i.length-1],o.length));let u=zh(a,l);i.push(u),s=s.matchType(u.type),o=l}}),i)return j.from(i)}return n}function zh(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,j.from(n));return n}function Hh(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let o=Hh(n,e,t,r.lastChild,s+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(j.from(zh(t,n,s+1))))}}function Vh(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Vh(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(j.empty,!0);return n.copy(t.append(r))}function ya(n,e,t,r,s,o){let i=e<0?n.firstChild:n.lastChild,a=i.content;return n.childCount>1&&(o=0),s<r-1&&(a=ya(a,e,t,r,s+1,o)),s>=t&&(a=e<0?i.contentMatchAt(0).fillBefore(a,o<=s).append(a):a.append(i.contentMatchAt(i.childCount).fillBefore(j.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,i.copy(a))}function Su(n,e,t){return e<n.openStart&&(n=new U(ya(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new U(ya(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Wh={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Mu=null;function Uh(){return Mu||(Mu=document.implementation.createHTMLDocument("title"))}function zw(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Uh().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&Wh[r[1].toLowerCase()])&&(n=s.map(o=>"<"+o+">").join("")+n+s.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=n,s)for(let o=0;o<s.length;o++)t=t.querySelector(s[o])||t;return t}function Hw(n){let e=n.querySelectorAll(et?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function Vw(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:o,openEnd:i}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=j.from(l.create(r[a+1],s)),o++,i++}return new U(s,o,i)}const st={},ot={},Ww={touchstart:!0,touchmove:!0};class Uw{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function qw(n){for(let e in st){let t=st[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{Kw(n,r)&&!El(n,r)&&(n.editable||!(r.type in ot))&&t(n,r)},Ww[e]?{passive:!0}:void 0)}rt&&n.dom.addEventListener("input",()=>null),xa(n)}function mn(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function Yw(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function xa(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>El(n,r))})}function El(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function Kw(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function Gw(n,e){!El(n,e)&&st[e.type]&&(n.editable||!(e.type in ot))&&st[e.type](n,e)}ot.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Yh(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Mt&&et&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Or&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,Pn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||$w(n,t)?t.preventDefault():mn(n,"key")};ot.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};ot.keypress=(n,e)=>{let t=e;if(Yh(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||yt&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ce)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode);!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,s))&&n.dispatch(n.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function Wo(n){return{left:n.clientX,top:n.clientY}}function Jw(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Ol(n,e,t,r,s){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let i=o.depth+1;i>0;i--)if(n.someProp(e,a=>i>o.depth?a(n,t,o.nodeAfter,o.before(i),s,!0):a(n,t,o.node(i),o.before(i),s,!1)))return!0;return!1}function Cr(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function Qw(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&ne.isSelectable(r)?(Cr(n,new ne(t),"pointer"),!0):!1}function Xw(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof ne&&(r=t.node);let o=n.state.doc.resolve(e);for(let i=o.depth+1;i>0;i--){let a=i>o.depth?o.nodeAfter:o.node(i);if(ne.isSelectable(a)){r&&t.$from.depth>0&&i>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?s=o.before(t.$from.depth):s=o.before(i);break}}return s!=null?(Cr(n,ne.create(n.state.doc,s),"pointer"),!0):!1}function Zw(n,e,t,r,s){return Ol(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(s?Xw(n,t):Qw(n,t))}function ek(n,e,t,r){return Ol(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function tk(n,e,t,r){return Ol(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||nk(n,t,r)}function nk(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Cr(n,ce.create(r,0,r.content.size),"pointer"),!0):!1;let s=r.resolve(e);for(let o=s.depth+1;o>0;o--){let i=o>s.depth?s.nodeAfter:s.node(o),a=s.before(o);if(i.inlineContent)Cr(n,ce.create(r,a+1,a+1+i.content.size),"pointer");else if(ne.isSelectable(i))Cr(n,ne.create(r,a),"pointer");else continue;return!0}}function Nl(n){return uo(n)}const qh=yt?"metaKey":"ctrlKey";st.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Nl(n),s=Date.now(),o="singleClick";s-n.input.lastClick.time<500&&Jw(t,n.input.lastClick)&&!t[qh]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:o};let i=n.posAtCoords(Wo(t));i&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new rk(n,i,t,!!r)):(o=="doubleClick"?ek:tk)(n,i.pos,i.inside,t)?t.preventDefault():mn(n,"pointer"))};class rk{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[qh],this.allowDefault=r.shiftKey;let o,i;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{let u=e.state.doc.resolve(t.pos);o=u.parent,i=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof ne&&c.from<=i&&c.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Pt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),mn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Kt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Wo(e))),this.updateAllowDefault(e),this.allowDefault||!t?mn(this.view,"pointer"):Zw(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||rt&&this.mightDrag&&!this.mightDrag.node.isAtom||et&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Cr(this.view,de.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):mn(this.view,"pointer")}move(e){this.updateAllowDefault(e),mn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}st.touchstart=n=>{n.input.lastTouch=Date.now(),Nl(n),mn(n,"pointer")};st.touchmove=n=>{n.input.lastTouch=Date.now(),mn(n,"pointer")};st.contextmenu=n=>Nl(n);function Yh(n,e){return n.composing?!0:rt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const sk=Mt?5e3:-1;ot.compositionstart=ot.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),uo(n,!0),n.markCursor=null;else if(uo(n),Pt&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,o=r.focusOffset;s&&s.nodeType==1&&o!=0;){let i=o<0?s.lastChild:s.childNodes[o-1];if(!i)break;if(i.nodeType==3){n.domSelection().collapse(i,i.nodeValue.length);break}else s=i,o=-1}}n.input.composing=!0}Kh(n,sk)};ot.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Kh(n,20))};function Kh(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>uo(n),e))}function Gh(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ik());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function ok(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=X1(e.focusNode,e.focusOffset),r=Z1(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let i=t.pmViewDesc;if(!(!i||!i.isText(t.nodeValue)))return r}}return t||r}function ik(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function uo(n,e=!1){if(!(Mt&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Gh(n),e||n.docView&&n.docView.dirty){let t=Tl(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function ak(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const ls=at&&yn<15||Or&&sw<604;st.copy=ot.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let o=ls?null:t.clipboardData,i=r.content(),{dom:a,text:l}=Bh(n,i);o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):ak(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function lk(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function ck(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?cs(n,r.value,null,s,e):cs(n,r.textContent,r.innerHTML,s,e)},50)}function cs(n,e,t,r,s){let o=_h(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,o||U.empty)))return!0;if(!o)return!1;let i=lk(o),a=i?n.state.tr.replaceSelectionWith(i,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Jh(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}ot.paste=(n,e)=>{let t=e;if(n.composing&&!Mt)return;let r=ls?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&cs(n,Jh(r),r.getData("text/html"),s,t)?t.preventDefault():ck(n,t)};class Qh{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Xh=yt?"altKey":"ctrlKey";st.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,o=s.empty?null:n.posAtCoords(Wo(t)),i;if(!(o&&o.pos>=s.from&&o.pos<=(s instanceof ne?s.to-1:s.to))){if(r&&r.mightDrag)i=ne.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(i=ne.create(n.state.doc,f.posBefore))}}let a=(i||n.state.selection).content(),{dom:l,text:c,slice:u}=Bh(n,a);(!t.dataTransfer.files.length||!et||Ch>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(ls?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",ls||t.dataTransfer.setData("text/plain",c),n.dragging=new Qh(u,!t[Xh],i)};st.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};ot.dragover=ot.dragenter=(n,e)=>e.preventDefault();ot.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(Wo(t));if(!s)return;let o=n.state.doc.resolve(s.pos),i=r&&r.slice;i?n.someProp("transformPasted",m=>{i=m(i,n)}):i=_h(n,Jh(t.dataTransfer),ls?null:t.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&!t[Xh]);if(n.someProp("handleDrop",m=>m(n,t,i||U.empty,a))){t.preventDefault();return}if(!i)return;t.preventDefault();let l=i?mh(n.state.doc,o.pos,i):o.pos;l==null&&(l=o.pos);let c=n.state.tr;if(a){let{node:m}=r;m?m.replace(c):c.deleteSelection()}let u=c.mapping.map(l),f=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,h=c.doc;if(f?c.replaceRangeWith(u,u,i.content.firstChild):c.replaceRange(u,u,i),c.doc.eq(h))return;let p=c.doc.resolve(u);if(f&&ne.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new ne(p));else{let m=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((g,y,b,v)=>m=v),c.setSelection(Dl(n,p,c.doc.resolve(m)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};st.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Kt(n)},20))};st.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};st.beforeinput=(n,e)=>{if(et&&Mt&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,Pn(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in ot)st[n]=ot[n];function us(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class fo{constructor(e,t){this.toDOM=e,this.spec=t||Vn,this.side=this.spec.side||0}map(e,t,r,s){let{pos:o,deleted:i}=e.mapResult(t.from+s,this.side<0?-1:1);return i?null:new bt(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof fo&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&us(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class bn{constructor(e,t){this.attrs=e,this.spec=t||Vn}map(e,t,r,s){let o=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,i=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return o>=i?null:new bt(o,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof bn&&us(this.attrs,e.attrs)&&us(this.spec,e.spec)}static is(e){return e.type instanceof bn}destroy(){}}class Il{constructor(e,t){this.attrs=e,this.spec=t||Vn}map(e,t,r,s){let o=e.mapResult(t.from+s,1);if(o.deleted)return null;let i=e.mapResult(t.to+s,-1);return i.deleted||i.pos<=o.pos?null:new bt(o.pos-r,i.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),o;return s==t.from&&!(o=e.child(r)).isText&&s+o.nodeSize==t.to}eq(e){return this==e||e instanceof Il&&us(this.attrs,e.attrs)&&us(this.spec,e.spec)}destroy(){}}class bt{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new bt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new bt(e,e,new fo(t,r))}static inline(e,t,r,s){return new bt(e,t,new bn(r,s))}static node(e,t,r,s){return new bt(e,t,new Il(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof bn}get widget(){return this.type instanceof fo}}const mr=[],Vn={};class Ve{constructor(e,t){this.local=e.length?e:mr,this.children=t.length?t:mr}static create(e,t){return t.length?ho(t,e,0,Vn):Xe}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,o){for(let i=0;i<this.local.length;i++){let a=this.local[i];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let a=this.children[i]+1;this.children[i+2].findInner(e-a,t-a,r,s+a,o)}}map(e,t,r){return this==Xe||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Vn)}mapInner(e,t,r,s,o){let i;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(i||(i=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?uk(this.children,i||[],e,t,r,s,o):i?new Ve(i.sort(Wn),mr):Xe}add(e,t){return t.length?this==Xe?Ve.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=ep(t,a,c)){for(s||(s=this.children.slice());o<s.length&&s[o]<l;)o+=3;s[o]==l?s[o+2]=s[o+2].addInner(a,u,c+1):s.splice(o,0,l,l+a.nodeSize,ho(u,a,c+1,Vn)),o+=3}});let i=Zh(o?tp(t):t,-r);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||i.splice(a--,1);return new Ve(i.length?this.local.concat(i).sort(Wn):this.local,s||this.children)}remove(e){return e.length==0||this==Xe?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let o=0;o<r.length;o+=3){let i,a=r[o]+t,l=r[o+1]+t;for(let u=0,f;u<e.length;u++)(f=e[u])&&f.from>a&&f.to<l&&(e[u]=null,(i||(i=[])).push(f));if(!i)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(i,a+1);c!=Xe?r[o+2]=c:(r.splice(o,3),o-=3)}if(s.length){for(let o=0,i;o<e.length;o++)if(i=e[o])for(let a=0;a<s.length;a++)s[a].eq(i,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Ve(s,r):Xe}forChild(e,t){if(this==Xe)return this;if(t.isLeaf)return Ve.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,i=o+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<i&&l.to>o&&l.type instanceof bn){let c=Math.max(o,l.from)-o,u=Math.min(i,l.to)-o;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new Ve(s.sort(Wn),mr);return r?new fn([a,r]):a}return r||Xe}eq(e){if(this==e)return!0;if(!(e instanceof Ve)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Pl(this.localsInner(e))}localsInner(e){if(this==Xe)return mr;if(e.inlineContent||!this.local.some(bn.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof bn||t.push(this.local[r]);return t}}Ve.empty=new Ve([],[]);Ve.removeOverlap=Pl;const Xe=Ve.empty;class fn{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,Vn));return fn.from(r)}forChild(e,t){if(t.isLeaf)return Ve.empty;let r=[];for(let s=0;s<this.members.length;s++){let o=this.members[s].forChild(e,t);o!=Xe&&(o instanceof fn?r=r.concat(o.members):r.push(o))}return fn.from(r)}eq(e){if(!(e instanceof fn)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let o=this.members[s].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let i=0;i<o.length;i++)t.push(o[i])}}return t?Pl(r?t:t.sort(Wn)):mr}static from(e){switch(e.length){case 0:return Xe;case 1:return e[0];default:return new fn(e.every(t=>t instanceof Ve)?e:e.reduce((t,r)=>t.concat(r instanceof Ve?r:r.members),[]))}}}function uk(n,e,t,r,s,o,i){let a=n.slice();for(let c=0,u=o;c<t.maps.length;c++){let f=0;t.maps[c].forEach((h,p,m,g)=>{let y=g-m-(p-h);for(let b=0;b<a.length;b+=3){let v=a[b+1];if(v<0||h>v+u-f)continue;let w=a[b]+u-f;p>=w?a[b+1]=h<=w?-2:-1:h>=u&&y&&(a[b]+=y,a[b+1]+=y)}f+=y}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+o),f=u-s;if(f<0||f>=r.content.size){l=!0;continue}let h=t.map(n[c+1]+o,-1),p=h-s,{index:m,offset:g}=r.content.findIndex(f),y=r.maybeChild(m);if(y&&g==f&&g+y.nodeSize==p){let b=a[c+2].mapInner(t,y,u+1,n[c]+o+1,i);b!=Xe?(a[c]=f,a[c+1]=p,a[c+2]=b):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=dk(a,n,e,t,s,o,i),u=ho(c,r,0,i);e=u.local;for(let f=0;f<a.length;f+=3)a[f+1]<0&&(a.splice(f,3),f-=3);for(let f=0,h=0;f<u.children.length;f+=3){let p=u.children[f];for(;h<a.length&&a[h]<p;)h+=3;a.splice(h,0,u.children[f],u.children[f+1],u.children[f+2])}}return new Ve(e.sort(Wn),a)}function Zh(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new bt(s.from+e,s.to+e,s.type))}return t}function dk(n,e,t,r,s,o,i){function a(l,c){for(let u=0;u<l.local.length;u++){let f=l.local[u].map(r,s,c);f?t.push(f):i.onRemove&&i.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+o+1);return t}function ep(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let o=0,i;o<n.length;o++)(i=n[o])&&i.from>t&&i.to<r&&((s||(s=[])).push(i),n[o]=null);return s}function tp(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function ho(n,e,t,r){let s=[],o=!1;e.forEach((a,l)=>{let c=ep(n,a,l+t);if(c){o=!0;let u=ho(c,a,t+l+1,r);u!=Xe&&s.push(l,l+a.nodeSize,u)}});let i=Zh(o?tp(n):n,-t).sort(Wn);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||(r.onRemove&&r.onRemove(i[a].spec),i.splice(a--,1));return i.length||s.length?new Ve(i,s):Xe}function Wn(n,e){return n.from-e.from||n.to-e.to}function Pl(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let o=e[s];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[s]=o.copy(o.from,r.to),Tu(e,s+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),Tu(e,s,r.copy(o.from,r.to)));break}}}return e}function Tu(n,e,t){for(;e<n.length&&Wn(t,n[e])>0;)e++;n.splice(e,0,t)}function ki(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Xe&&e.push(r)}),n.cursorWrapper&&e.push(Ve.create(n.state.doc,[n.cursorWrapper.deco])),fn.from(e)}const fk={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},hk=at&&yn<=11;class pk{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class mk{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new pk,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);at&&yn<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),hk&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,fk)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(xu(this.view)){if(this.suppressingSelectionUpdates)return Kt(this.view);if(at&&yn<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Gn(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=as(o))t.add(o);for(let o=e.anchorNode;o;o=as(o))if(t.has(o)){r=o;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&xu(e)&&!this.ignoreSelectionChange(r),o=-1,i=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let f=this.registerMutation(t[u],l);f&&(o=o<0?f.from:Math.min(f.from,o),i=i<0?f.to:Math.max(f.to,i),f.typeOver&&(a=!0))}if(Pt&&l.length){let u=l.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,h]=u;f.parentNode&&f.parentNode.parentNode==h.parentNode?h.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let h of u){let p=h.parentNode;p&&p.nodeName=="LI"&&(!f||xk(e,f)!=p)&&h.remove()}}}let c=null;o<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ho(r)&&(c=Tl(e))&&c.eq(de.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Kt(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||s)&&(o>-1&&(e.docView.markDirty(o,i),gk(e)),this.handleDOMChange(o,i,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Kt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let f=e.addedNodes[u];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,o=e.nextSibling;if(at&&yn<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:f,nextSibling:h}=e.addedNodes[u];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(o=h)}let i=s&&s.parentNode==e.target?Ge(s)+1:0,a=r.localPosFromDOM(e.target,i,-1),l=o&&o.parentNode==e.target?Ge(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Du=new WeakMap,Eu=!1;function gk(n){if(!Du.has(n)&&(Du.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Pt,Eu)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Eu=!0}}function Ou(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,i=n.domAtPos(n.state.selection.anchor);return Gn(i.node,i.offset,s,o)&&([t,r,s,o]=[s,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:o}}function yk(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return Ou(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?Ou(n,t):null}function xk(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function bk(n,e,t){let{node:r,fromOffset:s,toOffset:o,from:i,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Ho(l)||c.push({node:l.focusNode,offset:l.focusOffset})),et&&n.input.lastKeyCode===8)for(let y=o;y>s;y--){let b=r.childNodes[y-1],v=b.pmViewDesc;if(b.nodeName=="BR"&&!v){o=y;break}if(!v||v.size)break}let f=n.state.doc,h=n.someProp("domParser")||gn.fromSchema(n.state.schema),p=f.resolve(i),m=null,g=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:vk,context:p});if(c&&c[0].pos!=null){let y=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=y),m={anchor:y+i,head:b+i}}return{doc:g,sel:m,from:i,to:a}}function vk(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(rt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||rt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const wk=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function kk(n,e,t,r,s){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let I=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,F=Tl(n,I);if(F&&!n.state.selection.eq(F)){if(et&&Mt&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",W=>W(n,Pn(13,"Enter"))))return;let V=n.state.tr.setSelection(F);I=="pointer"?V.setMeta("pointer",!0):I=="key"&&V.scrollIntoView(),o&&V.setMeta("composition",o),n.dispatch(V)}return}let i=n.state.doc.resolve(e),a=i.sharedDepth(t);e=i.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=bk(n,e,t),u=n.state.doc,f=u.slice(c.from,c.to),h,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,p="end"):(h=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let m=Mk(f.content,c.doc.content,c.from,h,p);if((Or&&n.input.lastIOSEnter>Date.now()-225||Mt)&&s.some(I=>I.nodeType==1&&!wk.test(I.nodeName))&&(!m||m.endA>=m.endB)&&n.someProp("handleKeyDown",I=>I(n,Pn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof ce&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let I=Nu(n,n.state.doc,c.sel);if(I&&!I.eq(n.state.selection)){let F=n.state.tr.setSelection(I);o&&F.setMeta("composition",o),n.dispatch(F)}}return}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&m.start==m.endB&&n.state.selection instanceof ce&&(m.start>n.state.selection.from&&m.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?m.start=n.state.selection.from:m.endA<n.state.selection.to&&m.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(m.endB+=n.state.selection.to-m.endA,m.endA=n.state.selection.to)),at&&yn<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)=="  "&&(m.start--,m.endA--,m.endB--);let g=c.doc.resolveNoCache(m.start-c.from),y=c.doc.resolveNoCache(m.endB-c.from),b=u.resolve(m.start),v=g.sameParent(y)&&g.parent.inlineContent&&b.end()>=m.endA,w;if((Or&&n.input.lastIOSEnter>Date.now()-225&&(!v||s.some(I=>I.nodeName=="DIV"||I.nodeName=="P"))||!v&&g.pos<c.doc.content.size&&!g.sameParent(y)&&(w=de.findFrom(c.doc.resolve(g.pos+1),1,!0))&&w.head==y.pos)&&n.someProp("handleKeyDown",I=>I(n,Pn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>m.start&&Sk(u,m.start,m.endA,g,y)&&n.someProp("handleKeyDown",I=>I(n,Pn(8,"Backspace")))){Mt&&et&&n.domObserver.suppressSelectionUpdates();return}et&&Mt&&m.endB==m.start&&(n.input.lastAndroidDelete=Date.now()),Mt&&!v&&g.start()!=y.start()&&y.parentOffset==0&&g.depth==y.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,y=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(I){return I(n,Pn(13,"Enter"))})},20));let C=m.start,M=m.endA,k,T,E;if(v){if(g.pos==y.pos)at&&yn<=11&&g.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Kt(n),20)),k=n.state.tr.delete(C,M),T=u.resolve(m.start).marksAcross(u.resolve(m.endA));else if(m.endA==m.endB&&(E=Ck(g.parent.content.cut(g.parentOffset,y.parentOffset),b.parent.content.cut(b.parentOffset,m.endA-b.start()))))k=n.state.tr,E.type=="add"?k.addMark(C,M,E.mark):k.removeMark(C,M,E.mark);else if(g.parent.child(g.index()).isText&&g.index()==y.index()-(y.textOffset?0:1)){let I=g.parent.textBetween(g.parentOffset,y.parentOffset);if(n.someProp("handleTextInput",F=>F(n,C,M,I)))return;k=n.state.tr.insertText(I,C,M)}}if(k||(k=n.state.tr.replace(C,M,c.doc.slice(m.start-c.from,m.endB-c.from))),c.sel){let I=Nu(n,k.doc,c.sel);I&&!(et&&Mt&&n.composing&&I.empty&&(m.start!=m.endB||n.input.lastAndroidDelete<Date.now()-100)&&(I.head==C||I.head==k.mapping.map(M)-1)||at&&I.empty&&I.head==C)&&k.setSelection(I)}T&&k.ensureMarks(T),o&&k.setMeta("composition",o),n.dispatch(k.scrollIntoView())}function Nu(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Dl(n,e.resolve(t.anchor),e.resolve(t.head))}function Ck(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,o=r,i,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)o=t[u].removeFromSet(o);if(s.length==1&&o.length==0)a=s[0],i="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&o.length==1)a=o[0],i="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(j.from(c).eq(n))return{mark:a,type:i}}function Sk(n,e,t,r,s){if(t-e<=s.pos-r.pos||Ci(r,!0,!1)<s.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&t==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let i=n.resolve(Ci(o,!0,!0));return!i.parent.isTextblock||i.pos>t||Ci(i,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(i.parent.content)}function Ci(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,s++}return s}function Mk(n,e,t,r,s){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:i,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,o-Math.min(i,a));r-=i+l-o}if(i<o&&n.size<e.size){let l=r<=o&&r>=i?o-r:0;o-=l,o&&o<e.size&&Iu(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-i),i=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<n.size&&Iu(n.textBetween(o-1,o+1))&&(o+=l?1:-1),i=o+(i-a),a=o}return{start:o,endA:i,endB:a}}function Iu(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class Tk{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Uw,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Lu),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Ru(this),Au(this),this.nodeViews=ju(this),this.docView=fu(this.state.doc,Pu(this),ki(this),this.dom,this),this.domObserver=new mk(this,(r,s,o,i)=>kk(this,r,s,o,i)),this.domObserver.start(),qw(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&xa(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Lu),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,o=!1,i=!1;e.storedMarks&&this.composing&&(Gh(this),i=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=ju(this);Ek(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&xa(this),this.editable=Ru(this),Au(this);let l=ki(this),c=Pu(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,c,l);(f||!e.selection.eq(s.selection))&&(i=!0);let h=u=="preserve"&&i&&this.dom.style.overflowAnchor==null&&aw(this);if(i){this.domObserver.stop();let p=f&&(at||et)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&Dk(s.selection,e.selection);if(f){let m=et?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=ok(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=fu(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Iw(this))?Kt(this,p):(Lh(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&lw(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof ne){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&iu(this,t.getBoundingClientRect(),e)}else iu(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(s=o)}this.dragging=new Qh(e.slice,e.move,s<0?void 0:ne.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let i=0;i<this.directPlugins.length;i++){let a=this.directPlugins[i].props[e];if(a!=null&&(s=t?t(a):a))return s}let o=this.state.plugins;if(o)for(let i=0;i<o.length;i++){let a=o[i].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(at){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&cw(this.dom),Kt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return pw(this,e)}coordsAtPos(e,t=1){return Eh(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return bw(this,t||this.state,e)}pasteHTML(e,t){return cs(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return cs(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(Yw(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ki(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,J1())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Gw(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return rt&&this.root.nodeType===11&&tw(this.dom.ownerDocument)==this.dom&&yk(this,e)||e}domSelection(){return this.root.getSelection()}}function Pu(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[bt.node(0,n.state.doc.content.size,e)]}function Au(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:bt.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Ru(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Dk(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function ju(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function Ek(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function Lu(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var kn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},po={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ok=typeof navigator<"u"&&/Mac/.test(navigator.platform),Nk=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Je=0;Je<10;Je++)kn[48+Je]=kn[96+Je]=String(Je);for(var Je=1;Je<=24;Je++)kn[Je+111]="F"+Je;for(var Je=65;Je<=90;Je++)kn[Je]=String.fromCharCode(Je+32),po[Je]=String.fromCharCode(Je);for(var Si in kn)po.hasOwnProperty(Si)||(po[Si]=kn[Si]);function Ik(n){var e=Ok&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Nk&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?po:kn)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Pk=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Ak(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,o,i;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Pk?i=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),i&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function Rk(n){let e=Object.create(null);for(let t in n)e[Ak(t)]=n[t];return e}function Mi(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function jk(n){return new Ct({props:{handleKeyDown:np(n)}})}function np(n){let e=Rk(n);return function(t,r){let s=Ik(r),o,i=e[Mi(s,r)];if(i&&i(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[Mi(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||s.charCodeAt(0)>127)&&(o=kn[r.keyCode])&&o!=s){let a=e[Mi(o,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const Lk=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function rp(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Fk=(n,e,t)=>{let r=rp(n,t);if(!r)return!1;let s=Al(r);if(!s){let i=r.blockRange(),a=i&&Br(i);return a==null?!1:(e&&e(n.tr.lift(i,a).scrollIntoView()),!0)}let o=s.nodeBefore;if(ap(n,s,e,-1))return!0;if(r.parent.content.size==0&&(Nr(o,"end")||ne.isSelectable(o)))for(let i=r.depth;;i--){let a=_o(n.doc,r.before(i),r.after(i),U.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Nr(o,"end")?de.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):ne.create(l.doc,s.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(i==1||r.node(i-1).childCount>1)break}return o.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-o.nodeSize,s.pos).scrollIntoView()),!0):!1},$k=(n,e,t)=>{let r=rp(n,t);if(!r)return!1;let s=Al(r);return s?sp(n,s,e):!1},Bk=(n,e,t)=>{let r=op(n,t);if(!r)return!1;let s=Rl(r);return s?sp(n,s,e):!1};function sp(n,e,t){let r=e.nodeBefore,s=r,o=e.pos-1;for(;!s.isTextblock;o--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let i=e.nodeAfter,a=i,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=_o(n.doc,o,l,U.empty);if(!c||c.from!=o||c instanceof We&&c.slice.size>=l-o)return!1;if(t){let u=n.tr.step(c);u.setSelection(ce.create(u.doc,o)),t(u.scrollIntoView())}return!0}function Nr(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const _k=(n,e,t)=>{let{$head:r,empty:s}=n.selection,o=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=Al(r)}let i=o&&o.nodeBefore;return!i||!ne.isSelectable(i)?!1:(e&&e(n.tr.setSelection(ne.create(n.doc,o.pos-i.nodeSize)).scrollIntoView()),!0)};function Al(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function op(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const zk=(n,e,t)=>{let r=op(n,t);if(!r)return!1;let s=Rl(r);if(!s)return!1;let o=s.nodeAfter;if(ap(n,s,e,1))return!0;if(r.parent.content.size==0&&(Nr(o,"start")||ne.isSelectable(o))){let i=_o(n.doc,r.before(),r.after(),U.empty);if(i&&i.slice.size<i.to-i.from){if(e){let a=n.tr.step(i);a.setSelection(Nr(o,"start")?de.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):ne.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+o.nodeSize).scrollIntoView()),!0):!1},Hk=(n,e,t)=>{let{$head:r,empty:s}=n.selection,o=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=Rl(r)}let i=o&&o.nodeAfter;return!i||!ne.isSelectable(i)?!1:(e&&e(n.tr.setSelection(ne.create(n.doc,o.pos)).scrollIntoView()),!0)};function Rl(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Vk=(n,e)=>{let t=n.selection,r=t instanceof ne,s;if(r){if(t.node.isTextblock||!Cn(n.doc,t.from))return!1;s=t.from}else if(s=Bo(n.doc,t.from,-1),s==null)return!1;if(e){let o=n.tr.join(s);r&&o.setSelection(ne.create(o.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},Wk=(n,e)=>{let t=n.selection,r;if(t instanceof ne){if(t.node.isTextblock||!Cn(n.doc,t.to))return!1;r=t.to}else if(r=Bo(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},Uk=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),o=s&&Br(s);return o==null?!1:(e&&e(n.tr.lift(s,o).scrollIntoView()),!0)},qk=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function ip(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Yk=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),o=t.indexAfter(-1),i=ip(s.contentMatchAt(o));if(!i||!s.canReplaceWith(o,o,i))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,i.createAndFill());l.setSelection(de.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},Kk=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof Ot||r.parent.inlineContent||s.parent.inlineContent)return!1;let o=ip(s.parent.contentMatchAt(s.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let i=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(i,o.createAndFill());a.setSelection(ce.create(a.doc,i+1)),e(a.scrollIntoView())}return!0},Gk=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(wr(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),s=r&&Br(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)},Jk=(n,e)=>{let{$from:t,to:r}=n.selection,s,o=t.sharedDepth(r);return o==0?!1:(s=t.before(o),e&&e(n.tr.setSelection(ne.create(n.doc,s))),!0)};function Qk(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,o=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(s.isTextblock||Cn(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function ap(n,e,t,r){let s=e.nodeBefore,o=e.nodeAfter,i,a,l=s.type.spec.isolating||o.type.spec.isolating;if(!l&&Qk(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(i=(a=s.contentMatchAt(s.childCount)).findWrapping(o.type))&&a.matchType(i[0]||o.type).validEnd){if(t){let p=e.pos+o.nodeSize,m=j.empty;for(let b=i.length-1;b>=0;b--)m=j.from(i[b].create(null,m));m=j.from(s.copy(m));let g=n.tr.step(new Ue(e.pos-1,p,e.pos,p,new U(m,1,0),i.length,!0)),y=p+2*i.length;Cn(g.doc,y)&&g.join(y),t(g.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:de.findFrom(e,1),f=u&&u.$from.blockRange(u.$to),h=f&&Br(f);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(f,h).scrollIntoView()),!0;if(c&&Nr(o,"start",!0)&&Nr(s,"end")){let p=s,m=[];for(;m.push(p),!p.isTextblock;)p=p.lastChild;let g=o,y=1;for(;!g.isTextblock;g=g.firstChild)y++;if(p.canReplace(p.childCount,p.childCount,g.content)){if(t){let b=j.empty;for(let w=m.length-1;w>=0;w--)b=j.from(m[w].copy(b));let v=n.tr.step(new Ue(e.pos-m.length,e.pos+o.nodeSize,e.pos+y,e.pos+o.nodeSize-y,new U(b,m.length,0),0,!0));t(v.scrollIntoView())}return!0}}return!1}function lp(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,o=s.depth;for(;s.node(o).isInline;){if(!o)return!1;o--}return s.node(o).isTextblock?(t&&t(e.tr.setSelection(ce.create(e.doc,n<0?s.start(o):s.end(o)))),!0):!1}}const Xk=lp(-1),Zk=lp(1);function eC(n,e=null){return function(t,r){let{$from:s,$to:o}=t.selection,i=s.blockRange(o),a=i&&Cl(i,n,e);return a?(r&&r(t.tr.wrap(i,a).scrollIntoView()),!0):!1}}function Fu(n,e=null){return function(t,r){let s=!1;for(let o=0;o<t.selection.ranges.length&&!s;o++){let{$from:{pos:i},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(i,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let u=t.doc.resolve(c),f=u.index();s=u.parent.canReplaceWith(f,f+1,n)}})}if(!s)return!1;if(r){let o=t.tr;for(let i=0;i<t.selection.ranges.length;i++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[i];o.setBlockType(a,l,n,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function tC(n,e=null){return function(t,r){let{$from:s,$to:o}=t.selection,i=s.blockRange(o),a=!1,l=i;if(!i)return!1;if(i.depth>=2&&s.node(i.depth-1).type.compatibleContent(n)&&i.startIndex==0){if(s.index(i.depth-1)==0)return!1;let u=t.doc.resolve(i.start-2);l=new oo(u,u,i.depth),i.endIndex<i.parent.childCount&&(i=new oo(s,t.doc.resolve(o.end(i.depth)),i.depth)),a=!0}let c=Cl(l,n,e,i);return c?(r&&r(nC(t.tr,i,c,a,n).scrollIntoView()),!0):!1}}function nC(n,e,t,r,s){let o=j.empty;for(let u=t.length-1;u>=0;u--)o=j.from(t[u].type.create(t[u].attrs,o));n.step(new Ue(e.start-(r?2:0),e.end,e.start,e.end,new U(o,0,0),t.length,!0));let i=0;for(let u=0;u<t.length;u++)t[u].type==s&&(i=u+1);let a=t.length-i,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,h=!0;u<f;u++,h=!1)!h&&wr(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function rC(n){return function(e,t){let{$from:r,$to:s}=e.selection,o=r.blockRange(s,i=>i.childCount>0&&i.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?sC(e,t,n,o):oC(e,t,o):!0:!1}}function sC(n,e,t,r){let s=n.tr,o=r.end,i=r.$to.end(r.depth);o<i&&(s.step(new Ue(o-1,i,o,i,new U(j.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new oo(s.doc.resolve(r.$from.pos),s.doc.resolve(i),r.depth));const a=Br(r);if(a==null)return!1;s.lift(r,a);let l=s.mapping.map(o,-1)-1;return Cn(s.doc,l)&&s.join(l),e(s.scrollIntoView()),!0}function oC(n,e,t){let r=n.tr,s=t.parent;for(let p=t.end,m=t.endIndex-1,g=t.startIndex;m>g;m--)p-=s.child(m).nodeSize,r.delete(p-1,p+1);let o=r.doc.resolve(t.start),i=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,i.content.append(l?j.empty:j.from(s))))return!1;let f=o.pos,h=f+i.nodeSize;return r.step(new Ue(f-(a?1:0),h+(l?1:0),f+1,h-1,new U((a?j.empty:j.from(s.copy(j.empty))).append(l?j.empty:j.from(s.copy(j.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function iC(n){return function(e,t){let{$from:r,$to:s}=e.selection,o=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!o)return!1;let i=o.startIndex;if(i==0)return!1;let a=o.parent,l=a.child(i-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=j.from(c?n.create():null),f=new U(j.from(n.create(null,j.from(a.type.create(null,u)))),c?3:1,0),h=o.start,p=o.end;t(e.tr.step(new Ue(h-(c?3:1),p,h,p,f,1,!0)).scrollIntoView())}return!0}}function Uo(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,o=t.storedMarks,t}}}class qo{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:o}=r,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const f=l(...u)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),a.every(h=>h===!0)),f={...Object.fromEntries(Object.entries(r).map(([h,p])=>[h,(...g)=>{const y=this.buildProps(c,t),b=p(...g)(y);return a.push(b),f}])),run:u};return f}createCan(e){const{rawCommands:t,state:r}=this,s=!1,o=e||r.tr,i=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a={tr:e,editor:s,view:i,state:Uo({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class aC{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function Z(n,e,t){return n.config[e]===void 0&&n.parent?Z(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Z(n.parent,e,t):null}):n.config[e]}function Yo(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function cp(n){const e=[],{nodeExtensions:t,markExtensions:r}=Yo(n),s=[...t,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:s},l=Z(i,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(f=>{Object.entries(u.attributes).forEach(([h,p])=>{e.push({type:f,name:h,attribute:{...o,...p}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=Z(i,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,f])=>{const h={...o,...f};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:i.name,name:u,attribute:h})})}),e}function Ye(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function Re(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const a=o?o.split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else s==="style"?r[s]=[r[s],o].join("; "):r[s]=o}),r},{})}function ba(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>Re(t,r),{})}function up(n){return typeof n=="function"}function he(n,e=void 0,...t){return up(n)?e?n.bind(e)(...t):n(...t):n}function lC(n={}){return Object.keys(n).length===0&&n.constructor===Object}function cC(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function $u(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(t):cC(t.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function Bu(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&lC(t)?!1:t!=null))}function uC(n,e){var t;const r=cp(n),{nodeExtensions:s,markExtensions:o}=Yo(n),i=(t=s.find(c=>Z(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(b=>b.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((b,v)=>{const w=Z(v,"extendNodeSchema",f);return{...b,...w?w(c):{}}},{}),p=Bu({...h,content:he(Z(c,"content",f)),marks:he(Z(c,"marks",f)),group:he(Z(c,"group",f)),inline:he(Z(c,"inline",f)),atom:he(Z(c,"atom",f)),selectable:he(Z(c,"selectable",f)),draggable:he(Z(c,"draggable",f)),code:he(Z(c,"code",f)),whitespace:he(Z(c,"whitespace",f)),defining:he(Z(c,"defining",f)),isolating:he(Z(c,"isolating",f)),attrs:Object.fromEntries(u.map(b=>{var v;return[b.name,{default:(v=b==null?void 0:b.attribute)===null||v===void 0?void 0:v.default}]}))}),m=he(Z(c,"parseHTML",f));m&&(p.parseDOM=m.map(b=>$u(b,u)));const g=Z(c,"renderHTML",f);g&&(p.toDOM=b=>g({node:b,HTMLAttributes:ba(b,u)}));const y=Z(c,"renderText",f);return y&&(p.toText=y),[c.name,p]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(y=>y.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((y,b)=>{const v=Z(b,"extendMarkSchema",f);return{...y,...v?v(c):{}}},{}),p=Bu({...h,inclusive:he(Z(c,"inclusive",f)),excludes:he(Z(c,"excludes",f)),group:he(Z(c,"group",f)),spanning:he(Z(c,"spanning",f)),code:he(Z(c,"code",f)),attrs:Object.fromEntries(u.map(y=>{var b;return[y.name,{default:(b=y==null?void 0:y.attribute)===null||b===void 0?void 0:b.default}]}))}),m=he(Z(c,"parseHTML",f));m&&(p.parseDOM=m.map(y=>$u(y,u)));const g=Z(c,"renderHTML",f);return g&&(p.toDOM=y=>g({mark:y,HTMLAttributes:ba(y,u)})),[c.name,p]}));return new oh({topNode:i,nodes:a,marks:l})}function Ti(n,e){return e.nodes[n]||e.marks[n]||null}function _u(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const dC=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,o,i,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-o))}),t};function jl(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Ko{constructor(e){this.find=e.find,this.handler=e.handler}}const fC=(n,e)=>{if(jl(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Ps(n){var e;const{editor:t,from:r,to:s,text:o,rules:i,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const f=dC(c)+o;return i.forEach(h=>{if(u)return;const p=fC(f,h.find);if(!p)return;const m=l.state.tr,g=Uo({state:l.state,transaction:m}),y={from:r-(p[0].length-o.length),to:s},{commands:b,chain:v,can:w}=new qo({editor:t,state:g});h.handler({state:g,range:y,match:p,commands:b,chain:v,can:w})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:s,text:o}),l.dispatch(m),u=!0)}),u}function hC(n){const{editor:e,rules:t}=n,r=new Ct({state:{init(){return null},apply(s,o){const i=s.getMeta(r);if(i)return i;const a=s.getMeta("applyInputRules");return!!a&&setTimeout(()=>{const{from:c,text:u}=a,f=c+u.length;Ps({editor:e,from:c,to:f,text:u,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,a){return Ps({editor:e,from:o,to:i,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&Ps({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?Ps({editor:e,from:i.pos,to:i.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function pC(n){return typeof n=="number"}class mC{constructor(e){this.find=e.find,this.handler=e.handler}}const gC=(n,e,t)=>{if(jl(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=n,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function yC(n){const{editor:e,state:t,from:r,to:s,rule:o,pasteEvent:i,dropEvent:a}=n,{commands:l,chain:c,can:u}=new qo({editor:e,state:t}),f=[];return t.doc.nodesBetween(r,s,(p,m)=>{if(!p.isTextblock||p.type.spec.code)return;const g=Math.max(r,m),y=Math.min(s,m+p.content.size),b=p.textBetween(g-m,y-m,void 0,"￼");gC(b,o.find,i).forEach(w=>{if(w.index===void 0)return;const C=g+w.index+1,M=C+w[0].length,k={from:t.tr.mapping.map(C),to:t.tr.mapping.map(M)},T=o.handler({state:t,range:k,match:w,commands:l,chain:c,can:u,pasteEvent:i,dropEvent:a});f.push(T)})}),f.every(p=>p!==null)}const xC=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function bC(n){const{editor:e,rules:t}=n;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a=typeof DragEvent<"u"?new DragEvent("drop"):null;const l=({state:u,from:f,to:h,rule:p,pasteEvt:m})=>{const g=u.tr,y=Uo({state:u,transaction:g});if(!(!yC({editor:e,state:y,from:Math.max(f-1,0),to:h.b-1,rule:p,pasteEvent:m,dropEvent:a})||!g.steps.length))return a=typeof DragEvent<"u"?new DragEvent("drop"):null,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g};return t.map(u=>new Ct({view(f){const h=p=>{var m;r=!((m=f.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?f.dom.parentElement:null};return window.addEventListener("dragstart",h),{destroy(){window.removeEventListener("dragstart",h)}}},props:{handleDOMEvents:{drop:(f,h)=>(o=r===f.dom.parentElement,a=h,!1),paste:(f,h)=>{var p;const m=(p=h.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return i=h,s=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(f,h,p)=>{const m=f[0],g=m.getMeta("uiEvent")==="paste"&&!s,y=m.getMeta("uiEvent")==="drop"&&!o,b=m.getMeta("applyPasteRules"),v=!!b;if(!g&&!y&&!v)return;if(v){const{from:M,text:k}=b,T=M+k.length,E=xC(k);return l({rule:u,state:p,from:M,to:{b:T},pasteEvt:E})}const w=h.doc.content.findDiffStart(p.doc.content),C=h.doc.content.findDiffEnd(p.doc.content);if(!(!pC(w)||!C||w===C.b))return l({rule:u,state:p,from:w,to:C,pasteEvt:i})}}))}function vC(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class yr{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=yr.resolve(e),this.schema=uC(this.extensions,t),this.setupExtensions()}static resolve(e){const t=yr.sort(yr.flatten(e)),r=vC(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=Z(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const o=Z(r,"priority")||100,i=Z(s,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Ti(t.name,this.schema)},s=Z(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=yr.sort([...this.extensions].reverse()),r=[],s=[],o=t.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:e,type:Ti(i.name,this.schema)},l=[],c=Z(i,"addKeyboardShortcuts",a);let u={};if(i.type==="mark"&&Z(i,"exitable",a)&&(u.ArrowRight=()=>ct.handleExit({editor:e,mark:i})),c){const g=Object.fromEntries(Object.entries(c()).map(([y,b])=>[y,()=>b({editor:e})]));u={...u,...g}}const f=jk(u);l.push(f);const h=Z(i,"addInputRules",a);_u(i,e.options.enableInputRules)&&h&&r.push(...h());const p=Z(i,"addPasteRules",a);_u(i,e.options.enablePasteRules)&&p&&s.push(...p());const m=Z(i,"addProseMirrorPlugins",a);if(m){const g=m();l.push(...g)}return l}).flat();return[hC({editor:e,rules:r}),...bC({editor:e,rules:s}),...o]}get attributes(){return cp(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Yo(this.extensions);return Object.fromEntries(t.filter(r=>!!Z(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:Ye(r.name,this.schema)},i=Z(r,"addNodeView",o);if(!i)return[];const a=(l,c,u,f)=>{const h=ba(l,s);return i()({editor:e,node:l,getPos:u,decorations:f,HTMLAttributes:h,extension:r})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Ti(e.name,this.schema)};e.type==="mark"&&(!((t=he(Z(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=Z(e,"onBeforeCreate",r),o=Z(e,"onCreate",r),i=Z(e,"onUpdate",r),a=Z(e,"onSelectionUpdate",r),l=Z(e,"onTransaction",r),c=Z(e,"onFocus",r),u=Z(e,"onBlur",r),f=Z(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),f&&this.editor.on("destroy",f)})}}function wC(n){return Object.prototype.toString.call(n).slice(8,-1)}function As(n){return wC(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Go(n,e){const t={...n};return As(n)&&As(e)&&Object.keys(e).forEach(r=>{As(e[r])&&As(n[r])?t[r]=Go(n[r],e[r]):t[r]=e[r]}),t}class lt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=he(Z(this,"addOptions",{name:this.name}))),this.storage=he(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new lt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Go(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new lt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=he(Z(t,"addOptions",{name:t.name})),t.storage=he(Z(t,"addStorage",{name:t.name,options:t.options})),t}}function dp(n,e,t){const{from:r,to:s}=e,{blockSeparator:o=`

`,textSerializers:i={}}=t||{};let a="";return n.nodesBetween(r,s,(l,c,u,f)=>{var h;l.isBlock&&c>r&&(a+=o);const p=i==null?void 0:i[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:f,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,s-c))}),a}function fp(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const kC=lt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ct({key:new Sn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:o}=s,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=fp(t);return dp(r,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),CC=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),SC=(n=!1)=>({commands:e})=>e.setContent("",n),MC=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:o,$to:i})=>{n.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),p=f.blockRange(h);if(!p)return;const m=Br(p);if(a.type.isTextblock){const{defaultType:g}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(p.start,g)}(m||m===0)&&e.lift(p,m)})}),!0},TC=n=>e=>n(e),DC=()=>({state:n,dispatch:e})=>Kk(n,e),EC=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,o=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const i=r.mapping.map(e);return r.insert(i,o.content),r.setSelection(new ce(r.doc.resolve(i-1))),!0},OC=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(e){const a=s.before(o),l=s.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1},NC=n=>({tr:e,state:t,dispatch:r})=>{const s=Ye(n,t.schema),o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const l=o.before(i),c=o.after(i);e.delete(l,c).scrollIntoView()}return!0}return!1},IC=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},PC=()=>({state:n,dispatch:e})=>Lk(n,e),AC=()=>({commands:n})=>n.keyboardShortcut("Enter"),RC=()=>({state:n,dispatch:e})=>Yk(n,e);function mo(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:jl(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function va(n,e,t={}){return n.find(r=>r.type===e&&mo(r.attrs,t))}function jC(n,e,t={}){return!!va(n,e,t)}function Ll(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const s=va([...r.node.marks],e,t);if(!s)return;let o=r.index,i=n.start()+r.offset,a=o+1,l=i+r.node.nodeSize;for(va([...r.node.marks],e,t);o>0&&s.isInSet(n.parent.child(o-1).marks);)o-=1,i-=n.parent.child(o).nodeSize;for(;a<n.parent.childCount&&jC([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:i,to:l}}function Tn(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const LC=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const o=Tn(n,r.schema),{doc:i,selection:a}=t,{$from:l,from:c,to:u}=a;if(s){const f=Ll(l,o,e);if(f&&f.from<=c&&f.to>=u){const h=ce.create(i,f.from,f.to);t.setSelection(h)}}return!0},FC=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function hp(n){return n instanceof ce}function Fn(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function pp(n,e=null){if(!e)return null;const t=de.atStart(n),r=de.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,o=r.to;return e==="all"?ce.create(n,Fn(0,s,o),Fn(n.content.size,s,o)):ce.create(n,Fn(e,s,o),Fn(e,s,o))}function Fl(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const $C=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:o})=>{e={scrollIntoView:!0,...e};const i=()=>{Fl()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!hp(t.state.selection))return i(),!0;const a=pp(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},BC=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),_C=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),mp=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&mp(r)}return n};function Rs(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return mp(t)}function go(n,e,t){t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{return Array.isArray(n)&&n.length>0?j.fromArray(n.map(i=>e.nodeFromJSON(i))):e.nodeFromJSON(n)}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),go("",e,t)}if(s){if(t.errorOnInvalidContent){let i=!1,a="";const l=new oh({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(i=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?gn.fromSchema(l).parseSlice(Rs(n),t.parseOptions):gn.fromSchema(l).parse(Rs(n),t.parseOptions),t.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=gn.fromSchema(e);return t.slice?o.parseSlice(Rs(n),t.parseOptions).content:o.parse(Rs(n),t.parseOptions)}return go("",e,t)}function zC(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof We||s instanceof Ue))return;const o=n.mapping.maps[r];let i=0;o.forEach((a,l,c,u)=>{i===0&&(i=u)}),n.setSelection(de.near(n.doc.resolve(i),t))}const HC=n=>!("type"in n),VC=(n,e,t)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){t={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;try{a=go(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(i=t.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(m){return o.emit("contentError",{editor:o,error:m,disableCollaboration:()=>{console.error("[tiptap error]: Unable to disable collaboration at this point in time")}}),!1}let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},u=!0,f=!0;if((HC(a)?a:[a]).forEach(m=>{m.check(),u=u?m.isText&&m.marks.length===0:!1,f=f?m.isBlock:!1}),l===c&&f){const{parent:m}=r.doc.resolve(l);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(l-=1,c+=1)}let p;u?(Array.isArray(e)?p=e.map(m=>m.text||"").join(""):typeof e=="object"&&e&&e.text?p=e.text:p=e,r.insertText(p,l,c)):(p=a,r.replaceWith(l,c,p)),t.updateSelection&&zC(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:p}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:p})}return!0},WC=()=>({state:n,dispatch:e})=>Vk(n,e),UC=()=>({state:n,dispatch:e})=>Wk(n,e),qC=()=>({state:n,dispatch:e})=>Fk(n,e),YC=()=>({state:n,dispatch:e})=>zk(n,e),KC=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Bo(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},GC=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Bo(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},JC=()=>({state:n,dispatch:e})=>$k(n,e),QC=()=>({state:n,dispatch:e})=>Bk(n,e);function gp(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function XC(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,o,i;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Fl()||gp()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),i&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const ZC=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const o=XC(n).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function ds(n,e,t={}){const{from:r,to:s,empty:o}=n.selection,i=e?Ye(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(f,h)=>{if(f.isText)return;const p=Math.max(r,h),m=Math.min(s,h+f.nodeSize);a.push({node:f,from:p,to:m})});const l=s-r,c=a.filter(f=>i?i.name===f.node.type.name:!0).filter(f=>mo(f.node.attrs,t,{strict:!1}));return o?!!c.length:c.reduce((f,h)=>f+h.to-h.from,0)>=l}const eS=(n,e={})=>({state:t,dispatch:r})=>{const s=Ye(n,t.schema);return ds(t,s,e)?Uk(t,r):!1},tS=()=>({state:n,dispatch:e})=>Gk(n,e),nS=n=>({state:e,dispatch:t})=>{const r=Ye(n,e.schema);return rC(r)(e,t)},rS=()=>({state:n,dispatch:e})=>qk(n,e);function Jo(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function zu(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const sS=(n,e)=>({tr:t,state:r,dispatch:s})=>{let o=null,i=null;const a=Jo(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Ye(n,r.schema)),a==="mark"&&(i=Tn(n,r.schema)),s&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&t.setNodeMarkup(u,void 0,zu(c.attrs,e)),i&&c.marks.length&&c.marks.forEach(f=>{i===f.type&&t.addMark(u,u+c.nodeSize,i.create(zu(f.attrs,e)))})})}),!0):!1},oS=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),iS=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),aS=()=>({state:n,dispatch:e})=>_k(n,e),lS=()=>({state:n,dispatch:e})=>Hk(n,e),cS=()=>({state:n,dispatch:e})=>Jk(n,e),uS=()=>({state:n,dispatch:e})=>Zk(n,e),dS=()=>({state:n,dispatch:e})=>Xk(n,e);function wa(n,e,t={},r={}){return go(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const fS=(n,e=!1,t={},r={})=>({editor:s,tr:o,dispatch:i,commands:a})=>{var l,c;const{doc:u}=o;if(t.preserveWhitespace!=="full"){const f=wa(n,s.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return i&&o.replaceWith(0,u.content.size,f).setMeta("preventUpdate",!e),!0}return i&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function Qo(n,e){const t=Tn(e,n.schema),{from:r,to:s,empty:o}=n.selection,i=[];o?(n.storedMarks&&i.push(...n.storedMarks),i.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function hS(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function pS(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function $l(n){return e=>pS(e.$from,n)}function mS(n,e){const t=rr.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}function gS(n,e){const t={from:0,to:n.content.size};return dp(n,t,e)}function yS(n,e){const t=Ye(e,n.schema),{from:r,to:s}=n.selection,o=[];n.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===t.name);return i?{...i.attrs}:{}}function xS(n,e){const t=Jo(typeof e=="string"?e:e.name,n.schema);return t==="node"?yS(n,e):t==="mark"?Qo(n,e):{}}function yp(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const o=t.resolve(n-1),i=Ll(o,s.type);i&&r.push({mark:s,...i})}):t.nodesBetween(n,e,(s,o)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}function qs(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(o=>o.type===e&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}function ka(n,e,t={}){const{empty:r,ranges:s}=n.selection,o=e?Tn(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>mo(f.attrs,t,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:f,$to:h})=>{const p=f.pos,m=h.pos;n.doc.nodesBetween(p,m,(g,y)=>{if(!g.isText&&!g.marks.length)return;const b=Math.max(p,y),v=Math.min(m,y+g.nodeSize),w=v-b;i+=w,a.push(...g.marks.map(C=>({mark:C,from:b,to:v})))})}),i===0)return!1;const l=a.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>mo(f.mark.attrs,t,{strict:!1})).reduce((f,h)=>f+h.to-h.from,0),c=a.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,h)=>f+h.to-h.from,0);return(l>0?l+c:l)>=i}function bS(n,e,t={}){if(!e)return ds(n,null,t)||ka(n,null,t);const r=Jo(e,n.schema);return r==="node"?ds(n,e,t):r==="mark"?ka(n,e,t):!1}function Hu(n,e){const{nodeExtensions:t}=Yo(e),r=t.find(i=>i.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=he(Z(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function xp(n,{checkChildren:e}={checkChildren:!0}){if(n.isText)return!n.text;if(n.content.childCount===0)return!0;if(n.isLeaf)return!1;if(e){let t=!0;return n.content.forEach(r=>{t!==!1&&(xp(r)||(t=!1))}),t}return!1}function vS(n){return n instanceof ne}function wS(n,e,t){var r;const{selection:s}=e;let o=null;if(hp(s)&&(o=s.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:i}=s;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,f,h)=>{if(c)return!1;if(u.isInline){const p=!h||h.type.allowsMarkType(t),m=!!t.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(t));c=p&&m}return!c}),c})}const kS=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:o}=t,{empty:i,ranges:a}=o,l=Tn(n,r.schema);if(s)if(i){const c=Qo(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(u,f,(h,p)=>{const m=Math.max(p,u),g=Math.min(p+h.nodeSize,f);h.marks.find(b=>b.type===l)?h.marks.forEach(b=>{l===b.type&&t.addMark(m,g,l.create({...b.attrs,...e}))}):t.addMark(m,g,l.create(e))})});return wS(r,t,l)},CS=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),SS=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const o=Ye(n,t.schema);return o.isTextblock?s().command(({commands:i})=>Fu(o,e)(t)?!0:i.clearNodes()).command(({state:i})=>Fu(o,e)(i,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},MS=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=Fn(n,0,r.content.size),o=ne.create(r,s);e.setSelection(o)}return!0},TS=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n,i=ce.atStart(r).from,a=ce.atEnd(r).to,l=Fn(s,i,a),c=Fn(o,i,a),u=ce.create(r,l,c);e.setSelection(u)}return!0},DS=n=>({state:e,dispatch:t})=>{const r=Ye(n,e.schema);return iC(r)(e,t)};function Vu(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const ES=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:o,doc:i}=e,{$from:a,$to:l}=o,c=s.extensionManager.attributes,u=qs(c,a.node().type.name,a.node().attrs);if(o instanceof ne&&o.node.isBlock)return!a.parentOffset||!wr(i,a.pos)?!1:(r&&(n&&Vu(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:hS(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=f&&h?[{type:h,attrs:u}]:void 0,m=wr(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&wr(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(m=!0,p=h?[{type:h,attrs:u}]:void 0),r){if(m&&(o instanceof ce&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),h&&!f&&!a.parentOffset&&a.parent.type!==h)){const g=e.mapping.map(a.before()),y=e.doc.resolve(g);a.node(-1).canReplaceWith(y.index(),y.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}n&&Vu(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return m},OS=n=>({tr:e,state:t,dispatch:r,editor:s})=>{var o;const i=Ye(n,t.schema),{$from:a,$to:l}=t.selection,c=t.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==i)return!1;const f=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==i||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let y=j.empty;const b=a.index(-1)?1:a.index(-2)?2:3;for(let T=a.depth-b;T>=a.depth-3;T-=1)y=j.from(a.node(T).copy(y));const v=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,w=qs(f,a.node().type.name,a.node().attrs),C=((o=i.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(w))||void 0;y=y.append(j.from(i.createAndFill(null,C)||void 0));const M=a.before(a.depth-(b-1));e.replace(M,a.after(-v),new U(y,4-b,0));let k=-1;e.doc.nodesBetween(M,e.doc.content.size,(T,E)=>{if(k>-1)return!1;T.isTextblock&&T.content.size===0&&(k=E+1)}),k>-1&&e.setSelection(ce.near(e.doc.resolve(k))),e.scrollIntoView()}return!0}const h=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,p=qs(f,u.type.name,u.attrs),m=qs(f,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const g=h?[{type:i,attrs:p},{type:h,attrs:m}]:[{type:i,attrs:p}];if(!wr(e.doc,a.pos,2))return!1;if(r){const{selection:y,storedMarks:b}=t,{splittableMarks:v}=s.extensionManager,w=b||y.$to.parentOffset&&y.$from.marks();if(e.split(a.pos,2,g).scrollIntoView(),!w||!r)return!0;const C=w.filter(M=>v.includes(M.type.name));e.ensureMarks(C)}return!0},Di=(n,e)=>{const t=$l(i=>i.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Cn(n.doc,t.pos)&&n.join(t.pos),!0},Ei=(n,e)=>{const t=$l(i=>i.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Cn(n.doc,r)&&n.join(r),!0},NS=(n,e,t,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:f,splittableMarks:h}=s.extensionManager,p=Ye(n,i.schema),m=Ye(e,i.schema),{selection:g,storedMarks:y}=i,{$from:b,$to:v}=g,w=b.blockRange(v),C=y||g.$to.parentOffset&&g.$from.marks();if(!w)return!1;const M=$l(k=>Hu(k.type.name,f))(g);if(w.depth>=1&&M&&w.depth-M.depth<=1){if(M.node.type===p)return c.liftListItem(m);if(Hu(M.node.type.name,f)&&p.validContent(M.node.content)&&a)return l().command(()=>(o.setNodeMarkup(M.pos,p),!0)).command(()=>Di(o,p)).command(()=>Ei(o,p)).run()}return!t||!C||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>Di(o,p)).command(()=>Ei(o,p)).run():l().command(()=>{const k=u().wrapInList(p,r),T=C.filter(E=>h.includes(E.type.name));return o.ensureMarks(T),k?!0:c.clearNodes()}).wrapInList(p,r).command(()=>Di(o,p)).command(()=>Ei(o,p)).run()},IS=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=t,i=Tn(n,r.schema);return ka(r,i,e)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,e)},PS=(n,e,t={})=>({state:r,commands:s})=>{const o=Ye(n,r.schema),i=Ye(e,r.schema);return ds(r,o,t)?s.setNode(i):s.setNode(o,t)},AS=(n,e={})=>({state:t,commands:r})=>{const s=Ye(n,t.schema);return ds(t,s,e)?r.lift(s):r.wrapIn(s,e)},RS=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let o;if(s.spec.isInputRules&&(o=s.getState(n))){if(e){const i=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},jS=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},LS=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=t,l=Tn(n,r.schema),{$from:c,empty:u,ranges:f}=a;if(!s)return!0;if(u&&i){let{from:h,to:p}=a;const m=(o=c.marks().find(y=>y.type===l))===null||o===void 0?void 0:o.attrs,g=Ll(c,l,m);g&&(h=g.from,p=g.to),t.removeMark(h,p,l)}else f.forEach(h=>{t.removeMark(h.$from.pos,h.$to.pos,l)});return t.removeStoredMark(l),!0},FS=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let o=null,i=null;const a=Jo(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Ye(n,r.schema)),a==="mark"&&(i=Tn(n,r.schema)),s&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(f,h)=>{o&&o===f.type&&t.setNodeMarkup(h,void 0,{...f.attrs,...e}),i&&f.marks.length&&f.marks.forEach(p=>{if(i===p.type){const m=Math.max(h,c),g=Math.min(h+f.nodeSize,u);t.addMark(m,g,i.create({...p.attrs,...e}))}})})}),!0):!1},$S=(n,e={})=>({state:t,dispatch:r})=>{const s=Ye(n,t.schema);return eC(s,e)(t,r)},BS=(n,e={})=>({state:t,dispatch:r})=>{const s=Ye(n,t.schema);return tC(s,e)(t,r)};var _S=Object.freeze({__proto__:null,blur:CC,clearContent:SC,clearNodes:MC,command:TC,createParagraphNear:DC,cut:EC,deleteCurrentNode:OC,deleteNode:NC,deleteRange:IC,deleteSelection:PC,enter:AC,exitCode:RC,extendMarkRange:LC,first:FC,focus:$C,forEach:BC,insertContent:_C,insertContentAt:VC,joinBackward:qC,joinDown:UC,joinForward:YC,joinItemBackward:KC,joinItemForward:GC,joinTextblockBackward:JC,joinTextblockForward:QC,joinUp:WC,keyboardShortcut:ZC,lift:eS,liftEmptyBlock:tS,liftListItem:nS,newlineInCode:rS,resetAttributes:sS,scrollIntoView:oS,selectAll:iS,selectNodeBackward:aS,selectNodeForward:lS,selectParentNode:cS,selectTextblockEnd:uS,selectTextblockStart:dS,setContent:fS,setMark:kS,setMeta:CS,setNode:SS,setNodeSelection:MS,setTextSelection:TS,sinkListItem:DS,splitBlock:ES,splitListItem:OS,toggleList:NS,toggleMark:IS,toggleNode:PS,toggleWrap:AS,undoInputRule:RS,unsetAllMarks:jS,unsetMark:LS,updateAttributes:FS,wrapIn:$S,wrapInList:BS});const zS=lt.create({name:"commands",addCommands(){return{..._S}}}),HS=lt.create({name:"editable",addProseMirrorPlugins(){return[new Ct({key:new Sn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),VS=lt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Ct({key:new Sn("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),WS=lt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:f}=l,{pos:h,parent:p}=f,m=f.parent.isTextblock&&h>0?a.doc.resolve(h-1):f,g=m.parent.type.spec.isolating,y=f.pos-f.parentOffset,b=g&&m.parent.childCount===1?y===f.pos:de.atStart(c).from===h;return!u||!p.type.isTextblock||p.textContent.length||!b||b&&f.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Fl()||gp()?o:s},addProseMirrorPlugins(){return[new Ct({key:new Sn("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(m=>m.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:s,from:o,to:i}=e.selection,a=de.atStart(e.doc).from,l=de.atEnd(e.doc).to;if(s||!(o===a&&i===l)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const f=t.tr,h=Uo({state:t,transaction:f}),{commands:p}=new qo({editor:this.editor,state:h});if(p.clearNodes(),!!f.steps.length)return f}})]}}),US=lt.create({name:"tabindex",addProseMirrorPlugins(){return[new Ct({key:new Sn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class An{get name(){return this.node.type.name}constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new An(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new An(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new An(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,o=this.pos+r+1,i=this.resolvedPos.doc.resolve(o);if(!s&&i.depth<=this.depth)return;const a=new An(i,this.editor,s,s?t:null);s&&(a.actualDepth=this.depth+1),e.push(new An(i,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const o=s.node.attrs,i=Object.keys(t);for(let a=0;a<i.length;a+=1){const l=i[a];if(o[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(t);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===e&&o.every(l=>t[l]===i.node.attrs[l])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(e,t,r))))}),s}setAttribute(e){const t=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(t.from).run()}}const qS=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function YS(n,e,t){const r=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}let KS=class extends aC{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t}},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=YS(qS,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=up(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});this.view.updateState(s)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(s=>!s.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[HS,kC.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),zS,VS,WS,US]:[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new yr(s,this)}createCommandManager(){this.commandManager=new qo({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let e;try{e=wa(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),e=wa(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const t=pp(e,this.options.autofocus);this.view=new Tk(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:gr.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),o=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return xS(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return bS(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return mS(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return gS(this.state.doc,{blockSeparator:t,textSerializers:{...fp(this.schema),...r}})}get isEmpty(){return xp(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new An(t,this)}get $doc(){return this.$pos(0)}};function Qn(n){return new Ko({find:n.find,handler:({state:e,range:t,match:r})=>{const s=he(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=e,i=r[r.length-1],a=r[0];if(i){const l=a.search(/\S/),c=t.from+a.indexOf(i),u=c+i.length;if(yp(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(g=>g===n.type&&g!==p.mark.type)).filter(p=>p.to>c).length)return null;u<t.to&&o.delete(u,t.to),c>t.from&&o.delete(t.from+l,c);const h=t.from+l+i.length;o.addMark(t.from+l,h,n.type.create(s||{})),o.removeStoredMark(n.type)}}})}function GS(n){return new Ko({find:n.find,handler:({state:e,range:t,match:r})=>{const s=he(n.getAttributes,void 0,r)||{},{tr:o}=e,i=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=i+c;u>a?u=a:a=u+r[1].length;const f=r[0][r[0].length-1];o.insertText(f,i+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?i:i-1;o.insert(c,n.type.create(s)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()}})}function Ca(n){return new Ko({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),o=he(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)}})}function fs(n){return new Ko({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const o=he(n.getAttributes,void 0,r)||{},i=e.tr.delete(t.from,t.to),l=i.doc.resolve(t.from).blockRange(),c=l&&Cl(l,n.type,o);if(!c)return null;if(i.wrap(l,c),n.keepMarks&&n.editor){const{selection:f,storedMarks:h}=e,{splittableMarks:p}=n.editor.extensionManager,m=h||f.$to.parentOffset&&f.$from.marks();if(m){const g=m.filter(y=>p.includes(y.type.name));i.ensureMarks(g)}}if(n.keepAttributes){const f=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(f,o).run()}const u=i.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Cn(i.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&i.join(t.from-1)}})}class ct{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=he(Z(this,"addOptions",{name:this.name}))),this.storage=he(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ct(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Go(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new ct(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=he(Z(t,"addOptions",{name:t.name})),t.storage=he(Z(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=i.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}let pt=class Sa{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=he(Z(this,"addOptions",{name:this.name}))),this.storage=he(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Sa(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Go(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Sa(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=he(Z(t,"addOptions",{name:t.name})),t.storage=he(Z(t,"addStorage",{name:t.name,options:t.options})),t}};function Xn(n){return new mC({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const o=he(n.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),f=t.from+l.indexOf(a),h=f+a.length;if(yp(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(y=>y===n.type&&y!==m.mark.type)).filter(m=>m.to>f).length)return null;h<t.to&&i.delete(h,t.to),f>t.from&&i.delete(t.from+u,f),c=t.from+u+a.length,i.addMark(t.from+u,c,n.type.create(o||{})),i.removeStoredMark(n.type)}}})}var sr={root:"m_dd3f7539",typographyStylesProvider:"m_d37966d9",content:"m_c2204cc2",linkEditorDropdown:"m_8a991b4f",control:"m_c2207da6",controlsGroup:"m_2ab47ef2",linkEditor:"m_b67b711e",linkEditorInput:"m_296cf94c",linkEditorExternalControl:"m_cfef614",linkEditorSave:"m_3b28e7bb",toolbar:"m_4574a3c4",taskList:"m_8b44009a"};const JS={linkControlLabel:"Link",colorPickerControlLabel:"Text color",highlightControlLabel:"Highlight text",colorControlLabel:n=>`Set text color ${n}`,boldControlLabel:"Bold",italicControlLabel:"Italic",underlineControlLabel:"Underline",strikeControlLabel:"Strikethrough",clearFormattingControlLabel:"Clear formatting",unlinkControlLabel:"Remove link",bulletListControlLabel:"Bullet list",orderedListControlLabel:"Ordered list",h1ControlLabel:"Heading 1",h2ControlLabel:"Heading 2",h3ControlLabel:"Heading 3",h4ControlLabel:"Heading 4",h5ControlLabel:"Heading 5",h6ControlLabel:"Heading 6",blockquoteControlLabel:"Blockquote",alignLeftControlLabel:"Align text: left",alignCenterControlLabel:"Align text: center",alignRightControlLabel:"Align text: right",alignJustifyControlLabel:"Align text: justify",codeControlLabel:"Code",codeBlockControlLabel:"Code block",subscriptControlLabel:"Subscript",superscriptControlLabel:"Superscript",unsetColorControlLabel:"Unset color",hrControlLabel:"Horizontal line",undoControlLabel:"Undo",redoControlLabel:"Redo",tasksControlLabel:"Task list",tasksSinkLabel:"Decrease task level",tasksLiftLabel:"Increase task level",linkEditorInputLabel:"Enter URL",linkEditorInputPlaceholder:"https://example.com/",linkEditorExternalLink:"Open link in a new tab",linkEditorInternalLink:"Open link in the same tab",linkEditorSave:"Save",colorPickerCancel:"Cancel",colorPickerClear:"Clear color",colorPickerColorPicker:"Color picker",colorPickerPalette:"Color palette",colorPickerSave:"Save",colorPickerColorLabel:n=>`Set text color ${n}`},[QS,Dn]=xd("RichTextEditor component was not found in tree"),XS=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},ZS=({renderers:n})=>Ee.createElement(Ee.Fragment,null,Object.entries(n).map(([e,t])=>nd.createPortal(t.reactElement,t.element,e)));class eM extends Ee.Component{constructor(e){super(e),this.editorContentRef=Ee.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?Ta.flushSync(e):e()}setRenderer(e,t){this.maybeFlushSync(()=>{this.setState(({renderers:r})=>({renderers:{...r,[e]:t}}))})}removeRenderer(e){this.maybeFlushSync(()=>{this.setState(({renderers:t})=>{const r={...t};return delete r[e],{renderers:r}})})}componentWillUnmount(){const{editor:e}=this.props;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{ref:XS(t,this.editorContentRef),...r}),Ee.createElement(ZS,{renderers:this.state.renderers}))}}const tM=x.forwardRef((n,e)=>{const t=Ee.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return Ee.createElement(eM,{key:t,innerRef:e,...n})}),Wu=Ee.memo(tM);class nM extends KS{constructor(){super(...arguments),this.contentComponent=null}}var bp={exports:{}},Oi={},Ni={exports:{}},Ii={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uu;function rM(){if(Uu)return Ii;Uu=1;var n=Ee;function e(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,o=n.useLayoutEffect,i=n.useDebugValue;function a(f,h){var p=h(),m=r({inst:{value:p,getSnapshot:h}}),g=m[0].inst,y=m[1];return o(function(){g.value=p,g.getSnapshot=h,l(g)&&y({inst:g})},[f,p,h]),s(function(){return l(g)&&y({inst:g}),f(function(){l(g)&&y({inst:g})})},[f]),i(p),p}function l(f){var h=f.getSnapshot;f=f.value;try{var p=h();return!t(f,p)}catch{return!0}}function c(f,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Ii.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,Ii}var qu;function sM(){return qu||(qu=1,Ni.exports=rM()),Ni.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yu;function oM(){if(Yu)return Oi;Yu=1;var n=Ee,e=sM();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,o=n.useRef,i=n.useEffect,a=n.useMemo,l=n.useDebugValue;return Oi.useSyncExternalStoreWithSelector=function(c,u,f,h,p){var m=o(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=a(function(){function b(k){if(!v){if(v=!0,w=k,k=h(k),p!==void 0&&g.hasValue){var T=g.value;if(p(T,k))return C=T}return C=k}if(T=C,r(w,k))return T;var E=h(k);return p!==void 0&&p(T,E)?T:(w=k,C=E)}var v=!1,w,C,M=f===void 0?null:f;return[function(){return b(u())},M===null?void 0:function(){return b(M())}]},[u,f,h,p]);var y=s(c,m[0],m[1]);return i(function(){g.hasValue=!0,g.value=y},[y]),l(y),y},Oi}bp.exports=oM();var iM=bp.exports;function aM(n){let e=0,t=0,r={editor:n,transactionNumber:0},s=n;const o=new Set;return{getSnapshot(){return e===t||(t=e,r={editor:s,transactionNumber:e}),r},getServerSnapshot(){return{editor:null,transactionNumber:0}},subscribe(a){return o.add(a),()=>{o.delete(a)}},watch(a){if(s=a,s){const l=()=>{e+=1,o.forEach(u=>u())},c=s;return c.on("transaction",l),()=>{c.off("transaction",l)}}}}}function lM(n){const[e]=x.useState(()=>aM(n.editor)),t=iM.useSyncExternalStoreWithSelector(e.subscribe,e.getSnapshot,e.getServerSnapshot,n.selector,n.equalityFn);return x.useEffect(()=>e.watch(n.editor),[n.editor]),x.useDebugValue(t),t}const cM=!1,Ma=typeof window>"u",uM=Ma||!!(typeof window<"u"&&window.next);function js(n){const e=new nM(n.current);return e.on("beforeCreate",(...t)=>{var r,s;return(s=(r=n.current).onBeforeCreate)===null||s===void 0?void 0:s.call(r,...t)}),e.on("blur",(...t)=>{var r,s;return(s=(r=n.current).onBlur)===null||s===void 0?void 0:s.call(r,...t)}),e.on("create",(...t)=>{var r,s;return(s=(r=n.current).onCreate)===null||s===void 0?void 0:s.call(r,...t)}),e.on("destroy",(...t)=>{var r,s;return(s=(r=n.current).onDestroy)===null||s===void 0?void 0:s.call(r,...t)}),e.on("focus",(...t)=>{var r,s;return(s=(r=n.current).onFocus)===null||s===void 0?void 0:s.call(r,...t)}),e.on("selectionUpdate",(...t)=>{var r,s;return(s=(r=n.current).onSelectionUpdate)===null||s===void 0?void 0:s.call(r,...t)}),e.on("transaction",(...t)=>{var r,s;return(s=(r=n.current).onTransaction)===null||s===void 0?void 0:s.call(r,...t)}),e.on("update",(...t)=>{var r,s;return(s=(r=n.current).onUpdate)===null||s===void 0?void 0:s.call(r,...t)}),e.on("contentError",(...t)=>{var r,s;return(s=(r=n.current).onContentError)===null||s===void 0?void 0:s.call(r,...t)}),e}function dM(n={},e=[]){const t=x.useRef(n),[r,s]=x.useState(()=>{if(n.immediatelyRender===void 0)return Ma||uM?null:js(t);if(n.immediatelyRender&&Ma&&cM)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return n.immediatelyRender?js(t):null}),o=x.useRef(r);return o.current=r,x.useDebugValue(r),x.useEffect(()=>{const i=l=>{l&&setTimeout(()=>{l!==o.current&&!l.isDestroyed&&l.destroy()})};let a=o.current;return a?!Array.isArray(e)||e.length===0?(a.setOptions(n),()=>i(a)):(a.destroy(),a=js(t),s(a),()=>i(a)):(a=js(t),s(a),()=>i(a))},e),lM({editor:r,selector:({transactionNumber:i})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&i===0?0:i+1}),r}const fM=x.createContext({editor:null});fM.Consumer;const hM=x.createContext({onDragStart:void 0}),pM=()=>x.useContext(hM);Ee.forwardRef((n,e)=>{const{onDragStart:t}=pM(),r=n.as||"div";return Ee.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const mM={},Bl=Ne((n,e)=>{const t=ie("RichTextEditorContent",mM,n),{classNames:r,className:s,style:o,styles:i,vars:a,...l}=t,c=Dn();return c.withTypographyStyles?d.jsx(pl,{...c.getStyles("typographyStylesProvider",{className:s,style:o,styles:i,classNames:r}),unstyled:c.unstyled,ref:e,children:d.jsx(ue,{component:Wu,editor:c.editor,...c.getStyles("content",{classNames:r,styles:i}),...l})}):d.jsx(ue,{component:Wu,editor:c.editor,...c.getStyles("content",{classNames:r,styles:i,className:s,style:o}),...l})});Bl.classes=sr;Bl.displayName="@mantine/tiptap/RichTextEditorContent";function me(n){return d.jsx("svg",{...n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})}function gM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z"}),d.jsx("path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7"})]})}function yM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M11 5l6 0"}),d.jsx("path",{d:"M7 19l6 0"}),d.jsx("path",{d:"M14 5l-4 14"})]})}function xM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M7 5v5a5 5 0 0 0 10 0v-5"}),d.jsx("path",{d:"M5 19h14"})]})}function bM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M5 12l14 0"}),d.jsx("path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5"})]})}function vM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M17 15l4 4m0 -4l-4 4"}),d.jsx("path",{d:"M7 6v-1h11v1"}),d.jsx("path",{d:"M7 19l4 0"}),d.jsx("path",{d:"M13 5l-4 14"})]})}function wM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M19 18v-8l-2 2"}),d.jsx("path",{d:"M4 6v12"}),d.jsx("path",{d:"M12 6v12"}),d.jsx("path",{d:"M11 18h2"}),d.jsx("path",{d:"M3 18h2"}),d.jsx("path",{d:"M4 12h8"}),d.jsx("path",{d:"M3 6h2"}),d.jsx("path",{d:"M11 6h2"})]})}function kM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M17 12a2 2 0 1 1 4 0c0 .591 -.417 1.318 -.816 1.858l-3.184 4.143l4 0"}),d.jsx("path",{d:"M4 6v12"}),d.jsx("path",{d:"M12 6v12"}),d.jsx("path",{d:"M11 18h2"}),d.jsx("path",{d:"M3 18h2"}),d.jsx("path",{d:"M4 12h8"}),d.jsx("path",{d:"M3 6h2"}),d.jsx("path",{d:"M11 6h2"})]})}function CM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M19 14a2 2 0 1 0 -2 -2"}),d.jsx("path",{d:"M17 16a2 2 0 1 0 2 -2"}),d.jsx("path",{d:"M4 6v12"}),d.jsx("path",{d:"M12 6v12"}),d.jsx("path",{d:"M11 18h2"}),d.jsx("path",{d:"M3 18h2"}),d.jsx("path",{d:"M4 12h8"}),d.jsx("path",{d:"M3 6h2"}),d.jsx("path",{d:"M11 6h2"})]})}function SM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M20 18v-8l-4 6h5"}),d.jsx("path",{d:"M4 6v12"}),d.jsx("path",{d:"M12 6v12"}),d.jsx("path",{d:"M11 18h2"}),d.jsx("path",{d:"M3 18h2"}),d.jsx("path",{d:"M4 12h8"}),d.jsx("path",{d:"M3 6h2"}),d.jsx("path",{d:"M11 6h2"})]})}function MM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M17 18h2a2 2 0 1 0 0 -4h-2v-4h4"}),d.jsx("path",{d:"M4 6v12"}),d.jsx("path",{d:"M12 6v12"}),d.jsx("path",{d:"M11 18h2"}),d.jsx("path",{d:"M3 18h2"}),d.jsx("path",{d:"M4 12h8"}),d.jsx("path",{d:"M3 6h2"}),d.jsx("path",{d:"M11 6h2"})]})}function TM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M19 14a2 2 0 1 0 0 4a2 2 0 0 0 0 -4z"}),d.jsx("path",{d:"M21 12a2 2 0 1 0 -4 0v4"}),d.jsx("path",{d:"M4 6v12"}),d.jsx("path",{d:"M12 6v12"}),d.jsx("path",{d:"M11 18h2"}),d.jsx("path",{d:"M3 18h2"}),d.jsx("path",{d:"M4 12h8"}),d.jsx("path",{d:"M3 6h2"}),d.jsx("path",{d:"M11 6h2"})]})}function DM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M9 6l11 0"}),d.jsx("path",{d:"M9 12l11 0"}),d.jsx("path",{d:"M9 18l11 0"}),d.jsx("path",{d:"M5 6l0 .01"}),d.jsx("path",{d:"M5 12l0 .01"}),d.jsx("path",{d:"M5 18l0 .01"})]})}function EM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M11 6h9"}),d.jsx("path",{d:"M11 12h9"}),d.jsx("path",{d:"M12 18h8"}),d.jsx("path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4"}),d.jsx("path",{d:"M6 10v-6l-2 2"})]})}function OM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M17 22v-2"}),d.jsx("path",{d:"M9 15l6 -6"}),d.jsx("path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464"}),d.jsx("path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463"}),d.jsx("path",{d:"M20 17h2"}),d.jsx("path",{d:"M2 7h2"}),d.jsx("path",{d:"M7 2v2"})]})}function NM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M6 15h15"}),d.jsx("path",{d:"M21 19h-15"}),d.jsx("path",{d:"M15 11h6"}),d.jsx("path",{d:"M21 7h-6"}),d.jsx("path",{d:"M9 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2"}),d.jsx("path",{d:"M3 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2"})]})}function IM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M4 6l16 0"}),d.jsx("path",{d:"M4 12l10 0"}),d.jsx("path",{d:"M4 18l14 0"})]})}function PM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M4 6l16 0"}),d.jsx("path",{d:"M10 12l10 0"}),d.jsx("path",{d:"M6 18l14 0"})]})}function AM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M4 6l16 0"}),d.jsx("path",{d:"M8 12l8 0"}),d.jsx("path",{d:"M6 18l12 0"})]})}function RM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M4 6l16 0"}),d.jsx("path",{d:"M4 12l16 0"}),d.jsx("path",{d:"M4 18l12 0"})]})}function jM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M5 7l8 10m-8 0l8 -10"}),d.jsx("path",{d:"M21 20h-4l3.5 -4a1.73 1.73 0 0 0 -3.5 -2"})]})}function LM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M5 7l8 10m-8 0l8 -10"}),d.jsx("path",{d:"M21 11h-4l3.5 -4a1.73 1.73 0 0 0 -3.5 -2"})]})}function vp(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M7 8l-4 4l4 4"}),d.jsx("path",{d:"M17 8l4 4l-4 4"}),d.jsx("path",{d:"M14 4l-4 16"})]})}function FM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M3 19h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"}),d.jsx("path",{d:"M12.5 5.5l4 4"}),d.jsx("path",{d:"M4.5 13.5l4 4"}),d.jsx("path",{d:"M21 15v4h-8l4 -4z"})]})}function $M(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M5 12h2"}),d.jsx("path",{d:"M17 12h2"}),d.jsx("path",{d:"M11 12h2"})]})}function wp(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M20.042 16.045a9 9 0 0 0 -12.087 -12.087m-2.318 1.677a9 9 0 1 0 12.725 12.73"}),d.jsx("path",{d:"M3 3l18 18"})]})}function BM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M11 7l6 6"}),d.jsx("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]})}function _M(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M18 6l-12 12"}),d.jsx("path",{d:"M6 6l12 12"})]})}function zM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25"}),d.jsx("path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),d.jsx("path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),d.jsx("path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"})]})}function HM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M5 12l5 5l10 -10"})]})}function VM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M9 15l6 -6"}),d.jsx("path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464"}),d.jsx("path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463"})]})}function WM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6"}),d.jsx("path",{d:"M11 13l9 -9"}),d.jsx("path",{d:"M15 4h5v5"})]})}function UM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M9 14l-4 -4l4 -4"}),d.jsx("path",{d:"M5 10h11a4 4 0 1 1 0 8h-1"})]})}function qM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M15 14l4 -4l-4 -4"}),d.jsx("path",{d:"M19 10h-11a4 4 0 1 0 0 8h1"})]})}function YM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M3.5 5.5l1.5 1.5l2.5 -2.5"}),d.jsx("path",{d:"M3.5 11.5l1.5 1.5l2.5 -2.5"}),d.jsx("path",{d:"M3.5 17.5l1.5 1.5l2.5 -2.5"}),d.jsx("path",{d:"M11 6l9 0"}),d.jsx("path",{d:"M11 12l9 0"}),d.jsx("path",{d:"M11 18l9 0"})]})}function KM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M20 6l-11 0"}),d.jsx("path",{d:"M20 12l-7 0"}),d.jsx("path",{d:"M20 18l-11 0"}),d.jsx("path",{d:"M4 8l4 4l-4 4"})]})}function GM(n){return d.jsxs(me,{...n,children:[d.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),d.jsx("path",{d:"M20 6l-7 0"}),d.jsx("path",{d:"M20 12l-9 0"}),d.jsx("path",{d:"M20 18l-7 0"}),d.jsx("path",{d:"M8 8l-4 4l4 4"})]})}const JM={interactive:!0},_r=Ne((n,e)=>{const t=ie("RichTextEditorControl",JM,n),{classNames:r,className:s,style:o,styles:i,vars:a,interactive:l,active:c,onMouseDown:u,disabled:f,...h}=t,p=Dn();return d.jsx(jr,{...h,...p.getStyles("control",{className:s,style:o,classNames:r,styles:i}),disabled:f,"data-rich-text-editor-control":!0,tabIndex:l?0:-1,"data-interactive":l||void 0,"data-disabled":f||void 0,"data-active":c||void 0,"aria-pressed":c&&l||void 0,"aria-hidden":!l||void 0,ref:e,unstyled:p.unstyled,onMouseDown:m=>{m.preventDefault(),u==null||u(m)}})});_r.classes=sr;_r.displayName="@mantine/tiptap/RichTextEditorControl";const _l=x.forwardRef(({className:n,icon:e,...t},r)=>d.jsx(_r,{ref:r,...t,children:d.jsx(e,{style:{width:te(16),height:te(16)}})}));_l.displayName="@mantine/tiptap/RichTextEditorControlBase";function Se({label:n,isActive:e,operation:t,icon:r,isDisabled:s}){return x.forwardRef((o,i)=>{const{editor:a,labels:l}=Dn(),c=l[n];return d.jsx(_l,{...o,"aria-label":c,title:c,active:e!=null&&e.name?a==null?void 0:a.isActive(e.name,e.attributes):!1,ref:i,onClick:()=>a==null?void 0:a.chain().focus()[t.name](t.attributes).run(),icon:o.icon||r,disabled:(s==null?void 0:s(a))||!1})})}const QM=Se({label:"boldControlLabel",icon:n=>d.jsx(gM,{...n}),isActive:{name:"bold"},operation:{name:"toggleBold"}}),XM=Se({label:"italicControlLabel",icon:n=>d.jsx(yM,{...n}),isActive:{name:"italic"},operation:{name:"toggleItalic"}}),ZM=Se({label:"underlineControlLabel",icon:n=>d.jsx(xM,{...n}),isActive:{name:"underline"},operation:{name:"toggleUnderline"}}),eT=Se({label:"strikeControlLabel",icon:n=>d.jsx(bM,{...n}),isActive:{name:"strike"},operation:{name:"toggleStrike"}}),tT=Se({label:"clearFormattingControlLabel",icon:n=>d.jsx(vM,{...n}),operation:{name:"unsetAllMarks"}}),nT=Se({label:"unlinkControlLabel",icon:n=>d.jsx(OM,{...n}),operation:{name:"unsetLink"}}),rT=Se({label:"bulletListControlLabel",icon:n=>d.jsx(DM,{...n}),isActive:{name:"bulletList"},operation:{name:"toggleBulletList"}}),sT=Se({label:"orderedListControlLabel",icon:n=>d.jsx(EM,{...n}),isActive:{name:"orderedList"},operation:{name:"toggleOrderedList"}}),oT=Se({label:"h1ControlLabel",icon:n=>d.jsx(wM,{...n}),isActive:{name:"heading",attributes:{level:1}},operation:{name:"toggleHeading",attributes:{level:1}}}),iT=Se({label:"h2ControlLabel",icon:n=>d.jsx(kM,{...n}),isActive:{name:"heading",attributes:{level:2}},operation:{name:"toggleHeading",attributes:{level:2}}}),aT=Se({label:"h3ControlLabel",icon:n=>d.jsx(CM,{...n}),isActive:{name:"heading",attributes:{level:3}},operation:{name:"toggleHeading",attributes:{level:3}}}),lT=Se({label:"h4ControlLabel",icon:n=>d.jsx(SM,{...n}),isActive:{name:"heading",attributes:{level:4}},operation:{name:"toggleHeading",attributes:{level:4}}}),cT=Se({label:"h5ControlLabel",icon:n=>d.jsx(MM,{...n}),isActive:{name:"heading",attributes:{level:5}},operation:{name:"toggleHeading",attributes:{level:5}}}),uT=Se({label:"h6ControlLabel",icon:n=>d.jsx(TM,{...n}),isActive:{name:"heading",attributes:{level:6}},operation:{name:"toggleHeading",attributes:{level:6}}}),dT=Se({label:"blockquoteControlLabel",icon:n=>d.jsx(NM,{...n}),isActive:{name:"blockquote"},operation:{name:"toggleBlockquote"}}),fT=Se({label:"alignLeftControlLabel",icon:n=>d.jsx(IM,{...n}),operation:{name:"setTextAlign",attributes:"left"}}),hT=Se({label:"alignRightControlLabel",icon:n=>d.jsx(PM,{...n}),operation:{name:"setTextAlign",attributes:"right"}}),pT=Se({label:"alignCenterControlLabel",icon:n=>d.jsx(AM,{...n}),operation:{name:"setTextAlign",attributes:"center"}}),mT=Se({label:"alignJustifyControlLabel",icon:n=>d.jsx(RM,{...n}),operation:{name:"setTextAlign",attributes:"justify"}}),gT=Se({label:"subscriptControlLabel",icon:n=>d.jsx(jM,{...n}),isActive:{name:"subscript"},operation:{name:"toggleSubscript"}}),yT=Se({label:"superscriptControlLabel",icon:n=>d.jsx(LM,{...n}),isActive:{name:"superscript"},operation:{name:"toggleSuperscript"}}),xT=Se({label:"codeControlLabel",icon:n=>d.jsx(vp,{...n}),isActive:{name:"code"},operation:{name:"toggleCode"}}),bT=Se({label:"codeBlockControlLabel",icon:n=>d.jsx(vp,{...n}),isActive:{name:"codeBlock"},operation:{name:"toggleCodeBlock"}}),vT=Se({label:"highlightControlLabel",icon:n=>d.jsx(FM,{...n}),isActive:{name:"highlight"},operation:{name:"toggleHighlight"}}),wT=Se({label:"hrControlLabel",icon:n=>d.jsx($M,{...n}),operation:{name:"setHorizontalRule"}}),kT=Se({label:"unsetColorControlLabel",icon:n=>d.jsx(wp,{...n}),operation:{name:"unsetColor"}}),CT=Se({label:"undoControlLabel",icon:n=>d.jsx(UM,{...n}),isDisabled:n=>!(n!=null&&n.can().undo()),operation:{name:"undo"}}),ST=Se({label:"redoControlLabel",icon:n=>d.jsx(qM,{...n}),isDisabled:n=>!(n!=null&&n.can().redo()),operation:{name:"redo"}}),MT=Se({label:"tasksControlLabel",icon:n=>d.jsx(YM,{...n}),isActive:{name:"taskList"},operation:{name:"toggleTaskList"}}),TT=Se({label:"tasksSinkLabel",icon:n=>d.jsx(KM,{...n}),operation:{name:"sinkListItem",attributes:"taskItem"},isDisabled:n=>!(n!=null&&n.can().sinkListItem("taskItem"))}),DT=Se({label:"tasksLiftLabel",icon:n=>d.jsx(GM,{...n}),operation:{name:"liftListItem",attributes:"taskItem"},isDisabled:n=>!(n!=null&&n.can().liftListItem("taskItem"))}),ET=n=>d.jsx(VM,{...n}),OT={},zl=Ne((n,e)=>{var W;const t=ie("RichTextEditorLinkControl",OT,n),{classNames:r,className:s,style:o,styles:i,vars:a,icon:l,popoverProps:c,disableTooltips:u,initialExternal:f,...h}=t,p=Dn(),m={classNames:r,styles:i},[g,y]=Ym(""),[b,v]=x.useState(f),[w,{open:C,close:M}]=Ed(!1),k=()=>{var D;C();const _=(D=p.editor)==null?void 0:D.getAttributes("link");y((_==null?void 0:_.href)||""),v(_!=null&&_.href?(_==null?void 0:_.target)==="_blank":f)},T=()=>{M(),y(""),v(f)},E=()=>{var _,D;T(),g===""?(_=p.editor)==null||_.chain().focus().extendMarkRange("link").unsetLink().run():(D=p.editor)==null||D.chain().focus().extendMarkRange("link").setLink({href:g,target:b?"_blank":null}).run()},I=_=>{_.key==="Enter"&&(_.preventDefault(),E())};Vm("edit-link",k,!1);const{resolvedClassNames:F,resolvedStyles:V}=Jm({classNames:r,styles:i,props:t});return d.jsxs(_t,{trapFocus:!0,shadow:"md",withinPortal:!0,opened:w,onClose:T,offset:-44,zIndex:1e4,...c,children:[d.jsx(_t.Target,{children:d.jsx(_l,{icon:l||ET,...h,"aria-label":p.labels.linkControlLabel,title:p.labels.linkControlLabel,onClick:k,active:(W=p.editor)==null?void 0:W.isActive("link"),ref:e,classNames:F,styles:V,className:s,style:o})}),d.jsx(_t.Dropdown,{...p.getStyles("linkEditorDropdown",m),children:d.jsxs("div",{...p.getStyles("linkEditor",m),children:[d.jsx(hl,{placeholder:p.labels.linkEditorInputPlaceholder,"aria-label":p.labels.linkEditorInputLabel,type:"url",value:g,onChange:y,classNames:{input:p.getStyles("linkEditorInput",m).className},onKeyDown:I,rightSection:d.jsx($r,{label:b?p.labels.linkEditorExternalLink:p.labels.linkEditorInternalLink,events:{hover:!0,focus:!0,touch:!0},withinPortal:!0,withArrow:!0,disabled:u,zIndex:1e4,children:d.jsx(jr,{onClick:()=>v(_=>!_),"data-active":b||void 0,...p.getStyles("linkEditorExternalControl",m),children:d.jsx(WM,{style:{width:te(14),height:te(14)}})})})}),d.jsx(Ao,{variant:"default",onClick:E,...p.getStyles("linkEditorSave",m),children:p.labels.linkEditorSave})]})})]})});zl.classes=sr;zl.displayName="@mantine/tiptap/RichTextEditorLinkControl";const NT={},kp=x.forwardRef((n,e)=>{const{popoverProps:t,colors:r,colorPickerProps:s,...o}=ie("RichTextEditorColorPickerControl",NT,n),{editor:i,labels:a,getStyles:l}=Dn(),[c,{toggle:u,close:f}]=Ed(!1),[h,p]=x.useState("palette"),m=(i==null?void 0:i.getAttributes("textStyle").color)||"var(--mantine-color-text)",g=(v,w=!0)=>{(i==null?void 0:i.chain()).focus().setColor(v).run(),w&&f()},y=()=>{(i==null?void 0:i.chain()).focus().unsetColor().run(),f()},b=r.map((v,w)=>d.jsx(Yn,{component:"button",color:v,onClick:()=>g(v),size:26,radius:"xs",style:{cursor:"pointer"},title:a.colorPickerColorLabel(v),"aria-label":a.colorPickerColorLabel(v)},w));return d.jsxs(_t,{opened:c,withinPortal:!0,trapFocus:!0,onClose:f,...t,children:[d.jsx(_t.Target,{children:d.jsx(_r,{...o,"aria-label":a.colorPickerControlLabel,title:a.colorPickerControlLabel,ref:e,onClick:u,children:d.jsx(Yn,{color:m,size:14})})}),d.jsxs(_t.Dropdown,{...l("linkEditorDropdown"),children:[h==="palette"&&d.jsx(fl,{cols:7,spacing:2,children:b}),h==="colorPicker"&&d.jsx(ul,{defaultValue:m,onChange:v=>g(v,!1),...s}),d.jsx($r.Group,{closeDelay:200,children:d.jsxs(nl,{justify:"flex-end",gap:"xs",mt:"sm",children:[h==="palette"&&d.jsx(dn,{variant:"default",onClick:f,title:a.colorPickerCancel,"aria-label":a.colorPickerCancel,children:d.jsx(_M,{style:{width:te(16),height:te(16)}})}),d.jsx(dn,{variant:"default",onClick:y,title:a.colorPickerClear,"aria-label":a.colorPickerClear,children:d.jsx(wp,{style:{width:te(16),height:te(16)}})}),h==="palette"?d.jsx(dn,{variant:"default",onClick:()=>p("colorPicker"),title:a.colorPickerColorPicker,"aria-label":a.colorPickerColorPicker,children:d.jsx(BM,{style:{width:te(16),height:te(16)}})}):d.jsx(dn,{variant:"default",onClick:()=>p("palette"),"aria-label":a.colorPickerPalette,title:a.colorPickerPalette,children:d.jsx(zM,{style:{width:te(16),height:te(16)}})}),h==="colorPicker"&&d.jsx(dn,{variant:"default",onClick:f,title:a.colorPickerSave,"aria-label":a.colorPickerSave,children:d.jsx(HM,{style:{width:te(16),height:te(16)}})})]})})]})]})});kp.displayName="@mantine/tiptap/ColorPickerControl";const IT={},PT=x.forwardRef((n,e)=>{const{color:t,...r}=ie("RichTextEditorColorControl",IT,n),{editor:s,labels:o}=Dn(),i=(s==null?void 0:s.getAttributes("textStyle").color)||null,a=o.colorControlLabel(t);return d.jsx(_r,{...r,active:i===t,"aria-label":a,title:a,onClick:()=>(s==null?void 0:s.chain()).focus().setColor(t).run(),ref:e,children:d.jsx(Yn,{color:t,size:14})})}),AT={},Hl=Ne((n,e)=>{const t=ie("RichTextEditorControlsGroup",AT,n),{classNames:r,className:s,style:o,styles:i,vars:a,...l}=t,c=Dn();return d.jsx(ue,{ref:e,...c.getStyles("controlsGroup",{className:s,style:o,styles:i,classNames:r}),...l})});Hl.classes=sr;Hl.displayName="@mantine/tiptap/RichTextEditorControlsGroup";const RT={},Vl=Ne((n,e)=>{const t=ie("RichTextEditorToolbar",RT,n),{classNames:r,className:s,style:o,styles:i,vars:a,sticky:l,stickyOffset:c,mod:u,...f}=t,h=Dn();return d.jsx(ue,{ref:e,mod:[{sticky:l},u],...h.getStyles("toolbar",{className:s,style:o,styles:i,classNames:r}),...f,__vars:{"--rte-sticky-offset":te(c)}})});Vl.classes=sr;Vl.displayName="@mantine/tiptap/RichTextEditorToolbar";const jT={withCodeHighlightStyles:!0,withTypographyStyles:!0},z=Ne((n,e)=>{const t=ie("RichTextEditor",jT,n),{classNames:r,className:s,style:o,styles:i,unstyled:a,vars:l,editor:c,withCodeHighlightStyles:u,withTypographyStyles:f,labels:h,children:p,...m}=t,g=Pe({name:"RichTextEditor",classes:sr,props:t,className:s,style:o,classNames:r,styles:i,unstyled:a,vars:l}),y=x.useMemo(()=>({...JS,...h}),[h]);return d.jsx(QS,{value:{editor:c,getStyles:g,labels:y,withCodeHighlightStyles:u,withTypographyStyles:f,unstyled:a},children:d.jsx(ue,{...g("root"),...m,ref:e,children:p})})});z.classes=sr;z.displayName="@mantine/tiptap/RichTextEditor";z.Content=Bl;z.Control=_r;z.Toolbar=Vl;z.ControlsGroup=Hl;z.Bold=QM;z.Italic=XM;z.Strikethrough=eT;z.Underline=ZM;z.ClearFormatting=tT;z.H1=oT;z.H2=iT;z.H3=aT;z.H4=lT;z.H5=cT;z.H6=uT;z.BulletList=rT;z.OrderedList=sT;z.Link=zl;z.Unlink=nT;z.Blockquote=dT;z.AlignLeft=fT;z.AlignRight=hT;z.AlignCenter=pT;z.AlignJustify=mT;z.Superscript=yT;z.Subscript=gT;z.Code=xT;z.CodeBlock=bT;z.ColorPicker=kp;z.Color=PT;z.Highlight=vT;z.Hr=wT;z.UnsetColor=kT;z.Undo=CT;z.Redo=ST;z.TaskList=MT;z.TaskListSink=TT;z.TaskListLift=DT;const LT=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,FT=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,$T=ct.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Qn({find:LT,type:this.type})]},addPasteRules(){return[Xn({find:FT,type:this.type})]}}),BT=/^\s*>\s$/,_T=pt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[fs({find:BT,type:this.type})]}}),zT=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,HT=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,VT=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,WT=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,UT=ct.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Qn({find:zT,type:this.type}),Qn({find:VT,type:this.type})]},addPasteRules(){return[Xn({find:HT,type:this.type}),Xn({find:WT,type:this.type})]}}),qT=pt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Re(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ku=ct.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Qo(n,this.type);return Object.entries(t).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Gu=/^\s*([-+*])\s$/,YT=pt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(qT.name,this.editor.getAttributes(Ku.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=fs({find:Gu,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=fs({find:Gu,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Ku.name),editor:this.editor})),[n]}}),KT=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,GT=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,JT=ct.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Qn({find:KT,type:this.type})]},addPasteRules(){return[Xn({find:GT,type:this.type})]}}),QT=/^```([a-z]+)?[\s\n]$/,XT=/^~~~([a-z]+)?[\s\n]$/,ZT=pt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(i=>i.startsWith(t)).map(i=>i.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",Re(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:o}=t;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(de.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[Ca({find:QT,type:this.type,getAttributes:n=>({language:n[1]})}),Ca({find:XT,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Ct({key:new Sn("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!t||!o)return!1;const{tr:i,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},l)),i.selection.$from.parent.type!==this.type&&i.setSelection(ce.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),n.dispatch(i),!0}}})]}}),eD=pt.create({name:"doc",topNode:!0,content:"block+"});function tD(n={}){return new Ct({view(e){return new nD(e,n)}})}class nD{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let o=i=>{this[s](i)};return e.dom.addEventListener(s,o),{name:s,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),f=a?u.bottom:u.top;a&&l&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let s=this.editorView.dom.offsetParent;this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let o,i;if(!s||s==document.body&&getComputedStyle(s).position=="static")o=-pageXOffset,i=-pageYOffset;else{let a=s.getBoundingClientRect();o=a.left-s.scrollLeft,i=a.top-s.scrollTop}this.element.style.left=r.left-o+"px",this.element.style.top=r.top-i+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,o=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!o){let i=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=mh(this.editorView.state.doc,i,this.editorView.dragging.slice);a!=null&&(i=a)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const rD=lt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[tD(this.options)]}});class Le extends de{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Le.valid(r)?new Le(r):de.near(r)}content(){return U.empty}eq(e){return e instanceof Le&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Le(e.resolve(t.pos))}getBookmark(){return new Wl(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!sD(e)||!oD(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Le.valid(e))return e;let s=e.pos,o=null;for(let i=e.depth;;i--){let a=e.node(i);if(t>0?e.indexAfter(i)<a.childCount:e.index(i)>0){o=a.child(t>0?e.indexAfter(i):e.index(i)-1);break}else if(i==0)return null;s+=t;let l=e.doc.resolve(s);if(Le.valid(l))return l}for(;;){let i=t>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!ne.isSelectable(o)){e=e.doc.resolve(s+o.nodeSize*t),r=!1;continue e}break}o=i,s+=t;let a=e.doc.resolve(s);if(Le.valid(a))return a}return null}}}Le.prototype.visible=!1;Le.findFrom=Le.findGapCursorFrom;de.jsonID("gapcursor",Le);class Wl{constructor(e){this.pos=e}map(e){return new Wl(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Le.valid(t)?new Le(t):de.near(t)}}function sD(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function oD(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function iD(){return new Ct({props:{decorations:uD,createSelectionBetween(n,e,t){return e.pos==t.pos&&Le.valid(t)?new Le(t):null},handleClick:lD,handleKeyDown:aD,handleDOMEvents:{beforeinput:cD}}})}const aD=np({ArrowLeft:Ls("horiz",-1),ArrowRight:Ls("horiz",1),ArrowUp:Ls("vert",-1),ArrowDown:Ls("vert",1)});function Ls(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,o){let i=r.selection,a=e>0?i.$to:i.$from,l=i.empty;if(i instanceof ce){if(!o.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Le.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new Le(c))),!0):!1}}function lD(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Le.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&ne.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Le(r))),!0)}function cD(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Le))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=j.empty;for(let i=r.length-1;i>=0;i--)s=j.from(r[i].createAndFill(null,s));let o=n.state.tr.replace(t.pos,t.pos,new U(s,0,0));return o.setSelection(ce.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function uD(n){if(!(n.selection instanceof Le))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ve.create(n.doc,[bt.widget(n.selection.head,e,{key:"gapcursor"})])}const dD=lt.create({name:"gapCursor",addProseMirrorPlugins(){return[iD()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=he(Z(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),fD=pt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Re(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:o}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,l=o||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&i){const f=l.filter(h=>a.includes(h.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),hD=pt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Re(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Ca({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var yo=200,qe=function(){};qe.prototype.append=function(e){return e.length?(e=qe.from(e),!this.length&&e||e.length<yo&&this.leafAppend(e)||this.length<yo&&e.leafPrepend(this)||this.appendInner(e)):this};qe.prototype.prepend=function(e){return e.length?qe.from(e).append(this):this};qe.prototype.appendInner=function(e){return new pD(this,e)};qe.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?qe.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};qe.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};qe.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};qe.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(o,i){return s.push(e(o,i))},t,r),s};qe.from=function(e){return e instanceof qe?e:e&&e.length?new Cp(e):qe.empty};var Cp=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,o){return s==0&&o==this.length?this:new e(this.values.slice(s,o))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,o,i,a){for(var l=o;l<i;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,o,i,a){for(var l=o-1;l>=i;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=yo)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=yo)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(qe);qe.empty=new Cp([]);var pD=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,o,i){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(o,a),i)===!1||o>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,o)-a,i+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,o,i){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(o,a)-a,i+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(s,a),o,i)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var o=this.left.length;return s<=o?this.left.slice(r,s):r>=o?this.right.slice(r-o,s-o):this.left.slice(r,o).append(this.right.slice(0,s-o))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(qe);const mD=500;class Tt{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,o;t&&(s=this.remapping(r,this.items.length),o=s.maps.length);let i=e.tr,a,l,c=[],u=[];return this.items.forEach((f,h)=>{if(!f.step){s||(s=this.remapping(r,h+1),o=s.maps.length),o--,u.push(f);return}if(s){u.push(new Rt(f.map));let p=f.step.map(s.slice(o)),m;p&&i.maybeStep(p).doc&&(m=i.mapping.maps[i.mapping.maps.length-1],c.push(new Rt(m,void 0,void 0,c.length+u.length))),o--,m&&s.appendMap(m,o)}else i.maybeStep(f.step);if(f.selection)return a=s?f.selection.map(s.slice(o)):f.selection,l=new Tt(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:i,selection:a}}addTransform(e,t,r,s){let o=[],i=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),h=new Rt(e.mapping.maps[u],f,t),p;(p=l&&l.merge(h))&&(h=p,u?o.pop():a=a.slice(0,a.length-1)),o.push(h),t&&(i++,t=void 0),s||(l=h)}let c=i-r.depth;return c>yD&&(a=gD(a,c),i-=c),new Tt(a.append(o),i)}remapping(e,t){let r=new vr;return this.items.forEach((s,o)=>{let i=s.mirrorOffset!=null&&o-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,i)},e,t),r}addMaps(e){return this.eventCount==0?this:new Tt(this.items.append(e.map(t=>new Rt(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},s);let l=t;this.items.forEach(h=>{let p=o.getMirror(--l);if(p==null)return;i=Math.min(i,p);let m=o.maps[p];if(h.step){let g=e.steps[p].invert(e.docs[p]),y=h.selection&&h.selection.map(o.slice(l+1,p));y&&a++,r.push(new Rt(m,g,y))}else r.push(new Rt(m))},s);let c=[];for(let h=t;h<i;h++)c.push(new Rt(o.maps[h]));let u=this.items.slice(0,s).append(c).append(r),f=new Tt(u,a);return f.emptyItemCount()>mD&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],o=0;return this.items.forEach((i,a)=>{if(a>=e)s.push(i),i.selection&&o++;else if(i.step){let l=i.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=i.selection&&i.selection.map(t.slice(r));u&&o++;let f=new Rt(c.invert(),l,u),h,p=s.length-1;(h=s.length&&s[p].merge(f))?s[p]=h:s.push(f)}}else i.map&&r--},this.items.length,0),new Tt(qe.from(s.reverse()),o)}}Tt.empty=new Tt(qe.empty,0);function gD(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class Rt{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Rt(t.getMap().invert(),t,this.selection)}}}class ln{constructor(e,t,r,s,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=o}}const yD=20;function xD(n,e,t,r){let s=t.getMeta(Un),o;if(s)return s.historyState;t.getMeta(wD)&&(n=new ln(n.done,n.undone,null,0,-1));let i=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(i&&i.getMeta(Un))return i.getMeta(Un).redo?new ln(n.done.addTransform(t,void 0,r,Ys(e)),n.undone,Ju(t.mapping.maps),n.prevTime,n.prevComposition):new ln(n.done,n.undone.addTransform(t,void 0,r,Ys(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!i&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!bD(t,n.prevRanges)),c=i?Pi(n.prevRanges,t.mapping):Ju(t.mapping.maps);return new ln(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Ys(e)),Tt.empty,c,t.time,a??n.prevComposition)}else return(o=t.getMeta("rebased"))?new ln(n.done.rebased(t,o),n.undone.rebased(t,o),Pi(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new ln(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Pi(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function bD(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&s>=e[o]&&(t=!0)}),t}function Ju(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,o,i)=>e.push(o,i));return e}function Pi(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),o=e.map(n[r+1],-1);s<=o&&t.push(s,o)}return t}function vD(n,e,t){let r=Ys(e),s=Un.get(e).spec.config,o=(t?n.undone:n.done).popEvent(e,r);if(!o)return null;let i=o.selection.resolve(o.transform.doc),a=(t?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),s,r),l=new ln(t?a:o.remaining,t?o.remaining:a,null,0,-1);return o.transform.setSelection(i).setMeta(Un,{redo:t,historyState:l})}let Ai=!1,Qu=null;function Ys(n){let e=n.plugins;if(Qu!=e){Ai=!1,Qu=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ai=!0;break}}return Ai}const Un=new Sn("history"),wD=new Sn("closeHistory");function kD(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Ct({key:Un,state:{init(){return new ln(Tt.empty,Tt.empty,null,0,-1)},apply(e,t,r){return xD(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?Mp:r=="historyRedo"?Tp:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function Sp(n,e){return(t,r)=>{let s=Un.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let o=vD(s,t,n);o&&r(e?o.scrollIntoView():o)}return!0}}const Mp=Sp(!1,!0),Tp=Sp(!0,!0),CD=lt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>Mp(n,e),redo:()=>({state:n,dispatch:e})=>Tp(n,e)}},addProseMirrorPlugins(){return[kD(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),SD=pt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Re(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{selection:t}=e,{$from:r,$to:s}=t,o=n();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):vS(t)?o.insertContentAt(s.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:a})=>{var l;if(a){const{$to:c}=i.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?i.setSelection(ce.create(i.doc,c.pos+1)):c.nodeAfter.isBlock?i.setSelection(ne.create(i.doc,c.pos)):i.setSelection(ce.create(i.doc,c.pos));else{const f=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();f&&(i.insert(u,f),i.setSelection(ce.create(i.doc,u+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[GS({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),MD=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,TD=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,DD=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,ED=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,OD=ct.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Qn({find:MD,type:this.type}),Qn({find:DD,type:this.type})]},addPasteRules(){return[Xn({find:TD,type:this.type}),Xn({find:ED,type:this.type})]}}),ND=pt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Re(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ID=pt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Re(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Xu=ct.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Qo(n,this.type);return Object.entries(t).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Zu=/^(\d+)\.\s$/,PD=pt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",Re(this.options.HTMLAttributes,t),0]:["ol",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ID.name,this.editor.getAttributes(Xu.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=fs({find:Zu,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=fs({find:Zu,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Xu.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),AD=pt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),RD=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,jD=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,LD=ct.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Qn({find:RD,type:this.type})]},addPasteRules(){return[Xn({find:jD,type:this.type})]}}),FD=pt.create({name:"text",group:"inline"}),$D=lt.create({name:"starterKit",addExtensions(){var n,e,t,r,s,o,i,a,l,c,u,f,h,p,m,g,y,b;const v=[];return this.options.bold!==!1&&v.push(UT.configure((n=this.options)===null||n===void 0?void 0:n.bold)),this.options.blockquote!==!1&&v.push(_T.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&v.push(YT.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&v.push(JT.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&v.push(ZT.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&v.push(eD.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&v.push(rD.configure((i=this.options)===null||i===void 0?void 0:i.dropcursor)),this.options.gapcursor!==!1&&v.push(dD.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&v.push(fD.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&v.push(hD.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&v.push(CD.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&v.push(SD.configure((f=this.options)===null||f===void 0?void 0:f.horizontalRule)),this.options.italic!==!1&&v.push(OD.configure((h=this.options)===null||h===void 0?void 0:h.italic)),this.options.listItem!==!1&&v.push(ND.configure((p=this.options)===null||p===void 0?void 0:p.listItem)),this.options.orderedList!==!1&&v.push(PD.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&v.push(AD.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&v.push(LD.configure((y=this.options)===null||y===void 0?void 0:y.strike)),this.options.text!==!1&&v.push(FD.configure((b=this.options)===null||b===void 0?void 0:b.text)),v}}),BD=ct.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),_D=lt.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>{const e=n.style.textAlign||this.options.defaultAlignment;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:n=>n.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${n.textAlign}`}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.map(t=>e.updateAttributes(t,{textAlign:n})).every(t=>t):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.map(e=>n.resetAttributes(e,"textAlign")).every(e=>e)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),zD=ct.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(n){return n!=="super"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sup",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setSuperscript:()=>({commands:n})=>n.setMark(this.name),toggleSuperscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSuperscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),HD=ct.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(n){return n!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sub",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setSubscript:()=>({commands:n})=>n.setMark(this.name),toggleSubscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSubscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}});function VD({content:n,onChange:e}){const t=dM({extensions:[$D,BD,zD,HD,$T,_D.configure({types:["heading","paragraph"]})],content:n,onUpdate:({editor:s})=>{const o=s.getHTML();o!==n&&e(o)},autofocus:!1}),r=Ee.useRef(!1);return x.useEffect(()=>{t&&n&&!r.current&&(t.commands.setContent(n,!1),r.current=!0)},[t,n]),x.useEffect(()=>()=>{t&&t.destroy()},[t]),d.jsx(Pr,{title:"ملاحظات وتفاصيل اضافية",children:d.jsx(vo,{children:d.jsxs(z,{editor:t,children:[d.jsxs(z.Toolbar,{sticky:!0,stickyOffset:60,children:[d.jsxs(z.ControlsGroup,{children:[d.jsx(z.Bold,{}),d.jsx(z.Italic,{}),d.jsx(z.Underline,{}),d.jsx(z.Strikethrough,{}),d.jsx(z.ClearFormatting,{}),d.jsx(z.Highlight,{}),d.jsx(z.Code,{})]}),d.jsxs(z.ControlsGroup,{children:[d.jsx(z.H1,{}),d.jsx(z.H2,{}),d.jsx(z.H3,{}),d.jsx(z.H4,{})]}),d.jsxs(z.ControlsGroup,{children:[d.jsx(z.Blockquote,{}),d.jsx(z.Hr,{}),d.jsx(z.BulletList,{}),d.jsx(z.OrderedList,{}),d.jsx(z.Subscript,{}),d.jsx(z.Superscript,{})]}),d.jsxs(z.ControlsGroup,{children:[d.jsx(z.Link,{}),d.jsx(z.Unlink,{})]}),d.jsxs(z.ControlsGroup,{children:[d.jsx(z.AlignLeft,{}),d.jsx(z.AlignCenter,{}),d.jsx(z.AlignJustify,{}),d.jsx(z.AlignRight,{})]}),d.jsxs(z.ControlsGroup,{children:[d.jsx(z.Undo,{}),d.jsx(z.Redo,{})]})]}),d.jsx(z.Content,{})]})})})}const WD={id:0,name:"",settings:{showPayment:!0,showVat:!0,showDiscount:!0,showFiles:!0,showShipping:!0,addItem:!0,acceptNegativeQTY:!0,price:"PPrice",showFrom:!0,showTo:!0,showMultipleStores:!0,showClient:!0}},Nn={showFiles:!0,showPayment:!0,showVat:!0,showDiscount:!0,showShipping:!0,addItem:!1,acceptNegativeQTY:!1,showClient:!0,clientType:"عميل",isSupplier:!1,price:"SEPrice",editPrice:!1,showStore:!0,showMultipleStores:!0},In={showFiles:!0,showPayment:!0,showVat:!0,showDiscount:!0,showShipping:!0,addItem:!0,acceptNegativeQTY:!1,showClient:!0,clientType:"مورد",isSupplier:!0,price:"PUPrice",editPrice:!0,showStore:!0,showMultipleStores:!0},Fs={showFiles:!0,showPayment:!1,showVat:!1,showDiscount:!1,showShipping:!0,addItem:!1,acceptNegativeQTY:!1,showClient:!1,price:"COPrice",editPrice:!1,showStore:!0,showMultipleStores:!1},$s={showFiles:!0,showPayment:!1,showVat:!1,showDiscount:!1,showShipping:!1,addItem:!0,acceptNegativeQTY:!1,showClient:!1,price:"STPrice",editPrice:!1,showStore:!1,showMultipleStores:!1},UD={211:{id:211,name:"طلبات البيع",settings:Nn},212:{id:212,name:"طلبات العروض",settings:Nn},213:{id:213,name:"عروض الاسعار",settings:Nn},21:{id:21,name:"اوامر بيع",settings:Nn},22:{id:22,name:"فواتير مبيعات",settings:Nn},221:{id:221,name:"السندات المخزنية",settings:Nn},23:{id:23,name:"مردودات مبيعات",settings:Nn},111:{id:111,name:"طلبات الشراء",settings:In},112:{id:112,name:"طلبات العروض",settings:In},113:{id:113,name:"عروض الاسعار",settings:In},11:{id:11,name:"اوامر الشراء",settings:In},12:{id:12,name:"فواتير المشتريات",settings:In},121:{id:121,name:"السندات المخزنية",settings:In},13:{id:13,name:"مردودات مشتريات",settings:In},31:{id:31,name:"تحويل مخزون",settings:{...Fs}},32:{id:32,name:"استلام مخزون",settings:{...Fs}},321:{id:321,name:"السندات المخزنية",settings:Fs},33:{id:33,name:"تسويات مخزنية",settings:{...Fs,showStore:!1,showShipping:!1,addItem:!0,acceptNegativeQTY:!0}},41:{id:41,name:"جرد اول المدة",settings:$s},42:{id:42,name:"جرد اخر المدة",settings:$s},421:{id:421,name:"السندات المخزنية",settings:$s},43:{id:43,name:"مطابقات مخزنية",settings:$s}},qD=n=>UD[n]||WD,AE=()=>{const{id:n}=Yp(),e=ud(),[t,r]=x.useState({open:!1,type:"success",text:""}),{loading:s,invoiceData:o,error:i,refetchInvoiceData:a}=Cv(n),l=x.useMemo(()=>qD(o==null?void 0:o.Order_Type),[o==null?void 0:o.Order_Type]),{title:c,updateTitle:u}=Kp();x.useEffect(()=>{const O=o!=null&&o.StoreName?`( ${o.StoreName} ) `:"",ae=(l==null?void 0:l.name)||"";return u(`${O}${ae}`),()=>{u("")}},[o]);const f=()=>{r({...t,open:!1})},h=bo({defaultValues:{invoice_id:"",ClientID:"",customerName:"",customerEmail:"",customerPhone:"",customerAddress:"",MobileNumber:"",dueDate:new Date,invDate:new Date,termsAndConditions:"",SupplierInvoiceNumber:"",Comment:"",FTStore:"",shipping_charge_on_order:"",shipping_service_id:0,shipping_tracking_number:""}}),{handleSubmit:p,setValue:m,control:g,watch:y,reset:b}=h,[v,w]=x.useState([]),[C,M]=x.useState(""),[k,T]=x.useState(0),[E,I]=x.useState(0),[F,V]=x.useState(!1),W=x.useMemo(()=>({subTotal:0,taxesAmount:0,discountAmount:0,totalAmount:0}),[]),[_,D]=x.useState(W),A=Gl({control:g,name:"discountValue"}),R=Gl({control:g,name:"discountType"});x.useEffect(()=>{const O=v.reduce((ae,ve)=>ve.Quantity!=null&&ve.unitPrice!=null?ae+ve.Quantity*ve.unitPrice:ae,0);I(O),D(ae=>({...ae,subTotal:O}))},[v]),x.useEffect(()=>{o&&(m("invoice_id",o.invoice_id||""),m("ClientID",o.ClientID||""),m("customerName",o.customerName||""),m("customerEmail",o.customerEmail||""),m("customerPhone",o.customerPhone||""),m("customerAddress",o.customerAddress||""),m("MobileNumber",o.MobileNumber||""),m("dueDate",o.due_date?new Date(o.due_date):new Date),m("invDate",o.date?new Date(o.date):new Date),m("termsAndConditions",o.termsAndConditions||""),m("SupplierInvoiceNumber",o.SupplierInvoiceNumber||""),m("Comment",o.Comment||""),m("FTStore",o.FTStore||""),m("shipping_charge_on_order",o.shipping_charge_on_order||""),m("shipping_service_id",o.shipping_service_id||""),m("shipping_tracking_number",o.shipping_tracking_number||""),M(o.Note||"<p></p><p></p><p></p><p></p><p></p>"),D({subTotal:o.subTotal||0,taxesAmount:o.Tax||0,discountAmount:o.dis||0,totalAmount:o.Total||0}),T(o.Tax||0),o.order_entries&&w(o.order_entries),(o.FTStore==="0"||o.FTStore===0)&&V(!0))},[o]);const P=x.useCallback(O=>{w(O)},[]);x.useEffect(()=>{if(!A)return;const O={..._};R==="percentage"?O.discountAmount=(O.subTotal+O.taxesAmount)*(parseFloat(A)/100):O.discountAmount=parseFloat(A),O.totalAmount=O.subTotal+O.taxesAmount-O.discountAmount,D(O)},[A,R]);const B=x.useCallback(O=>{m("dueDate",O)},[m]),Y=O=>{console.error(O),r({open:!0,type:"error",text:O})},$=async O=>{try{if(l.settings.showClient&&!O.ClientID){Y("يرجى تحديد العميل");return}if(l.settings.showStore&&!F&&!O.FTStore){Y("يرجى تحديد الموقع");return}if(v.filter(J=>J.id!==-1).length===0){Y("يرجى اضافة سطر او اكثر");return}if(F&&v.filter(ee=>ee.id!==-1).some(ee=>!ee.LStoreID)){Y("يرجى تحديد الموقع لجميع السطور");return}const ve={id:n,ClientID:O.ClientID,invoice_id:O.invoice_id,FTStore:F?"0":O.FTStore||"",subTotal:_.subTotal,Tax:k,dis:_.discountAmount,Total:_.totalAmount,date:Jr(O.invDate,"yyyyMMdd"),due_date:Jr(O.dueDate,"yyyyMMdd"),Note:C,Comment:O.Comment,SupplierInvoiceNumber:O.SupplierInvoiceNumber,shipping_charge_on_order:O.shipping_charge_on_order||0,shipping_service_id:O.shipping_service_id,shipping_tracking_number:O.shipping_tracking_number||"",balance:O.balance||0,Paid:O.paid||0,delivery_date:O.delivery_date?Jr(O.delivery_date,"yyyyMMdd"):null,status:O.status,closed:O.closed,order_entries:v.map(J=>({BarCodeNo:J.BarCodeNo,CategoryID:J.CategoryID,DepartmentID:J.DepartmentID,InvoiceEnteryID:J.InvoiceEnteryID,ItemID:J.ItemID,Quantity:J.Quantity,name:J.name,offerPrice:J.offerPrice,unitPrice:J.unitPrice,UnitID:J.UnitID,Supplier_Item_ID:J.Supplier_Item_ID,Cost:J.Cost,LStoreID:J.LStoreID}))};if(await am(ve))r({open:!0,type:"success",text:"تم تحديث الفاتورة بنجاح"}),await a();else throw new Error("خطأ في تحديث الفاتورة")}catch(ae){r({open:!0,type:"error",text:ae.message||"حدث خطأ أثناء تحديث الفاتورة"})}};return d.jsxs(Gp,{children:[s?d.jsx($e,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:d.jsx(Ia,{})}):d.jsx(rm,{...h,children:d.jsx("form",{onSubmit:p($),children:d.jsxs(H,{container:!0,spacing:3,children:[d.jsx(H,{item:!0,xs:12,children:d.jsx(Rf,{handleDueDateChange:B,invoiceData:o,orderTypeConfig:l,setShowStores:V,showStores:F})}),d.jsx(H,{item:!0,xs:12,children:d.jsx($v,{orderEntries:o.order_entries,onOrderEntriesChange:P,setValue:m,ClientID:o==null?void 0:o.ClientID,orderTypeConfig:l,showStores:F})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(Bv,{discountAmount:_.discountAmount,subTotal:E||0,setTaxAmount:T,orderTypeConfig:l})}),l.settings.showDiscount&&d.jsx(H,{item:!0,xs:12,children:d.jsx(_v,{control:g,setValue:m,subTotal:E||0,currentDiscount:_.discountAmount||0})}),l.settings.showPayment&&d.jsx(H,{item:!0,xs:12,children:d.jsx(zf,{control:g,setValue:m,watch:y,clientId:o==null?void 0:o.ClientID,invoiceId:o==null?void 0:o.invoice_id})}),l.settings.showShipping&&d.jsx(H,{item:!0,xs:12,children:d.jsx(Jv,{invoiceData:o,setInvoiceValue:m})}),d.jsx(H,{item:!0,xs:12,children:d.jsx(VD,{content:C||"<p></p><p></p><p></p><p></p><p></p>",onChange:M})}),d.jsx(H,{item:!0,xs:12,children:d.jsxs($e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[d.jsx(wm,{resourceId:n,entityName:"الفاتورة",onDelete:()=>e(-1),resource:"invoice"}),d.jsxs($e,{children:[d.jsx(Qe,{color:"secondary",variant:"outlined",onClick:()=>e(-1),sx:{mr:2},children:"الغاء"}),d.jsx(Qe,{color:"primary",variant:"contained",type:"submit",children:"حفظ"})]})]})})]})})}),d.jsx(vm,{open:t.open,type:t.type,text:t.text,handleClose:f})]})};export{AE as default};
